(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();var Bi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zi={},Ha={get exports(){return zi},set exports(r){zi=r}},Re=typeof Reflect=="object"?Reflect:null,Kn=Re&&typeof Re.apply=="function"?Re.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)},Gi;Re&&typeof Re.ownKeys=="function"?Gi=Re.ownKeys:Object.getOwnPropertySymbols?Gi=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Gi=function(t){return Object.getOwnPropertyNames(t)};function Xa(r){console&&console.warn&&console.warn(r)}var Co=Number.isNaN||function(t){return t!==t};function et(){et.init.call(this)}Ha.exports=et;zi.once=$a;et.EventEmitter=et;et.prototype._events=void 0;et.prototype._eventsCount=0;et.prototype._maxListeners=void 0;var Jn=10;function nr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(et,"defaultMaxListeners",{enumerable:!0,get:function(){return Jn},set:function(r){if(typeof r!="number"||r<0||Co(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Jn=r}});et.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};et.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Co(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Po(r){return r._maxListeners===void 0?et.defaultMaxListeners:r._maxListeners}et.prototype.getMaxListeners=function(){return Po(this)};et.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n=t==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")Kn(h,this,e);else for(var u=h.length,l=Fo(h,u),i=0;i<u;++i)Kn(l[i],this,e);return!0};function Lo(r,t,e,i){var n,s,o;if(nr(e),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),o=s[t]),o===void 0)o=s[t]=e,++r._eventsCount;else if(typeof o=="function"?o=s[t]=i?[e,o]:[o,e]:i?o.unshift(e):o.push(e),n=Po(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=t,a.count=o.length,Xa(a)}return r}et.prototype.addListener=function(t,e){return Lo(this,t,e,!1)};et.prototype.on=et.prototype.addListener;et.prototype.prependListener=function(t,e){return Lo(this,t,e,!0)};function za(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ro(r,t,e){var i={fired:!1,wrapFn:void 0,target:r,type:t,listener:e},n=za.bind(i);return n.listener=e,i.wrapFn=n,n}et.prototype.once=function(t,e){return nr(e),this.on(t,Ro(this,t,e)),this};et.prototype.prependOnceListener=function(t,e){return nr(e),this.prependListener(t,Ro(this,t,e)),this};et.prototype.removeListener=function(t,e){var i,n,s,o,a;if(nr(e),n=this._events,n===void 0)return this;if(i=n[t],i===void 0)return this;if(i===e||i.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===e||i[o].listener===e){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():ja(i,s),i.length===1&&(n[t]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",t,a||e)}return this};et.prototype.off=et.prototype.removeListener;et.prototype.removeAllListeners=function(t){var e,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[t]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=i[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this};function Mo(r,t,e){var i=r._events;if(i===void 0)return[];var n=i[t];return n===void 0?[]:typeof n=="function"?e?[n.listener||n]:[n]:e?Wa(n):Fo(n,n.length)}et.prototype.listeners=function(t){return Mo(this,t,!0)};et.prototype.rawListeners=function(t){return Mo(this,t,!1)};et.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):Uo.call(r,t)};et.prototype.listenerCount=Uo;function Uo(r){var t=this._events;if(t!==void 0){var e=t[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}et.prototype.eventNames=function(){return this._eventsCount>0?Gi(this._events):[]};function Fo(r,t){for(var e=new Array(t),i=0;i<t;++i)e[i]=r[i];return e}function ja(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function Wa(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}function $a(r,t){return new Promise(function(e,i){function n(o){r.removeListener(t,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),e([].slice.call(arguments))}Do(r,t,s,{once:!0}),t!=="error"&&Va(r,n,{once:!0})})}function Va(r,t,e){typeof r.on=="function"&&Do(r,"error",t,e)}function Do(r,t,e,i){if(typeof r.on=="function")i.once?r.once(t,e):r.on(t,e);else if(typeof r.addEventListener=="function")r.addEventListener(t,function n(s){i.once&&r.removeEventListener(t,n),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}function qt(r){Object.defineProperty(this,"_next",{writable:!1,enumerable:!1,value:r}),this.done=!1}qt.prototype.next=function(){if(this.done)return{done:!0};var r=this._next();return r.done&&(this.done=!0),r};typeof Symbol<"u"&&(qt.prototype[Symbol.iterator]=function(){return this});qt.of=function(){var r=arguments,t=r.length,e=0;return new qt(function(){return e>=t?{done:!0}:{done:!1,value:r[e++]}})};qt.empty=function(){var r=new qt(null);return r.done=!0,r};qt.is=function(r){return r instanceof qt?!0:typeof r=="object"&&r!==null&&typeof r.next=="function"};var It=qt,Pn=function(t,e){for(var i=arguments.length>1?e:1/0,n=i!==1/0?new Array(i):[],s,o=0;;){if(o===i)return n;if(s=t.next(),s.done)return o!==e?n.slice(0,o):n;n[o++]=s.value}},Ya=It,Yt=function(){var t=arguments,e,i=-1;return new Ya(function n(){if(!e){if(i++,i>=t.length)return{done:!0};e=t[i]}var s=e.next();return s.done?(e=null,n()):s})};function qa(){const r=arguments[0];for(let t=1,e=arguments.length;t<e;t++)if(arguments[t])for(const i in arguments[t])r[i]=arguments[t][i];return r}let Et=qa;typeof Object.assign=="function"&&(Et=Object.assign);function Jt(r,t,e,i){const n=r._nodes.get(t);let s=null;return n&&(i==="mixed"?s=n.out&&n.out[e]||n.undirected&&n.undirected[e]:i==="directed"?s=n.out&&n.out[e]:s=n.undirected&&n.undirected[e]),s}function Ka(r){return r!==null&&typeof r=="object"&&typeof r.addUndirectedEdgeWithKey=="function"&&typeof r.dropNode=="function"}function wt(r){return typeof r=="object"&&r!==null&&r.constructor===Object}function ko(r){let t;for(t in r)return!1;return!0}function St(r,t,e){Object.defineProperty(r,t,{enumerable:!1,configurable:!1,writable:!0,value:e})}function Nt(r,t,e){const i={enumerable:!0,configurable:!0};typeof e=="function"?i.get=e:(i.value=e,i.writable=!1),Object.defineProperty(r,t,i)}function Zn(r){return!(!wt(r)||r.attributes&&!Array.isArray(r.attributes))}function Ja(){let r=0;return()=>`_geid${r++}_`}class Ln extends Error{constructor(t,e){super(),this.name="GraphError",this.message=t||"",this.data=e||{}}}class U extends Ln{constructor(t,e){super(t,e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,U.prototype.constructor)}}class C extends Ln{constructor(t,e){super(t,e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,C.prototype.constructor)}}class K extends Ln{constructor(t,e){super(t,e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,K.prototype.constructor)}}function Qn(r,t){this.key=r,this.attributes=t,this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.directedSelfLoops=0,this.undirectedSelfLoops=0,this.in={},this.out={},this.undirected={}}function Bo(r,t){this.key=r,this.attributes=t,this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}}Bo.prototype.upgradeToMixed=function(){this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}};function Go(r,t){this.key=r,this.attributes=t,this.undirectedDegree=0,this.undirectedSelfLoops=0,this.undirected={}}Go.prototype.upgradeToMixed=function(){this.inDegree=0,this.outDegree=0,this.directedSelfLoops=0,this.in={},this.out={}};function Ho(r,t,e,i,n,s){this.key=t,this.attributes=s,this.undirected=r,this.source=i,this.target=n,this.generatedKey=e}function Xo(r,t,e,i,n,s,o){const a=r.multi;let h="out",u="in";t&&(h=u="undirected");let l,f;if(a){if(l=s[h],f=l[n],typeof f>"u"&&(f=new Set,l[n]=f),f.add(e),i===n&&t)return;l=o[u],typeof l[i]>"u"&&(l[i]=f)}else{if(s[h][n]=e,i===n&&t)return;o[u][i]=e}}function Za(r,t,e){const i=r.multi,{source:n,target:s}=e,o=n.key,a=s.key,h=t?"undirected":"out",u=n[h],l=t?"undirected":"in";if(a in u)if(i){const d=u[a];d.size===1?(delete u[a],delete s[l][o]):d.delete(e)}else delete u[a];if(i)return;const f=s[l];delete f[o]}function Qa(r){r._nodes.forEach(t=>{typeof t.in<"u"&&(t.in={},t.out={}),typeof t.undirected<"u"&&(t.undirected={})})}function th(r){r._nodes.forEach((t,e)=>{if(t.out)for(const i in t.out){const n=new Set;n.add(t.out[i]),t.out[i]=n,r._nodes.get(i).in[e]=n}if(t.undirected)for(const i in t.undirected){if(i>e)continue;const n=new Set;n.add(t.undirected[i]),t.undirected[i]=n,r._nodes.get(i).undirected[e]=n}})}function eh(r,t,e){r.prototype[t]=function(i,n){let s;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+n;if(n=arguments[2],s=Jt(this,o,a,e),!s)throw new C(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else if(i=""+i,s=this._edges.get(i),!s)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(e!=="mixed"&&s.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return s.attributes[n]}}function ih(r,t,e){r.prototype[t]=function(i){let n;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+i,o=""+arguments[1];if(n=Jt(this,s,o,e),!n)throw new C(`Graph.${t}: could not find an edge for the given path ("${s}" - "${o}").`)}else if(i=""+i,n=this._edges.get(i),!n)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(e!=="mixed"&&n.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return n.attributes}}function rh(r,t,e){r.prototype[t]=function(i,n){let s;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+n;if(n=arguments[2],s=Jt(this,o,a,e),!s)throw new C(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else if(i=""+i,s=this._edges.get(i),!s)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(e!=="mixed"&&s.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return s.attributes.hasOwnProperty(n)}}function nh(r,t,e){r.prototype[t]=function(i,n,s){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,h=""+n;if(n=arguments[2],s=arguments[3],o=Jt(this,a,h,e),!o)throw new C(`Graph.${t}: could not find an edge for the given path ("${a}" - "${h}").`)}else if(i=""+i,o=this._edges.get(i),!o)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(e!=="mixed"&&o.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return o.attributes[n]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:n}),this}}function sh(r,t,e){r.prototype[t]=function(i,n,s){let o;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+i,h=""+n;if(n=arguments[2],s=arguments[3],o=Jt(this,a,h,e),!o)throw new C(`Graph.${t}: could not find an edge for the given path ("${a}" - "${h}").`)}else if(i=""+i,o=this._edges.get(i),!o)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(typeof s!="function")throw new U(`Graph.${t}: updater should be a function.`);if(e!=="mixed"&&o.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return o.attributes[n]=s(o.attributes[n]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:n}),this}}function oh(r,t,e){r.prototype[t]=function(i,n){let s;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+n;if(n=arguments[2],s=Jt(this,o,a,e),!s)throw new C(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else if(i=""+i,s=this._edges.get(i),!s)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(e!=="mixed"&&s.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return delete s.attributes[n],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:n}),this}}function ah(r,t,e){r.prototype[t]=function(i,n){let s;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+n;if(n=arguments[2],s=Jt(this,o,a,e),!s)throw new C(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else if(i=""+i,s=this._edges.get(i),!s)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(!wt(n))throw new U(`Graph.${t}: provided attributes are not a plain object.`);if(e!=="mixed"&&s.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return s.attributes=n,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function hh(r,t,e){r.prototype[t]=function(i,n){let s;if(this.type!=="mixed"&&e!=="mixed"&&e!==this.type)throw new K(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new K(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+i,a=""+n;if(n=arguments[2],s=Jt(this,o,a,e),!s)throw new C(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else if(i=""+i,s=this._edges.get(i),!s)throw new C(`Graph.${t}: could not find the "${i}" edge in the graph.`);if(!wt(n))throw new U(`Graph.${t}: provided attributes are not a plain object.`);if(e!=="mixed"&&s.undirected!==(e==="undirected"))throw new C(`Graph.${t}: could not find the "${i}" ${e} edge in the graph.`);return Et(s.attributes,n),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:n}),this}}const uh=[{name:r=>`get${r}Attribute`,attacher:eh},{name:r=>`get${r}Attributes`,attacher:ih},{name:r=>`has${r}Attribute`,attacher:rh},{name:r=>`set${r}Attribute`,attacher:nh},{name:r=>`update${r}Attribute`,attacher:sh},{name:r=>`remove${r}Attribute`,attacher:oh},{name:r=>`replace${r}Attributes`,attacher:ah},{name:r=>`merge${r}Attributes`,attacher:hh}];function lh(r){uh.forEach(function({name:t,attacher:e}){e(r,t("Edge"),"mixed"),e(r,t("DirectedEdge"),"directed"),e(r,t("UndirectedEdge"),"undirected")})}const fh=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function dh(r,t){for(const e in t)r.push(t[e].key)}function ch(r,t){for(const e in t)t[e].forEach(i=>r.push(i.key))}function ph(r,t,e){for(const i in r){if(i===e)continue;const n=r[i];t(n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes,n.undirected,n.generatedKey)}}function vh(r,t,e){for(const i in r)i!==e&&r[i].forEach(n=>t(n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes,n.undirected,n.generatedKey))}function gh(r,t,e){let i=!1;for(const n in r){if(n===e)continue;const s=r[n];if(i=t(s.key,s.attributes,s.source.key,s.target.key,s.source.attributes,s.target.attributes,s.undirected,s.generatedKey),i)return!0}return!1}function yh(r,t,e){let i,n,s,o,a,h=!1;for(const u in r)if(u!==e){for(i=r[u].values();n=i.next(),n.done!==!0;)if(s=n.value,o=s.source,a=s.target,h=t(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected,s.generatedKey),h)return!0}return!1}function pr(r,t){const e=Object.keys(r),i=e.length;let n=null,s=0;return new It(function o(){let a;if(n){const h=n.next();if(h.done)return n=null,s++,o();a=h.value}else{if(s>=i)return{done:!0};const h=e[s];if(h===t)return s++,o();if(a=r[h],a instanceof Set)return n=a.values(),o();s++}return{done:!1,value:[a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes]}})}function mh(r,t,e){const i=t[e];i&&r.push(i.key)}function _h(r,t,e){const i=t[e];i&&i.forEach(n=>r.push(n.key))}function bh(r,t,e){const i=r[t];if(!i)return;const n=i.source,s=i.target;e(i.key,i.attributes,n.key,s.key,n.attributes,s.attributes,i.undirected,i.generatedKey)}function xh(r,t,e){const i=r[t];i&&i.forEach(n=>e(n.key,n.attributes,n.source.key,n.target.key,n.source.attributes,n.target.attributes,n.undirected,n.generatedKey))}function wh(r,t,e){const i=r[t];if(!i)return;const n=i.source,s=i.target;return e(i.key,i.attributes,n.key,s.key,n.attributes,s.attributes,i.undirected,i.generatedKey)}function Eh(r,t,e){const i=r[t];if(!i)return;let n=!1;const s=i.values();let o,a;for(;o=s.next(),o.done!==!0;)if(a=o.value,n=e(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected,a.generatedKey),n)return!0;return!1}function vr(r,t){const e=r[t];if(e instanceof Set){const i=e.values();return new It(function(){const n=i.next();if(n.done)return n;const s=n.value;return{done:!1,value:[s.key,s.attributes,s.source.key,s.target.key,s.source.attributes,s.target.attributes]}})}return It.of([e.key,e.attributes,e.source.key,e.target.key,e.source.attributes,e.target.attributes])}function Th(r,t){if(r.size===0)return[];if(t==="mixed"||t===r.type)return typeof Array.from=="function"?Array.from(r._edges.keys()):Pn(r._edges.keys(),r._edges.size);const e=t==="undirected"?r.undirectedSize:r.directedSize,i=new Array(e),n=t==="undirected",s=r._edges.values();let o=0,a,h;for(;a=s.next(),a.done!==!0;)h=a.value,h.undirected===n&&(i[o++]=h.key);return i}function Ih(r,t,e){if(r.size===0)return;const i=t!=="mixed"&&t!==r.type,n=t==="undirected";let s,o;const a=r._edges.values();for(;s=a.next(),s.done!==!0;){if(o=s.value,i&&o.undirected!==n)continue;const{key:h,attributes:u,source:l,target:f}=o;e(h,u,l.key,f.key,l.attributes,f.attributes,o.undirected,o.generatedKey)}}function Ah(r,t,e){if(r.size===0)return;const i=t!=="mixed"&&t!==r.type,n=t==="undirected";let s,o,a=!1;const h=r._edges.values();for(;s=h.next(),s.done!==!0;){if(o=s.value,i&&o.undirected!==n)continue;const{key:u,attributes:l,source:f,target:d}=o;if(a=e(u,l,f.key,d.key,f.attributes,d.attributes,o.undirected,o.generatedKey),a)break}}function Oh(r,t){if(r.size===0)return It.empty();const e=t!=="mixed"&&t!==r.type,i=t==="undirected",n=r._edges.values();return new It(function(){let o,a;for(;;){if(o=n.next(),o.done)return o;if(a=o.value,!(e&&a.undirected!==i))break}return{value:[a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes],done:!1}})}function Sh(r,t,e,i){const n=[],s=r?ch:dh;return t!=="undirected"&&(e!=="out"&&s(n,i.in),e!=="in"&&s(n,i.out),!e&&i.directedSelfLoops>0&&n.splice(n.lastIndexOf(i.key),1)),t!=="directed"&&s(n,i.undirected),n}function Nh(r,t,e,i,n){const s=r?vh:ph;t!=="undirected"&&(e!=="out"&&s(i.in,n),e!=="in"&&s(i.out,n,e?null:i.key)),t!=="directed"&&s(i.undirected,n)}function Ch(r,t,e,i,n){const s=r?yh:gh;let o=!1;t!=="undirected"&&(e!=="out"&&(o=s(i.in,n),o)||e!=="in"&&(o=s(i.out,n,e?null:i.key),o))||t!=="directed"&&(o=s(i.undirected,n))}function Ph(r,t,e){let i=It.empty();return r!=="undirected"&&(t!=="out"&&typeof e.in<"u"&&(i=Yt(i,pr(e.in))),t!=="in"&&typeof e.out<"u"&&(i=Yt(i,pr(e.out,t?null:e.key)))),r!=="directed"&&typeof e.undirected<"u"&&(i=Yt(i,pr(e.undirected))),i}function Lh(r,t,e,i,n){const s=t?_h:mh,o=[];return r!=="undirected"&&(typeof i.in<"u"&&e!=="out"&&s(o,i.in,n),typeof i.out<"u"&&e!=="in"&&s(o,i.out,n),!e&&i.directedSelfLoops>0&&o.splice(o.lastIndexOf(i.key),1)),r!=="directed"&&typeof i.undirected<"u"&&s(o,i.undirected,n),o}function Rh(r,t,e,i,n,s){const o=t?xh:bh;r!=="undirected"&&(typeof i.in<"u"&&e!=="out"&&o(i.in,n,s),i.key!==n&&typeof i.out<"u"&&e!=="in"&&o(i.out,n,s)),r!=="directed"&&typeof i.undirected<"u"&&o(i.undirected,n,s)}function Mh(r,t,e,i,n,s){const o=t?Eh:wh;let a=!1;r!=="undirected"&&(typeof i.in<"u"&&e!=="out"&&(a=o(i.in,n,s),a)||i.key!==n&&typeof i.out<"u"&&e!=="in"&&(a=o(i.out,n,s,e?null:i.key),a))||r!=="directed"&&typeof i.undirected<"u"&&(a=o(i.undirected,n,s))}function Uh(r,t,e,i){let n=It.empty();return r!=="undirected"&&(typeof e.in<"u"&&t!=="out"&&i in e.in&&(n=Yt(n,vr(e.in,i))),typeof e.out<"u"&&t!=="in"&&i in e.out&&(n=Yt(n,vr(e.out,i)))),r!=="directed"&&typeof e.undirected<"u"&&i in e.undirected&&(n=Yt(n,vr(e.undirected,i))),n}function Fh(r,t){const{name:e,type:i,direction:n}=t;r.prototype[e]=function(s,o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(!arguments.length)return Th(this,i);if(arguments.length===1){s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new C(`Graph.${e}: could not find the "${s}" node in the graph.`);return Sh(this.multi,i==="mixed"?this.type:i,n,a)}if(arguments.length===2){s=""+s,o=""+o;const a=this._nodes.get(s);if(!a)throw new C(`Graph.${e}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new C(`Graph.${e}:  could not find the "${o}" target node in the graph.`);return Lh(i,this.multi,n,a,o)}throw new U(`Graph.${e}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Dh(r,t){const{name:e,type:i,direction:n}=t,s="forEach"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[s]=function(o,a,h){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return h=o,Ih(this,i,h);if(arguments.length===2){o=""+o,h=a;const u=this._nodes.get(o);if(typeof u>"u")throw new C(`Graph.${s}: could not find the "${o}" node in the graph.`);return Nh(this.multi,i==="mixed"?this.type:i,n,u,h)}if(arguments.length===3){o=""+o,a=""+a;const u=this._nodes.get(o);if(!u)throw new C(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new C(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return Rh(i,this.multi,n,u,a,h)}throw new U(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}}}function kh(r,t){const{name:e,type:i,direction:n}=t,s="forEach"+e[0].toUpperCase()+e.slice(1,-1)+"Until";r.prototype[s]=function(o,a,h){if(!(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)){if(arguments.length===1)return h=o,Ah(this,i,h);if(arguments.length===2){o=""+o,h=a;const u=this._nodes.get(o);if(typeof u>"u")throw new C(`Graph.${s}: could not find the "${o}" node in the graph.`);return Ch(this.multi,i==="mixed"?this.type:i,n,u,h)}if(arguments.length===3){o=""+o,a=""+a;const u=this._nodes.get(o);if(!u)throw new C(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new C(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return Mh(i,this.multi,n,u,a,h)}throw new U(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}}}function Bh(r,t){const{name:e,type:i,direction:n}=t,s=e.slice(0,-1)+"Entries";r.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return It.empty();if(!arguments.length)return Oh(this,i);if(arguments.length===1){o=""+o;const h=this._nodes.get(o);if(!h)throw new C(`Graph.${s}: could not find the "${o}" node in the graph.`);return Ph(i,n,h)}if(arguments.length===2){o=""+o,a=""+a;const h=this._nodes.get(o);if(!h)throw new C(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new C(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return Uh(i,n,h,a)}throw new U(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Gh(r){fh.forEach(t=>{Fh(r,t),Dh(r,t),kh(r,t),Bh(r,t)})}const Hh=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function gr(r,t){if(!(typeof t>"u"))for(const e in t)r.add(e)}function Xh(r,t,e){if(r!=="mixed"){if(r==="undirected")return Object.keys(e.undirected);if(typeof t=="string")return Object.keys(e[t])}const i=new Set;return r!=="undirected"&&(t!=="out"&&gr(i,e.in),t!=="in"&&gr(i,e.out)),r!=="directed"&&gr(i,e.undirected),Pn(i.values(),i.size)}function ts(r,t,e){for(const i in t){let n=t[i];n instanceof Set&&(n=n.values().next().value);const s=n.source,o=n.target,a=s===r?o:s;e(a.key,a.attributes)}}function yr(r,t,e,i){for(const n in e){let s=e[n];s instanceof Set&&(s=s.values().next().value);const o=s.source,a=s.target,h=o===t?a:o;r.has(h.key)||(r.add(h.key),i(h.key,h.attributes))}}function es(r,t,e){for(const i in t){let n=t[i];n instanceof Set&&(n=n.values().next().value);const s=n.source,o=n.target,a=s===r?o:s;if(e(a.key,a.attributes))return!0}return!1}function mr(r,t,e,i){for(const n in e){let s=e[n];s instanceof Set&&(s=s.values().next().value);const o=s.source,a=s.target,h=o===t?a:o;if(r.has(h.key))continue;if(r.add(h.key),i(h.key,h.attributes))return!0}return!1}function zh(r,t,e,i){if(r!=="mixed"){if(r==="undirected")return ts(e,e.undirected,i);if(typeof t=="string")return ts(e,e[t],i)}const n=new Set;r!=="undirected"&&(t!=="out"&&yr(n,e,e.in,i),t!=="in"&&yr(n,e,e.out,i)),r!=="directed"&&yr(n,e,e.undirected,i)}function jh(r,t,e,i){if(r!=="mixed"){if(r==="undirected")return es(e,e.undirected,i);if(typeof t=="string")return es(e,e[t],i)}const n=new Set;let s=!1;r!=="undirected"&&(t!=="out"&&(s=mr(n,e,e.in,i),s)||t!=="in"&&(s=mr(n,e,e.out,i),s))||r!=="directed"&&(s=mr(n,e,e.undirected,i))}function is(r,t){const e=Object.keys(t),i=e.length;let n=0;return new It(function(){if(n>=i)return{done:!0};let s=t[e[n++]];s instanceof Set&&(s=s.values().next().value);const o=s.source,a=s.target,h=o===r?a:o;return{done:!1,value:[h.key,h.attributes]}})}function _r(r,t,e){const i=Object.keys(e),n=i.length;let s=0;return new It(function o(){if(s>=n)return{done:!0};let a=e[i[s++]];a instanceof Set&&(a=a.values().next().value);const h=a.source,u=a.target,l=h===t?u:h;return r.has(l.key)?o():(r.add(l.key),{done:!1,value:[l.key,l.attributes]})})}function Wh(r,t,e){if(r!=="mixed"){if(r==="undirected")return is(e,e.undirected);if(typeof t=="string")return is(e,e[t])}let i=It.empty();const n=new Set;return r!=="undirected"&&(t!=="out"&&(i=Yt(i,_r(n,e,e.in))),t!=="in"&&(i=Yt(i,_r(n,e,e.out)))),r!=="directed"&&(i=Yt(i,_r(n,e,e.undirected))),i}function $h(r,t,e,i,n){const s=r._nodes.get(i);if(t!=="undirected"){if(e!=="out"&&typeof s.in<"u"){for(const o in s.in)if(o===n)return!0}if(e!=="in"&&typeof s.out<"u"){for(const o in s.out)if(o===n)return!0}}if(t!=="directed"&&typeof s.undirected<"u"){for(const o in s.undirected)if(o===n)return!0}return!1}function Vh(r,t){const{name:e,type:i,direction:n}=t;r.prototype[e]=function(s){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return[];if(arguments.length===2){const o=""+arguments[0],a=""+arguments[1];if(!this._nodes.has(o))throw new C(`Graph.${e}: could not find the "${o}" node in the graph.`);if(!this._nodes.has(a))throw new C(`Graph.${e}: could not find the "${a}" node in the graph.`);return $h(this,i,n,o,a)}else if(arguments.length===1){s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new C(`Graph.${e}: could not find the "${s}" node in the graph.`);return Xh(i==="mixed"?this.type:i,n,o)}throw new U(`Graph.${e}: invalid number of arguments (expecting 1 or 2 and got ${arguments.length}).`)}}function Yh(r,t){const{name:e,type:i,direction:n}=t,s="forEach"+e[0].toUpperCase()+e.slice(1,-1);r.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;o=""+o;const h=this._nodes.get(o);if(typeof h>"u")throw new C(`Graph.${s}: could not find the "${o}" node in the graph.`);zh(i==="mixed"?this.type:i,n,h,a)}}function qh(r,t){const{name:e,type:i,direction:n}=t,s="forEach"+e[0].toUpperCase()+e.slice(1,-1)+"Until";r.prototype[s]=function(o,a){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return;o=""+o;const h=this._nodes.get(o);if(typeof h>"u")throw new C(`Graph.${s}: could not find the "${o}" node in the graph.`);jh(i==="mixed"?this.type:i,n,h,a)}}function Kh(r,t){const{name:e,type:i,direction:n}=t,s=e.slice(0,-1)+"Entries";r.prototype[s]=function(o){if(i!=="mixed"&&this.type!=="mixed"&&i!==this.type)return It.empty();o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new C(`Graph.${s}: could not find the "${o}" node in the graph.`);return Wh(i==="mixed"?this.type:i,n,a)}}function Jh(r){Hh.forEach(t=>{Vh(r,t),Yh(r,t),qh(r,t),Kh(r,t)})}function rs(r,t,e){const i=t._nodes.values(),n=t.type;let s,o,a,h,u,l,f;for(;s=i.next(),s.done!==!0;){if(o=s.value,n!=="undirected"){h=o.out;for(a in h)if(u=h[a],l=u.target,f=e(o.key,l.key,o.attributes,l.attributes,u.key,u.attributes,u.undirected,u.generatedKey),r&&f)return}if(n!=="directed"){h=o.undirected;for(a in h)if(u=h[a],l=u.target,l.key!==a&&(l=u.source),f=e(o.key,l.key,o.attributes,l.attributes,u.key,u.attributes,u.undirected,u.generatedKey),r&&f)return}}}function ns(r,t,e){const i=t._nodes.values(),n=t.type;let s,o,a,h,u,l,f,d,c;for(;s=i.next(),s.done!==!0;){if(o=s.value,n!=="undirected"){l=o.out;for(a in l)for(h=l[a].values();u=h.next(),u.done!==!0;)if(f=u.value,d=f.target,c=e(o.key,d.key,o.attributes,d.attributes,f.key,f.attributes,f.undirected,f.generatedKey),r&&c)return}if(n!=="directed"){l=o.undirected;for(a in l)for(h=l[a].values();u=h.next(),u.done!==!0;)if(f=u.value,d=f.target,d.key!==a&&(d=f.source),c=e(o.key,d.key,o.attributes,d.attributes,f.key,f.attributes,f.undirected,f.generatedKey),r&&c)return}}}function Zh(r){const t=r._nodes.values(),e=r.type;let i="outer",n,s,o,a;return new It(function h(){let u;if(i==="outer")return u=t.next(),u.done===!0?u:(n=u.value,i="directed",h());if(i==="directed")return e==="undirected"?(i="undirected",h()):(o=n.out,s=Object.keys(n.out),a=0,i="inner-directed",h());if(i==="undirected"){if(e==="directed")return i="outer",h();o=n.undirected,s=Object.keys(n.undirected),a=0,i="inner-undirected"}if(a>=s.length)return i==="inner-undirected"?i="outer":i="undirected",h();const l=s[a++],f=o[l];let d=f.target;return i==="inner-undirected"&&d.key===n.key&&(d=f.source),{done:!1,value:[n.key,d.key,n.attributes,d.attributes,f.key,f.attributes]}})}function Qh(r){const t=r._nodes.values(),e=r.type;let i="outer",n,s,o=null,a,h;return new It(function u(){let l;if(i==="outer")return l=t.next(),l.done===!0?l:(n=l.value,i="directed",u());if(i==="directed")return e==="undirected"?(i="undirected",u()):(a=n.out,s=Object.keys(n.out),h=0,i="inner-directed",u());if(i==="undirected"){if(e==="directed")return i="outer",u();a=n.undirected,s=Object.keys(n.undirected),h=0,i="inner-undirected"}if(!o&&h>=s.length)return i==="inner-undirected"?i="outer":i="undirected",u();if(!o){const c=s[h++];return o=a[c].values(),u()}if(l=o.next(),l.done)return o=null,u();const f=l.value;let d=f.target;return i==="inner-undirected"&&d.key===n.key&&(d=f.source),{done:!1,value:[n.key,d.key,n.attributes,d.attributes,f.key,f.attributes]}})}function ss(r,t){const e={key:r};return ko(t.attributes)||(e.attributes=Et({},t.attributes)),e}function os(r,t){const e={source:t.source.key,target:t.target.key};return t.generatedKey||(e.key=r),ko(t.attributes)||(e.attributes=Et({},t.attributes)),t.undirected&&(e.undirected=!0),e}function tu(r){return wt(r)?"key"in r?"attributes"in r&&(!wt(r.attributes)||r.attributes===null)?"invalid-attributes":null:"no-key":"not-object"}function eu(r){return wt(r)?"source"in r?"target"in r?"attributes"in r&&(!wt(r.attributes)||r.attributes===null)?"invalid-attributes":"undirected"in r&&typeof r.undirected!="boolean"?"invalid-undirected":null:"no-target":"no-source":"not-object"}const iu=new Set(["directed","undirected","mixed"]),as=new Set(["domain","_events","_eventsCount","_maxListeners"]),ru=[{name:r=>`${r}Edge`,generateKey:!0},{name:r=>`${r}DirectedEdge`,generateKey:!0,type:"directed"},{name:r=>`${r}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:r=>`${r}EdgeWithKey`},{name:r=>`${r}DirectedEdgeWithKey`,type:"directed"},{name:r=>`${r}UndirectedEdgeWithKey`,type:"undirected"}],nu={allowSelfLoops:!0,edgeKeyGenerator:null,multi:!1,type:"mixed"};function su(r,t,e){if(e&&!wt(e))throw new U(`Graph.addNode: invalid attributes. Expecting an object but got "${e}"`);if(t=""+t,e=e||{},r._nodes.has(t))throw new K(`Graph.addNode: the "${t}" node already exist in the graph.`);const i=new r.NodeDataClass(t,e);return r._nodes.set(t,i),r.emit("nodeAdded",{key:t,attributes:e}),i}function hs(r,t,e){const i=new r.NodeDataClass(t,e);return r._nodes.set(t,i),r.emit("nodeAdded",{key:t,attributes:e}),i}function ou(r,t,e,i,n,s,o,a){if(!i&&r.type==="undirected")throw new K(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&r.type==="directed")throw new K(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!wt(a))throw new U(`Graph.${t}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!r.allowSelfLoops&&s===o)throw new K(`Graph.${t}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const h=r._nodes.get(s),u=r._nodes.get(o);if(!h)throw new C(`Graph.${t}: source node "${s}" not found.`);if(!u)throw new C(`Graph.${t}: target node "${o}" not found.`);const l={key:null,undirected:i,source:s,target:o,attributes:a};if(e&&(n=r._edgeKeyGenerator(l)),n=""+n,r._edges.has(n))throw new K(`Graph.${t}: the "${n}" edge already exists in the graph.`);if(!r.multi&&(i?typeof h.undirected[o]<"u":typeof h.out[o]<"u"))throw new K(`Graph.${t}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const f=new Ho(i,n,e,h,u,a);return r._edges.set(n,f),s===o?i?(h.undirectedSelfLoops++,r._undirectedSelfLoopCount++):(h.directedSelfLoops++,r._directedSelfLoopCount++):i?(h.undirectedDegree++,u.undirectedDegree++):(h.outDegree++,u.inDegree++),Xo(r,i,f,s,o,h,u),i?r._undirectedSize++:r._directedSize++,l.key=n,r.emit("edgeAdded",l),n}function au(r,t,e,i,n,s,o,a,h){if(!i&&r.type==="undirected")throw new K(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(i&&r.type==="directed")throw new K(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a){if(h){if(typeof a!="function")throw new U(`Graph.${t}: invalid updater function. Expecting a function but got "${a}"`)}else if(!wt(a))throw new U(`Graph.${t}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let u;if(h&&(u=a,a=void 0),!r.allowSelfLoops&&s===o)throw new K(`Graph.${t}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let l=r._nodes.get(s),f=r._nodes.get(o),d,c;if(!e&&(d=r._edges.get(n),d)){if(d.source.key!==s||d.target.key!==o||i&&(d.source.key!==o||d.target.key!==s))throw new K(`Graph.${t}: inconsistency detected when attempting to merge the "${n}" edge with "${s}" source & "${o}" target vs. ("${d.source.key}", "${d.target.key}").`);c=d}if(!c&&!r.multi&&l&&(c=i?l.undirected[o]:l.out[o]),c){if(h?!u:!a)return c.key;if(h){const v=c.attributes;c.attributes=u(v),r.emit("edgeAttributesUpdated",{type:"replace",key:c.key,attributes:c.attributes})}else Et(c.attributes,a),r.emit("edgeAttributesUpdated",{type:"merge",key:c.key,attributes:c.attributes,data:a});return c.key}a=a||{},h&&u&&(a=u(a));const p={key:null,undirected:i,source:s,target:o,attributes:a};if(e&&(n=r._edgeKeyGenerator(p)),n=""+n,r._edges.has(n))throw new K(`Graph.${t}: the "${n}" edge already exists in the graph.`);return l||(l=hs(r,s,{}),s===o&&(f=l)),f||(f=hs(r,o,{})),d=new Ho(i,n,e,l,f,a),r._edges.set(n,d),s===o?i?(l.undirectedSelfLoops++,r._undirectedSelfLoopCount++):(l.directedSelfLoops++,r._directedSelfLoopCount++):i?(l.undirectedDegree++,f.undirectedDegree++):(l.outDegree++,f.inDegree++),Xo(r,i,d,s,o,l,f),i?r._undirectedSize++:r._directedSize++,p.key=n,r.emit("edgeAdded",p),n}class tt extends zi.EventEmitter{constructor(t){if(super(),t=Et({},nu,t),t.edgeKeyGenerator&&typeof t.edgeKeyGenerator!="function")throw new U(`Graph.constructor: invalid 'edgeKeyGenerator' option. Expecting a function but got "${t.edgeKeyGenerator}".`);if(typeof t.multi!="boolean")throw new U(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!iu.has(t.type))throw new U(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new U(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const e=t.type==="mixed"?Qn:t.type==="directed"?Bo:Go;St(this,"NodeDataClass",e),St(this,"_attributes",{}),St(this,"_nodes",new Map),St(this,"_edges",new Map),St(this,"_directedSize",0),St(this,"_undirectedSize",0),St(this,"_directedSelfLoopCount",0),St(this,"_undirectedSelfLoopCount",0),St(this,"_edgeKeyGenerator",t.edgeKeyGenerator||Ja()),St(this,"_options",t),as.forEach(i=>St(this,i,this[i])),Nt(this,"order",()=>this._nodes.size),Nt(this,"size",()=>this._edges.size),Nt(this,"directedSize",()=>this._directedSize),Nt(this,"undirectedSize",()=>this._undirectedSize),Nt(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Nt(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Nt(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Nt(this,"multi",this._options.multi),Nt(this,"type",this._options.type),Nt(this,"allowSelfLoops",this._options.allowSelfLoops),Nt(this,"implementation",()=>"graphology")}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,e){if(this.type==="undirected")return!1;if(arguments.length===1){const i=""+t,n=this._edges.get(i);return!!n&&!n.undirected}else if(arguments.length===2){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)return!1;const n=i.out[e];return n?this.multi?!!n.size:!0:!1}throw new U(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,e){if(this.type==="directed")return!1;if(arguments.length===1){const i=""+t,n=this._edges.get(i);return!!n&&n.undirected}else if(arguments.length===2){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)return!1;const n=i.undirected[e];return n?this.multi?!!n.size:!0:!1}throw new U(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,e){if(arguments.length===1){const i=""+t;return this._edges.has(i)}else if(arguments.length===2){t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)return!1;let n=typeof i.out<"u"&&i.out[e];return n||(n=typeof i.undirected<"u"&&i.undirected[e]),n?this.multi?!!n.size:!0:!1}throw new U(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,e){if(this.type==="undirected")return;if(t=""+t,e=""+e,this.multi)throw new K("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const i=this._nodes.get(t);if(!i)throw new C(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new C(`Graph.directedEdge: could not find the "${e}" target node in the graph.`);const n=i.out&&i.out[e]||void 0;if(n)return n.key}undirectedEdge(t,e){if(this.type==="directed")return;if(t=""+t,e=""+e,this.multi)throw new K("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const i=this._nodes.get(t);if(!i)throw new C(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new C(`Graph.undirectedEdge: could not find the "${e}" target node in the graph.`);const n=i.undirected&&i.undirected[e]||void 0;if(n)return n.key}edge(t,e){if(this.multi)throw new K("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,e=""+e;const i=this._nodes.get(t);if(!i)throw new C(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(e))throw new C(`Graph.edge: could not find the "${e}" target node in the graph.`);const n=i.out&&i.out[e]||i.undirected&&i.undirected[e]||void 0;if(n)return n.key}inDegree(t,e=!0){if(typeof e!="boolean")throw new U(`Graph.inDegree: Expecting a boolean but got "${e}" for the second parameter (allowing self-loops to be counted).`);t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.inDegree: could not find the "${t}" node in the graph.`);if(this.type==="undirected")return 0;const n=e?i.directedSelfLoops:0;return i.inDegree+n}outDegree(t,e=!0){if(typeof e!="boolean")throw new U(`Graph.outDegree: Expecting a boolean but got "${e}" for the second parameter (allowing self-loops to be counted).`);t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.outDegree: could not find the "${t}" node in the graph.`);if(this.type==="undirected")return 0;const n=e?i.directedSelfLoops:0;return i.outDegree+n}directedDegree(t,e=!0){if(typeof e!="boolean")throw new U(`Graph.directedDegree: Expecting a boolean but got "${e}" for the second parameter (allowing self-loops to be counted).`);t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.directedDegree: could not find the "${t}" node in the graph.`);if(this.type==="undirected")return 0;const n=e?i.directedSelfLoops:0,s=i.inDegree+n,o=i.outDegree+n;return s+o}undirectedDegree(t,e=!0){if(typeof e!="boolean")throw new U(`Graph.undirectedDegree: Expecting a boolean but got "${e}" for the second parameter (allowing self-loops to be counted).`);t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);if(this.type==="directed")return 0;const n=e?i.undirectedSelfLoops:0;return i.undirectedDegree+n*2}degree(t,e=!0){if(typeof e!="boolean")throw new U(`Graph.degree: Expecting a boolean but got "${e}" for the second parameter (allowing self-loops to be counted).`);t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.degree: could not find the "${t}" node in the graph.`);let n=0,s=0;return this.type!=="directed"&&(e&&(s=i.undirectedSelfLoops),n+=i.undirectedDegree+s*2),this.type!=="undirected"&&(e&&(s=i.directedSelfLoops),n+=i.inDegree+i.outDegree+s*2),n}source(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.source: could not find the "${t}" edge in the graph.`);return e.source.key}target(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.target: could not find the "${t}" edge in the graph.`);return e.target.key}extremities(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[e.source.key,e.target.key]}opposite(t,e){t=""+t,e=""+e;const i=this._edges.get(e);if(!i)throw new C(`Graph.opposite: could not find the "${e}" edge in the graph.`);const n=i.source.key,s=i.target.key;if(t!==n&&t!==s)throw new C(`Graph.opposite: the "${t}" node is not attached to the "${e}" edge (${n}, ${s}).`);return t===n?s:n}hasExtremity(t,e){t=""+t,e=""+e;const i=this._edges.get(t);if(!i)throw new C(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return i.source.key===e||i.target.key===e}isUndirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return e.undirected}isDirected(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!e.undirected}isSelfLoop(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return e.source===e.target}hasGeneratedKey(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.hasGeneratedKey: could not find the "${t}" edge in the graph.`);return e.generatedKey}addNode(t,e){return su(this,t,e).key}mergeNode(t,e){if(e&&!wt(e))throw new U(`Graph.mergeNode: invalid attributes. Expecting an object but got "${e}"`);t=""+t,e=e||{};let i=this._nodes.get(t);return i?(e&&(Et(i.attributes,e),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:i.attributes,data:e})),t):(i=new this.NodeDataClass(t,e),this._nodes.set(t,i),this.emit("nodeAdded",{key:t,attributes:e}),t)}updateNode(t,e){if(e&&typeof e!="function")throw new U(`Graph.updateNode: invalid updater function. Expecting a function but got "${e}"`);t=""+t;let i=this._nodes.get(t);if(i){if(e){const s=i.attributes;i.attributes=e(s),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:i.attributes})}return t}const n=e?e({}):{};return i=new this.NodeDataClass(t,n),this._nodes.set(t,i),this.emit("nodeAdded",{key:t,attributes:n}),t}dropNode(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new C(`Graph.dropNode: could not find the "${t}" node in the graph.`);this.forEachEdge(t,i=>{this.dropEdge(i)}),this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:e.attributes})}dropEdge(t){let e;if(arguments.length>1){const a=""+arguments[0],h=""+arguments[1];if(e=Jt(this,a,h,this.type),!e)throw new C(`Graph.dropEdge: could not find the "${a}" -> "${h}" edge in the graph.`)}else if(t=""+t,e=this._edges.get(t),!e)throw new C(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);this._edges.delete(e.key);const{source:i,target:n,attributes:s}=e,o=e.undirected;return i===n?o?(i.undirectedSelfLoops--,this._undirectedSelfLoopCount--):(i.directedSelfLoops--,this._directedSelfLoopCount--):o?(i.undirectedDegree--,n.undirectedDegree--):(i.outDegree--,n.inDegree--),Za(this,o,e),o?this._undirectedSize--:this._directedSize--,this.emit("edgeDropped",{key:t,attributes:s,source:i.key,target:n.key,undirected:o}),this}clear(){this._edges.clear(),this._nodes.clear(),this.emit("cleared")}clearEdges(){this._edges.clear(),this.clearIndex(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,e){return this._attributes[t]=e,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,e){if(typeof e!="function")throw new U("Graph.updateAttribute: updater should be a function.");const i=this._attributes[t];return this._attributes[t]=e(i),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!wt(t))throw new U("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!wt(t))throw new U("Graph.mergeAttributes: provided attributes are not a plain object.");return Et(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}getNodeAttribute(t,e){t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.getNodeAttribute: could not find the "${t}" node in the graph.`);return i.attributes[e]}getNodeAttributes(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new C(`Graph.getNodeAttributes: could not find the "${t}" node in the graph.`);return e.attributes}hasNodeAttribute(t,e){t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.hasNodeAttribute: could not find the "${t}" node in the graph.`);return i.attributes.hasOwnProperty(e)}setNodeAttribute(t,e,i){t=""+t;const n=this._nodes.get(t);if(!n)throw new C(`Graph.setNodeAttribute: could not find the "${t}" node in the graph.`);if(arguments.length<3)throw new U("Graph.setNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or value, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");return n.attributes[e]=i,this.emit("nodeAttributesUpdated",{key:t,type:"set",attributes:n.attributes,name:e}),this}updateNodeAttribute(t,e,i){t=""+t;const n=this._nodes.get(t);if(!n)throw new C(`Graph.updateNodeAttribute: could not find the "${t}" node in the graph.`);if(arguments.length<3)throw new U("Graph.updateNodeAttribute: not enough arguments. Either you forgot to pass the attribute's name or updater, or you meant to use #.replaceNodeAttributes / #.mergeNodeAttributes instead.");if(typeof i!="function")throw new U("Graph.updateAttribute: updater should be a function.");const s=n.attributes,o=i(s[e]);return s[e]=o,this.emit("nodeAttributesUpdated",{key:t,type:"set",attributes:n.attributes,name:e}),this}removeNodeAttribute(t,e){t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.hasNodeAttribute: could not find the "${t}" node in the graph.`);return delete i.attributes[e],this.emit("nodeAttributesUpdated",{key:t,type:"remove",attributes:i.attributes,name:e}),this}replaceNodeAttributes(t,e){t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.replaceNodeAttributes: could not find the "${t}" node in the graph.`);if(!wt(e))throw new U("Graph.replaceNodeAttributes: provided attributes are not a plain object.");return i.attributes=e,this.emit("nodeAttributesUpdated",{key:t,type:"replace",attributes:i.attributes}),this}mergeNodeAttributes(t,e){t=""+t;const i=this._nodes.get(t);if(!i)throw new C(`Graph.mergeNodeAttributes: could not find the "${t}" node in the graph.`);if(!wt(e))throw new U("Graph.mergeNodeAttributes: provided attributes are not a plain object.");return Et(i.attributes,e),this.emit("nodeAttributesUpdated",{key:t,type:"merge",attributes:i.attributes,data:e}),this}updateEachNodeAttributes(t,e){if(typeof t!="function")throw new U("Graph.updateEachNodeAttributes: expecting an updater function.");if(e&&!Zn(e))throw new U("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._nodes.values();let n,s;for(;n=i.next(),n.done!==!0;)s=n.value,s.attributes=t(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:e||null})}updateEachEdgeAttributes(t,e){if(typeof t!="function")throw new U("Graph.updateEachEdgeAttributes: expecting an updater function.");if(e&&!Zn(e))throw new U("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const i=this._edges.values();let n,s;for(;n=i.next(),n.done!==!0;)s=n.value,s.attributes=t(s.key,s.attributes);this.emit("eachEdgeAttributesUpdated",{hints:e||null})}forEach(t){if(typeof t!="function")throw new U("Graph.forEach: expecting a callback.");this.multi?ns(!1,this,t):rs(!1,this,t)}forEachUntil(t){if(typeof t!="function")throw new U("Graph.forEach: expecting a callback.");this.multi?ns(!0,this,t):rs(!0,this,t)}adjacency(){return this.multi?Qh(this):Zh(this)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):Pn(this._nodes.keys(),this._nodes.size)}forEachNode(t){if(typeof t!="function")throw new U("Graph.forEachNode: expecting a callback.");this._nodes.forEach((e,i)=>{t(i,e.attributes)})}forEachNodeUntil(t){if(typeof t!="function")throw new U("Graph.forEachNode: expecting a callback.");const e=this._nodes.values();let i,n,s;for(;(i=e.next(),i!==!0)&&(n=i.value,s=t(n.key,n.attributes),!s););}nodeEntries(){const t=this._nodes.values();return new It(()=>{const e=t.next();if(e.done)return e;const i=e.value;return{value:[i.key,i.attributes],done:!1}})}exportNode(t){t=""+t;const e=this._nodes.get(t);if(!e)throw new C(`Graph.exportNode: could not find the "${t}" node in the graph.`);return ss(t,e)}exportEdge(t){t=""+t;const e=this._edges.get(t);if(!e)throw new C(`Graph.exportEdge: could not find the "${t}" edge in the graph.`);return os(t,e)}export(){const t=new Array(this._nodes.size);let e=0;this._nodes.forEach((n,s)=>{t[e++]=ss(s,n)});const i=new Array(this._edges.size);return e=0,this._edges.forEach((n,s)=>{i[e++]=os(s,n)}),{attributes:this.getAttributes(),nodes:t,edges:i,options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops}}}importNode(t,e=!1){const i=tu(t);if(i){if(i==="not-object")throw new U('Graph.importNode: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(i==="no-key")throw new U("Graph.importNode: no key provided.");if(i==="invalid-attributes")throw new U("Graph.importNode: invalid attributes. Attributes should be a plain object, null or omitted.")}const{key:n,attributes:s={}}=t;return e?this.mergeNode(n,s):this.addNode(n,s),this}importEdge(t,e=!1){const i=eu(t);if(i){if(i==="not-object")throw new U('Graph.importEdge: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(i==="no-source")throw new U("Graph.importEdge: missing souce.");if(i==="no-target")throw new U("Graph.importEdge: missing target.");if(i==="invalid-attributes")throw new U("Graph.importEdge: invalid attributes. Attributes should be a plain object, null or omitted.");if(i==="invalid-undirected")throw new U("Graph.importEdge: invalid undirected. Undirected should be boolean or omitted.")}const{source:n,target:s,attributes:o={},undirected:a=!1}=t;let h;return"key"in t?(h=e?a?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:a?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,h.call(this,t.key,n,s,o)):(h=e?a?this.mergeUndirectedEdge:this.mergeDirectedEdge:a?this.addUndirectedEdge:this.addDirectedEdge,h.call(this,n,s,o)),this}import(t,e=!1){if(Ka(t))return this.import(t.export(),e),this;if(!wt(t))throw new U("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!wt(t.attributes))throw new U("Graph.import: invalid attributes. Expecting a plain object.");e?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let i,n,s;if(t.nodes){if(s=t.nodes,!Array.isArray(s))throw new U("Graph.import: invalid nodes. Expecting an array.");for(i=0,n=s.length;i<n;i++)this.importNode(s[i],e)}if(t.edges){if(s=t.edges,!Array.isArray(s))throw new U("Graph.import: invalid edges. Expecting an array.");for(i=0,n=s.length;i<n;i++)this.importEdge(s[i],e)}return this}nullCopy(t){return new tt(Et({},this._options,t))}emptyCopy(t){const e=this.nullCopy(t);return this._nodes.forEach((i,n)=>{const s=Et({},i.attributes);i=new e.NodeDataClass(n,s),e._nodes.set(n,i)}),e}copy(){const t=new tt(this._options);return t.import(this),t}upgradeToMixed(){return this.type==="mixed"?this:(this._nodes.forEach(t=>t.upgradeToMixed()),this._options.type="mixed",Nt(this,"type",this._options.type),St(this,"NodeDataClass",Qn),this)}upgradeToMulti(){return this.multi?this:(this._options.multi=!0,Nt(this,"multi",!0),th(this),this)}clearIndex(){return Qa(this),this}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((s,o)=>{t[o]=s.attributes});const e={},i={};this._edges.forEach((s,o)=>{const a=s.undirected?"--":"->";let h="";const u=`(${s.source.key})${a}(${s.target.key})`;s.generatedKey?this.multi&&(typeof i[u]>"u"?i[u]=0:i[u]++,h+=`${i[u]}. `):h+=`[${o}]: `,h+=u,e[h]=s.attributes});const n={};for(const s in this)this.hasOwnProperty(s)&&!as.has(s)&&typeof this[s]!="function"&&(n[s]=this[s]);return n.attributes=this._attributes,n.nodes=t,n.edges=e,St(n,"constructor",this.constructor),n}}typeof Symbol<"u"&&(tt.prototype[Symbol.for("nodejs.util.inspect.custom")]=tt.prototype.inspect);ru.forEach(r=>{["add","merge","update"].forEach(t=>{const e=r.name(t),i=t==="add"?ou:au;r.generateKey?tt.prototype[e]=function(n,s,o){return i(this,e,!0,(r.type||this.type)==="undirected",null,n,s,o,t==="update")}:tt.prototype[e]=function(n,s,o,a){return i(this,e,!1,(r.type||this.type)==="undirected",n,s,o,a,t==="update")}})});typeof Symbol<"u"&&(tt.prototype[Symbol.iterator]=tt.prototype.adjacency);lh(tt);Gh(tt);Jh(tt);class zo extends tt{constructor(t){const e=Et({type:"directed"},t);if("multi"in e&&e.multi!==!1)throw new U("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="directed")throw new U('DirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class jo extends tt{constructor(t){const e=Et({type:"undirected"},t);if("multi"in e&&e.multi!==!1)throw new U("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(e.type!=="undirected")throw new U('UndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class Wo extends tt{constructor(t){const e=Et({multi:!0},t);if("multi"in e&&e.multi!==!0)throw new U("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(e)}}class $o extends tt{constructor(t){const e=Et({type:"directed",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new U("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="directed")throw new U('MultiDirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}class Vo extends tt{constructor(t){const e=Et({type:"undirected",multi:!0},t);if("multi"in e&&e.multi!==!0)throw new U("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(e.type!=="undirected")throw new U('MultiUndirectedGraph.from: inconsistent "'+e.type+'" type in given options!');super(e)}}function We(r){r.from=function(t,e){const i=Et({},t.options,e),n=new r(i);return n.import(t),n}}We(tt);We(zo);We(jo);We(Wo);We($o);We(Vo);tt.Graph=tt;tt.DirectedGraph=zo;tt.UndirectedGraph=jo;tt.MultiGraph=Wo;tt.MultiDirectedGraph=$o;tt.MultiUndirectedGraph=Vo;tt.InvalidArgumentsGraphError=U;tt.NotFoundGraphError=C;tt.UsageGraphError=K;/*!
 * @pixi/constants - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Kt;(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(Kt||(Kt={}));var si;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"})(si||(si={}));var ji;(function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"})(ji||(ji={}));var G;(function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"})(G||(G={}));var Lt;(function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Lt||(Lt={}));var R;(function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(R||(R={}));var ve;(function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(ve||(ve={}));var W;(function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT"})(W||(W={}));var Wi;(function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"})(Wi||(Wi={}));var Gt;(function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"})(Gt||(Gt={}));var ke;(function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(ke||(ke={}));var _e;(function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"})(_e||(_e={}));var ee;(function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"})(ee||(ee={}));var Qt;(function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"})(Qt||(Qt={}));var Yr;(function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"})(Yr||(Yr={}));var Ht;(function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"})(Ht||(Ht={}));var Ct;(function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE"})(Ct||(Ct={}));var yt;(function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"})(yt||(yt={}));var zt;(function(r){r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(zt||(zt={}));var br=/iPhone/i,us=/iPod/i,ls=/iPad/i,fs=/\biOS-universal(?:.+)Mac\b/i,xr=/\bAndroid(?:.+)Mobile\b/i,ds=/Android/i,Te=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,bi=/Silk/i,jt=/Windows Phone/i,cs=/\bWindows(?:.+)ARM\b/i,ps=/BlackBerry/i,vs=/BB10/i,gs=/Opera Mini/i,ys=/\b(CriOS|Chrome)(?:.+)Mobile/i,ms=/Mobile(?:.+)Firefox\b/i,_s=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function hu(r){return function(t){return t.test(r)}}function uu(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var n=hu(e),s={apple:{phone:n(br)&&!n(jt),ipod:n(us),tablet:!n(br)&&(n(ls)||_s(t))&&!n(jt),universal:n(fs),device:(n(br)||n(us)||n(ls)||n(fs)||_s(t))&&!n(jt)},amazon:{phone:n(Te),tablet:!n(Te)&&n(bi),device:n(Te)||n(bi)},android:{phone:!n(jt)&&n(Te)||!n(jt)&&n(xr),tablet:!n(jt)&&!n(Te)&&!n(xr)&&(n(bi)||n(ds)),device:!n(jt)&&(n(Te)||n(bi)||n(xr)||n(ds))||n(/\bokhttp\b/i)},windows:{phone:n(jt),tablet:n(cs),device:n(jt)||n(cs)},other:{blackberry:n(ps),blackberry10:n(vs),opera:n(gs),firefox:n(ms),chrome:n(ys),device:n(ps)||n(vs)||n(gs)||n(ms)||n(ys)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s}/*!
 * @pixi/settings - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var pe=uu(self.navigator);function lu(r){var t=!0;if(pe.tablet||pe.phone){if(pe.apple.device){var e=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(e){var i=parseInt(e[1],10);i<11&&(t=!1)}}if(pe.android.device){var e=navigator.userAgent.match(/Android\s([0-9.]*)/);if(e){var i=parseInt(e[1],10);i<7&&(t=!1)}}}return t?r:4}function fu(){return!pe.apple.device}/*!
 * @pixi/constants - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var bs;(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(bs||(bs={}));var xs;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"})(xs||(xs={}));var ws;(function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"})(ws||(ws={}));var Es;(function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"})(Es||(Es={}));var Ts;(function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(Ts||(Ts={}));var Is;(function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(Is||(Is={}));var As;(function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(As||(As={}));var Os;(function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT"})(Os||(Os={}));var Ss;(function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"})(Ss||(Ss={}));var qr;(function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"})(qr||(qr={}));var Kr;(function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(Kr||(Kr={}));var Jr;(function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"})(Jr||(Jr={}));var Ns;(function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"})(Ns||(Ns={}));var Cs;(function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"})(Cs||(Cs={}));var Zr;(function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"})(Zr||(Zr={}));var ii;(function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"})(ii||(ii={}));var Ps;(function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE"})(Ps||(Ps={}));var Qr;(function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"})(Qr||(Qr={}));var Ls;(function(r){r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(Ls||(Ls={}));var z={MIPMAP_TEXTURES:Jr.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:Qr.NONE,SPRITE_MAX_TEXTURES:lu(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Zr.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:Kr.CLAMP,SCALE_MODE:qr.LINEAR,PRECISION_VERTEX:ii.HIGH,PRECISION_FRAGMENT:pe.apple.device?ii.HIGH:ii.MEDIUM,CAN_UPLOAD_SAME_BUFFER:fu(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},tn={},du={get exports(){return tn},set exports(r){tn=r}};(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function n(h,u,l){this.fn=h,this.context=u,this.once=l||!1}function s(h,u,l,f,d){if(typeof l!="function")throw new TypeError("The listener must be a function");var c=new n(l,f||h,d),p=e?e+u:u;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],c]:h._events[p].push(c):(h._events[p]=c,h._eventsCount++),h}function o(h,u){--h._eventsCount===0?h._events=new i:delete h._events[u]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,f;if(this._eventsCount===0)return u;for(f in l=this._events)t.call(l,f)&&u.push(e?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=e?e+u:u,f=this._events[l];if(!f)return[];if(f.fn)return[f.fn];for(var d=0,c=f.length,p=new Array(c);d<c;d++)p[d]=f[d].fn;return p},a.prototype.listenerCount=function(u){var l=e?e+u:u,f=this._events[l];return f?f.fn?1:f.length:0},a.prototype.emit=function(u,l,f,d,c,p){var v=e?e+u:u;if(!this._events[v])return!1;var g=this._events[v],y=arguments.length,b,_;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,l),!0;case 3:return g.fn.call(g.context,l,f),!0;case 4:return g.fn.call(g.context,l,f,d),!0;case 5:return g.fn.call(g.context,l,f,d,c),!0;case 6:return g.fn.call(g.context,l,f,d,c,p),!0}for(_=1,b=new Array(y-1);_<y;_++)b[_-1]=arguments[_];g.fn.apply(g.context,b)}else{var T=g.length,m;for(_=0;_<T;_++)switch(g[_].once&&this.removeListener(u,g[_].fn,void 0,!0),y){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,l);break;case 3:g[_].fn.call(g[_].context,l,f);break;case 4:g[_].fn.call(g[_].context,l,f,d);break;default:if(!b)for(m=1,b=new Array(y-1);m<y;m++)b[m-1]=arguments[m];g[_].fn.apply(g[_].context,b)}}return!0},a.prototype.on=function(u,l,f){return s(this,u,l,f,!1)},a.prototype.once=function(u,l,f){return s(this,u,l,f,!0)},a.prototype.removeListener=function(u,l,f,d){var c=e?e+u:u;if(!this._events[c])return this;if(!l)return o(this,c),this;var p=this._events[c];if(p.fn)p.fn===l&&(!d||p.once)&&(!f||p.context===f)&&o(this,c);else{for(var v=0,g=[],y=p.length;v<y;v++)(p[v].fn!==l||d&&!p[v].once||f&&p[v].context!==f)&&g.push(p[v]);g.length?this._events[c]=g.length===1?g[0]:g:o(this,c)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=e?e+u:u,this._events[l]&&o(this,l)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,r.exports=a})(du);const vi=tn;var be={},cu={get exports(){return be},set exports(r){be=r}};cu.exports=sr;be.default=sr;function sr(r,t,e){e=e||2;var i=t&&t.length,n=i?t[0]*e:r.length,s=Yo(r,0,n,e,!0),o=[];if(!s||s.next===s.prev)return o;var a,h,u,l,f,d,c;if(i&&(s=mu(r,t,s,e)),r.length>80*e){a=u=r[0],h=l=r[1];for(var p=e;p<n;p+=e)f=r[p],d=r[p+1],f<a&&(a=f),d<h&&(h=d),f>u&&(u=f),d>l&&(l=d);c=Math.max(u-a,l-h),c=c!==0?1/c:0}return oi(s,o,e,a,h,c),o}function Yo(r,t,e,i,n){var s,o;if(n===nn(r,t,e,i)>0)for(s=t;s<e;s+=i)o=Rs(s,r[s],r[s+1],o);else for(s=e-i;s>=t;s-=i)o=Rs(s,r[s],r[s+1],o);return o&&or(o,o.next)&&(hi(o),o=o.next),o}function ie(r,t){if(!r)return r;t||(t=r);var e=r,i;do if(i=!1,!e.steiner&&(or(e,e.next)||ht(e.prev,e,e.next)===0)){if(hi(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function oi(r,t,e,i,n,s,o){if(r){!o&&s&&Eu(r,i,n,s);for(var a=r,h,u;r.prev!==r.next;){if(h=r.prev,u=r.next,s?vu(r,i,n,s):pu(r)){t.push(h.i/e),t.push(r.i/e),t.push(u.i/e),hi(r),r=u.next,a=u.next;continue}if(r=u,r===a){o?o===1?(r=gu(ie(r),t,e),oi(r,t,e,i,n,s,2)):o===2&&yu(r,t,e,i,n,s):oi(ie(r),t,e,i,n,s,1);break}}}}function pu(r){var t=r.prev,e=r,i=r.next;if(ht(t,e,i)>=0)return!1;for(var n=r.next.next;n!==r.prev;){if(Ce(t.x,t.y,e.x,e.y,i.x,i.y,n.x,n.y)&&ht(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function vu(r,t,e,i){var n=r.prev,s=r,o=r.next;if(ht(n,s,o)>=0)return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,h=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,u=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,l=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,f=en(a,h,t,e,i),d=en(u,l,t,e,i),c=r.prevZ,p=r.nextZ;c&&c.z>=f&&p&&p.z<=d;){if(c!==r.prev&&c!==r.next&&Ce(n.x,n.y,s.x,s.y,o.x,o.y,c.x,c.y)&&ht(c.prev,c,c.next)>=0||(c=c.prevZ,p!==r.prev&&p!==r.next&&Ce(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&ht(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;c&&c.z>=f;){if(c!==r.prev&&c!==r.next&&Ce(n.x,n.y,s.x,s.y,o.x,o.y,c.x,c.y)&&ht(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;p&&p.z<=d;){if(p!==r.prev&&p!==r.next&&Ce(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&ht(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function gu(r,t,e){var i=r;do{var n=i.prev,s=i.next.next;!or(n,s)&&qo(n,i,i.next,s)&&ai(n,s)&&ai(s,n)&&(t.push(n.i/e),t.push(i.i/e),t.push(s.i/e),hi(i),hi(i.next),i=r=s),i=i.next}while(i!==r);return ie(i)}function yu(r,t,e,i,n,s){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Au(o,a)){var h=Ko(o,a);o=ie(o,o.next),h=ie(h,h.next),oi(o,t,e,i,n,s),oi(h,t,e,i,n,s);return}a=a.next}o=o.next}while(o!==r)}function mu(r,t,e,i){var n=[],s,o,a,h,u;for(s=0,o=t.length;s<o;s++)a=t[s]*i,h=s<o-1?t[s+1]*i:r.length,u=Yo(r,a,h,i,!1),u===u.next&&(u.steiner=!0),n.push(Iu(u));for(n.sort(_u),s=0;s<n.length;s++)bu(n[s],e),e=ie(e,e.next);return e}function _u(r,t){return r.x-t.x}function bu(r,t){if(t=xu(r,t),t){var e=Ko(t,r);ie(t,t.next),ie(e,e.next)}}function xu(r,t){var e=t,i=r.x,n=r.y,s=-1/0,o;do{if(n<=e.y&&n>=e.next.y&&e.next.y!==e.y){var a=e.x+(n-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>s){if(s=a,a===i){if(n===e.y)return e;if(n===e.next.y)return e.next}o=e.x<e.next.x?e:e.next}}e=e.next}while(e!==t);if(!o)return null;if(i===s)return o;var h=o,u=o.x,l=o.y,f=1/0,d;e=o;do i>=e.x&&e.x>=u&&i!==e.x&&Ce(n<l?i:s,n,u,l,n<l?s:i,n,e.x,e.y)&&(d=Math.abs(n-e.y)/(i-e.x),ai(e,r)&&(d<f||d===f&&(e.x>o.x||e.x===o.x&&wu(o,e)))&&(o=e,f=d)),e=e.next;while(e!==h);return o}function wu(r,t){return ht(r.prev,r,t.prev)<0&&ht(t.next,r,r.next)<0}function Eu(r,t,e,i){var n=r;do n.z===null&&(n.z=en(n.x,n.y,t,e,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==r);n.prevZ.nextZ=null,n.prevZ=null,Tu(n)}function Tu(r){var t,e,i,n,s,o,a,h,u=1;do{for(e=r,r=null,s=null,o=0;e;){for(o++,i=e,a=0,t=0;t<u&&(a++,i=i.nextZ,!!i);t++);for(h=u;a>0||h>0&&i;)a!==0&&(h===0||!i||e.z<=i.z)?(n=e,e=e.nextZ,a--):(n=i,i=i.nextZ,h--),s?s.nextZ=n:r=n,n.prevZ=s,s=n;e=i}s.nextZ=null,u*=2}while(o>1);return r}function en(r,t,e,i,n){return r=32767*(r-e)*n,t=32767*(t-i)*n,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function Iu(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Ce(r,t,e,i,n,s,o,a){return(n-o)*(t-a)-(r-o)*(s-a)>=0&&(r-o)*(i-a)-(e-o)*(t-a)>=0&&(e-o)*(s-a)-(n-o)*(i-a)>=0}function Au(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!Ou(r,t)&&(ai(r,t)&&ai(t,r)&&Su(r,t)&&(ht(r.prev,r,t.prev)||ht(r,t.prev,t))||or(r,t)&&ht(r.prev,r,r.next)>0&&ht(t.prev,t,t.next)>0)}function ht(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function or(r,t){return r.x===t.x&&r.y===t.y}function qo(r,t,e,i){var n=wi(ht(r,t,e)),s=wi(ht(r,t,i)),o=wi(ht(e,i,r)),a=wi(ht(e,i,t));return!!(n!==s&&o!==a||n===0&&xi(r,e,t)||s===0&&xi(r,i,t)||o===0&&xi(e,r,i)||a===0&&xi(e,t,i))}function xi(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function wi(r){return r>0?1:r<0?-1:0}function Ou(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&qo(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function ai(r,t){return ht(r.prev,r,r.next)<0?ht(r,t,r.next)>=0&&ht(r,r.prev,t)>=0:ht(r,t,r.prev)<0||ht(r,r.next,t)<0}function Su(r,t){var e=r,i=!1,n=(r.x+t.x)/2,s=(r.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&n<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function Ko(r,t){var e=new rn(r.i,r.x,r.y),i=new rn(t.i,t.x,t.y),n=r.next,s=t.prev;return r.next=t,t.prev=r,e.next=n,n.prev=e,i.next=e,e.prev=i,s.next=i,i.prev=s,i}function Rs(r,t,e,i){var n=new rn(r,t,e);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function hi(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function rn(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}sr.deviation=function(r,t,e,i){var n=t&&t.length,s=n?t[0]*e:r.length,o=Math.abs(nn(r,0,s,e));if(n)for(var a=0,h=t.length;a<h;a++){var u=t[a]*e,l=a<h-1?t[a+1]*e:r.length;o-=Math.abs(nn(r,u,l,e))}var f=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,c=i[a+1]*e,p=i[a+2]*e;f+=Math.abs((r[d]-r[p])*(r[c+1]-r[d+1])-(r[d]-r[c])*(r[p+1]-r[d+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function nn(r,t,e,i){for(var n=0,s=t,o=e-i;s<e;s+=i)n+=(r[o]-r[s])*(r[s+1]+r[o+1]),o=s;return n}sr.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,n=0;n<r.length;n++){for(var s=0;s<r[n].length;s++)for(var o=0;o<t;o++)e.vertices.push(r[n][s][o]);n>0&&(i+=r[n-1].length,e.holes.push(i))}return e};var $i={},Nu={get exports(){return $i},set exports(r){$i=r}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(r,t){(function(e){var i=t&&!t.nodeType&&t,n=r&&!r.nodeType&&r,s=typeof Bi=="object"&&Bi;(s.global===s||s.window===s||s.self===s)&&(e=s);var o,a=2147483647,h=36,u=1,l=26,f=38,d=700,c=72,p=128,v="-",g=/^xn--/,y=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=h-u,m=Math.floor,x=String.fromCharCode,A;function S(M){throw RangeError(_[M])}function I(M,F){for(var D=M.length,q=[];D--;)q[D]=F(M[D]);return q}function E(M,F){var D=M.split("@"),q="";D.length>1&&(q=D[0]+"@",M=D[1]),M=M.replace(b,".");var Q=M.split("."),gt=I(Q,F).join(".");return q+gt}function k(M){for(var F=[],D=0,q=M.length,Q,gt;D<q;)Q=M.charCodeAt(D++),Q>=55296&&Q<=56319&&D<q?(gt=M.charCodeAt(D++),(gt&64512)==56320?F.push(((Q&1023)<<10)+(gt&1023)+65536):(F.push(Q),D--)):F.push(Q);return F}function w(M){return I(M,function(F){var D="";return F>65535&&(F-=65536,D+=x(F>>>10&1023|55296),F=56320|F&1023),D+=x(F),D}).join("")}function O(M){return M-48<10?M-22:M-65<26?M-65:M-97<26?M-97:h}function j(M,F){return M+22+75*(M<26)-((F!=0)<<5)}function L(M,F,D){var q=0;for(M=D?m(M/d):M>>1,M+=m(M/F);M>T*l>>1;q+=h)M=m(M/T);return m(q+(T+1)*M/(M+f))}function P(M){var F=[],D=M.length,q,Q=0,gt=p,nt=c,ut,mt,ot,lt,X,st,ft,$,bt;for(ut=M.lastIndexOf(v),ut<0&&(ut=0),mt=0;mt<ut;++mt)M.charCodeAt(mt)>=128&&S("not-basic"),F.push(M.charCodeAt(mt));for(ot=ut>0?ut+1:0;ot<D;){for(lt=Q,X=1,st=h;ot>=D&&S("invalid-input"),ft=O(M.charCodeAt(ot++)),(ft>=h||ft>m((a-Q)/X))&&S("overflow"),Q+=ft*X,$=st<=nt?u:st>=nt+l?l:st-nt,!(ft<$);st+=h)bt=h-$,X>m(a/bt)&&S("overflow"),X*=bt;q=F.length+1,nt=L(Q-lt,q,lt==0),m(Q/q)>a-gt&&S("overflow"),gt+=m(Q/q),Q%=q,F.splice(Q++,0,gt)}return w(F)}function H(M){var F,D,q,Q,gt,nt,ut,mt,ot,lt,X,st=[],ft,$,bt,kt;for(M=k(M),ft=M.length,F=p,D=0,gt=c,nt=0;nt<ft;++nt)X=M[nt],X<128&&st.push(x(X));for(q=Q=st.length,Q&&st.push(v);q<ft;){for(ut=a,nt=0;nt<ft;++nt)X=M[nt],X>=F&&X<ut&&(ut=X);for($=q+1,ut-F>m((a-D)/$)&&S("overflow"),D+=(ut-F)*$,F=ut,nt=0;nt<ft;++nt)if(X=M[nt],X<F&&++D>a&&S("overflow"),X==F){for(mt=D,ot=h;lt=ot<=gt?u:ot>=gt+l?l:ot-gt,!(mt<lt);ot+=h)kt=mt-lt,bt=h-lt,st.push(x(j(lt+kt%bt,0))),mt=m(kt/bt);st.push(x(j(mt,0))),gt=L(D,$,q==Q),D=0,++q}++D,++F}return st.join("")}function pt(M){return E(M,function(F){return g.test(F)?P(F.slice(4).toLowerCase()):F})}function B(M){return E(M,function(F){return y.test(F)?"xn--"+H(F):F})}if(o={version:"1.3.2",ucs2:{decode:k,encode:w},decode:P,encode:H,toASCII:B,toUnicode:pt},i&&n)if(r.exports==i)n.exports=o;else for(A in o)o.hasOwnProperty(A)&&(i[A]=o[A]);else e.punycode=o})(Bi)})(Nu,$i);var Cu={isString:function(r){return typeof r=="string"},isObject:function(r){return typeof r=="object"&&r!==null},isNull:function(r){return r===null},isNullOrUndefined:function(r){return r==null}},ui={};function Pu(r,t){return Object.prototype.hasOwnProperty.call(r,t)}var Lu=function(r,t,e,i){t=t||"&",e=e||"=";var n={};if(typeof r!="string"||r.length===0)return n;var s=/\+/g;r=r.split(t);var o=1e3;i&&typeof i.maxKeys=="number"&&(o=i.maxKeys);var a=r.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var u=r[h].replace(s,"%20"),l=u.indexOf(e),f,d,c,p;l>=0?(f=u.substr(0,l),d=u.substr(l+1)):(f=u,d=""),c=decodeURIComponent(f),p=decodeURIComponent(d),Pu(n,c)?Array.isArray(n[c])?n[c].push(p):n[c]=[n[c],p]:n[c]=p}return n},Ve=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return""}},Ru=function(r,t,e,i){return t=t||"&",e=e||"=",r===null&&(r=void 0),typeof r=="object"?Object.keys(r).map(function(n){var s=encodeURIComponent(Ve(n))+e;return Array.isArray(r[n])?r[n].map(function(o){return s+encodeURIComponent(Ve(o))}).join(t):s+encodeURIComponent(Ve(r[n]))}).join(t):i?encodeURIComponent(Ve(i))+e+encodeURIComponent(Ve(r)):""};ui.decode=ui.parse=Lu;ui.encode=ui.stringify=Ru;var Mu=$i,Bt=Cu,Uu=ar,Fu=Vu,Du=$u;function Ft(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var ku=/^([a-z0-9.+-]+:)/i,Bu=/:[0-9]*$/,Gu=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Hu=["<",">",'"',"`"," ","\r",`
`,"	"],Xu=["{","}","|","\\","^","`"].concat(Hu),sn=["'"].concat(Xu),Ms=["%","/","?",";","#"].concat(sn),Us=["/","?","#"],zu=255,Fs=/^[+a-z0-9A-Z_-]{0,63}$/,ju=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wu={javascript:!0,"javascript:":!0},on={javascript:!0,"javascript:":!0},Me={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},an=ui;function ar(r,t,e){if(r&&Bt.isObject(r)&&r instanceof Ft)return r;var i=new Ft;return i.parse(r,t,e),i}Ft.prototype.parse=function(r,t,e){if(!Bt.isString(r))throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),n=i!==-1&&i<r.indexOf("#")?"?":"#",s=r.split(n),o=/\\/g;s[0]=s[0].replace(o,"/"),r=s.join(n);var a=r;if(a=a.trim(),!e&&r.split("#").length===1){var h=Gu.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=an.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=ku.exec(a);if(u){u=u[0];var l=u.toLowerCase();this.protocol=l,a=a.substr(u.length)}if(e||u||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var f=a.substr(0,2)==="//";f&&!(u&&on[u])&&(a=a.substr(2),this.slashes=!0)}if(!on[u]&&(f||u&&!Me[u])){for(var d=-1,c=0;c<Us.length;c++){var p=a.indexOf(Us[c]);p!==-1&&(d===-1||p<d)&&(d=p)}var v,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(v=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(v)),d=-1;for(var c=0;c<Ms.length;c++){var p=a.indexOf(Ms[c]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var b=this.hostname.split(/\./),c=0,_=b.length;c<_;c++){var T=b[c];if(T&&!T.match(Fs)){for(var m="",x=0,A=T.length;x<A;x++)T.charCodeAt(x)>127?m+="x":m+=T[x];if(!m.match(Fs)){var S=b.slice(0,c),I=b.slice(c+1),E=T.match(ju);E&&(S.push(E[1]),I.unshift(E[2])),I.length&&(a="/"+I.join(".")+a),this.hostname=S.join(".");break}}}this.hostname.length>zu?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Mu.toASCII(this.hostname));var k=this.port?":"+this.port:"",w=this.hostname||"";this.host=w+k,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Wu[l])for(var c=0,_=sn.length;c<_;c++){var O=sn[c];if(a.indexOf(O)!==-1){var j=encodeURIComponent(O);j===O&&(j=escape(O)),a=a.split(O).join(j)}}var L=a.indexOf("#");L!==-1&&(this.hash=a.substr(L),a=a.slice(0,L));var P=a.indexOf("?");if(P!==-1?(this.search=a.substr(P),this.query=a.substr(P+1),t&&(this.query=an.parse(this.query)),a=a.slice(0,P)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Me[l]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var k=this.pathname||"",H=this.search||"";this.path=k+H}return this.href=this.format(),this};function $u(r){return Bt.isString(r)&&(r=ar(r)),r instanceof Ft?r.format():Ft.prototype.format.call(r)}Ft.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=r+this.host:this.hostname&&(n=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&Bt.isObject(this.query)&&Object.keys(this.query).length&&(s=an.stringify(this.query));var o=this.search||s&&"?"+s||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Me[t])&&n!==!1?(n="//"+(n||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):n||(n=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+n+e+o+i};function Vu(r,t){return ar(r,!1,!0).resolve(t)}Ft.prototype.resolve=function(r){return this.resolveObject(ar(r,!1,!0)).format()};Ft.prototype.resolveObject=function(r){if(Bt.isString(r)){var t=new Ft;t.parse(r,!1,!0),r=t}for(var e=new Ft,i=Object.keys(this),n=0;n<i.length;n++){var s=i[n];e[s]=this[s]}if(e.hash=r.hash,r.href==="")return e.href=e.format(),e;if(r.slashes&&!r.protocol){for(var o=Object.keys(r),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=r[h])}return Me[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(r.protocol&&r.protocol!==e.protocol){if(!Me[r.protocol]){for(var u=Object.keys(r),l=0;l<u.length;l++){var f=u[l];e[f]=r[f]}return e.href=e.format(),e}if(e.protocol=r.protocol,!r.host&&!on[r.protocol]){for(var _=(r.pathname||"").split("/");_.length&&!(r.host=_.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),e.pathname=_.join("/")}else e.pathname=r.pathname;if(e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,e.pathname||e.search){var d=e.pathname||"",c=e.search||"";e.path=d+c}return e.slashes=e.slashes||r.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",v=r.host||r.pathname&&r.pathname.charAt(0)==="/",g=v||p||e.host&&r.pathname,y=g,b=e.pathname&&e.pathname.split("/")||[],_=r.pathname&&r.pathname.split("/")||[],T=e.protocol&&!Me[e.protocol];if(T&&(e.hostname="",e.port=null,e.host&&(b[0]===""?b[0]=e.host:b.unshift(e.host)),e.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(_[0]===""?_[0]=r.host:_.unshift(r.host)),r.host=null),g=g&&(_[0]===""||b[0]==="")),v)e.host=r.host||r.host===""?r.host:e.host,e.hostname=r.hostname||r.hostname===""?r.hostname:e.hostname,e.search=r.search,e.query=r.query,b=_;else if(_.length)b||(b=[]),b.pop(),b=b.concat(_),e.search=r.search,e.query=r.query;else if(!Bt.isNullOrUndefined(r.search)){if(T){e.hostname=e.host=b.shift();var m=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;m&&(e.auth=m.shift(),e.host=e.hostname=m.shift())}return e.search=r.search,e.query=r.query,(!Bt.isNull(e.pathname)||!Bt.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!b.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var x=b.slice(-1)[0],A=(e.host||r.host||b.length>1)&&(x==="."||x==="..")||x==="",S=0,I=b.length;I>=0;I--)x=b[I],x==="."?b.splice(I,1):x===".."?(b.splice(I,1),S++):S&&(b.splice(I,1),S--);if(!g&&!y)for(;S--;S)b.unshift("..");g&&b[0]!==""&&(!b[0]||b[0].charAt(0)!=="/")&&b.unshift(""),A&&b.join("/").substr(-1)!=="/"&&b.push("");var E=b[0]===""||b[0]&&b[0].charAt(0)==="/";if(T){e.hostname=e.host=E?"":b.length?b.shift():"";var m=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;m&&(e.auth=m.shift(),e.host=e.hostname=m.shift())}return g=g||e.host&&b.length,g&&!E&&b.unshift(""),b.length?e.pathname=b.join("/"):(e.pathname=null,e.path=null),(!Bt.isNull(e.pathname)||!Bt.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=e.format(),e};Ft.prototype.parseHost=function(){var r=this.host,t=Bu.exec(r);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),r=r.substr(0,r.length-t.length)),r&&(this.hostname=r)};/*!
 * @pixi/utils - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Yu={parse:Uu,format:Du,resolve:Fu};z.RETINA_PREFIX=/@([0-9\.]+)x/;z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ds=!1,ks="6.1.2";function qu(r){var t;if(!Ds){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=[`
 %c %c %c PixiJS `+ks+" -  "+r+`   %c  %c  http://www.pixijs.com/  %c %c %c%c 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=self.console).log.apply(t,e)}else self.console&&self.console.log("PixiJS "+ks+" - "+r+" - http://www.pixijs.com/");Ds=!0}}var wr;function Ku(){return typeof wr>"u"&&(wr=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),n=!!(i&&i.getContextAttributes().stencil);if(i){var s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,n}catch{return!1}}()),wr}var Ju="#f0f8ff",Zu="#faebd7",Qu="#00ffff",tl="#7fffd4",el="#f0ffff",il="#f5f5dc",rl="#ffe4c4",nl="#000000",sl="#ffebcd",ol="#0000ff",al="#8a2be2",hl="#a52a2a",ul="#deb887",ll="#5f9ea0",fl="#7fff00",dl="#d2691e",cl="#ff7f50",pl="#6495ed",vl="#fff8dc",gl="#dc143c",yl="#00ffff",ml="#00008b",_l="#008b8b",bl="#b8860b",xl="#a9a9a9",wl="#006400",El="#a9a9a9",Tl="#bdb76b",Il="#8b008b",Al="#556b2f",Ol="#ff8c00",Sl="#9932cc",Nl="#8b0000",Cl="#e9967a",Pl="#8fbc8f",Ll="#483d8b",Rl="#2f4f4f",Ml="#2f4f4f",Ul="#00ced1",Fl="#9400d3",Dl="#ff1493",kl="#00bfff",Bl="#696969",Gl="#696969",Hl="#1e90ff",Xl="#b22222",zl="#fffaf0",jl="#228b22",Wl="#ff00ff",$l="#dcdcdc",Vl="#f8f8ff",Yl="#daa520",ql="#ffd700",Kl="#808080",Jl="#008000",Zl="#adff2f",Ql="#808080",tf="#f0fff0",ef="#ff69b4",rf="#cd5c5c",nf="#4b0082",sf="#fffff0",of="#f0e68c",af="#fff0f5",hf="#e6e6fa",uf="#7cfc00",lf="#fffacd",ff="#add8e6",df="#f08080",cf="#e0ffff",pf="#fafad2",vf="#d3d3d3",gf="#90ee90",yf="#d3d3d3",mf="#ffb6c1",_f="#ffa07a",bf="#20b2aa",xf="#87cefa",wf="#778899",Ef="#778899",Tf="#b0c4de",If="#ffffe0",Af="#00ff00",Of="#32cd32",Sf="#faf0e6",Nf="#ff00ff",Cf="#800000",Pf="#66cdaa",Lf="#0000cd",Rf="#ba55d3",Mf="#9370db",Uf="#3cb371",Ff="#7b68ee",Df="#00fa9a",kf="#48d1cc",Bf="#c71585",Gf="#191970",Hf="#f5fffa",Xf="#ffe4e1",zf="#ffe4b5",jf="#ffdead",Wf="#000080",$f="#fdf5e6",Vf="#808000",Yf="#6b8e23",qf="#ffa500",Kf="#ff4500",Jf="#da70d6",Zf="#eee8aa",Qf="#98fb98",td="#afeeee",ed="#db7093",id="#ffefd5",rd="#ffdab9",nd="#cd853f",sd="#ffc0cb",od="#dda0dd",ad="#b0e0e6",hd="#800080",ud="#663399",ld="#ff0000",fd="#bc8f8f",dd="#4169e1",cd="#8b4513",pd="#fa8072",vd="#f4a460",gd="#2e8b57",yd="#fff5ee",md="#a0522d",_d="#c0c0c0",bd="#87ceeb",xd="#6a5acd",wd="#708090",Ed="#708090",Td="#fffafa",Id="#00ff7f",Ad="#4682b4",Od="#d2b48c",Sd="#008080",Nd="#d8bfd8",Cd="#ff6347",Pd="#40e0d0",Ld="#ee82ee",Rd="#f5deb3",Md="#ffffff",Ud="#f5f5f5",Fd="#ffff00",Dd="#9acd32",kd={aliceblue:Ju,antiquewhite:Zu,aqua:Qu,aquamarine:tl,azure:el,beige:il,bisque:rl,black:nl,blanchedalmond:sl,blue:ol,blueviolet:al,brown:hl,burlywood:ul,cadetblue:ll,chartreuse:fl,chocolate:dl,coral:cl,cornflowerblue:pl,cornsilk:vl,crimson:gl,cyan:yl,darkblue:ml,darkcyan:_l,darkgoldenrod:bl,darkgray:xl,darkgreen:wl,darkgrey:El,darkkhaki:Tl,darkmagenta:Il,darkolivegreen:Al,darkorange:Ol,darkorchid:Sl,darkred:Nl,darksalmon:Cl,darkseagreen:Pl,darkslateblue:Ll,darkslategray:Rl,darkslategrey:Ml,darkturquoise:Ul,darkviolet:Fl,deeppink:Dl,deepskyblue:kl,dimgray:Bl,dimgrey:Gl,dodgerblue:Hl,firebrick:Xl,floralwhite:zl,forestgreen:jl,fuchsia:Wl,gainsboro:$l,ghostwhite:Vl,goldenrod:Yl,gold:ql,gray:Kl,green:Jl,greenyellow:Zl,grey:Ql,honeydew:tf,hotpink:ef,indianred:rf,indigo:nf,ivory:sf,khaki:of,lavenderblush:af,lavender:hf,lawngreen:uf,lemonchiffon:lf,lightblue:ff,lightcoral:df,lightcyan:cf,lightgoldenrodyellow:pf,lightgray:vf,lightgreen:gf,lightgrey:yf,lightpink:mf,lightsalmon:_f,lightseagreen:bf,lightskyblue:xf,lightslategray:wf,lightslategrey:Ef,lightsteelblue:Tf,lightyellow:If,lime:Af,limegreen:Of,linen:Sf,magenta:Nf,maroon:Cf,mediumaquamarine:Pf,mediumblue:Lf,mediumorchid:Rf,mediumpurple:Mf,mediumseagreen:Uf,mediumslateblue:Ff,mediumspringgreen:Df,mediumturquoise:kf,mediumvioletred:Bf,midnightblue:Gf,mintcream:Hf,mistyrose:Xf,moccasin:zf,navajowhite:jf,navy:Wf,oldlace:$f,olive:Vf,olivedrab:Yf,orange:qf,orangered:Kf,orchid:Jf,palegoldenrod:Zf,palegreen:Qf,paleturquoise:td,palevioletred:ed,papayawhip:id,peachpuff:rd,peru:nd,pink:sd,plum:od,powderblue:ad,purple:hd,rebeccapurple:ud,red:ld,rosybrown:fd,royalblue:dd,saddlebrown:cd,salmon:pd,sandybrown:vd,seagreen:gd,seashell:yd,sienna:md,silver:_d,skyblue:bd,slateblue:xd,slategray:wd,slategrey:Ed,snow:Td,springgreen:Id,steelblue:Ad,tan:Od,teal:Sd,thistle:Nd,tomato:Cd,turquoise:Pd,violet:Ld,wheat:Rd,white:Md,whitesmoke:Ud,yellow:Fd,yellowgreen:Dd};function xe(r,t){return t===void 0&&(t=[]),t[0]=(r>>16&255)/255,t[1]=(r>>8&255)/255,t[2]=(r&255)/255,t}function Jo(r){var t=r.toString(16);return t="000000".substr(0,6-t.length)+t,"#"+t}function Zo(r){return typeof r=="string"&&(r=kd[r.toLowerCase()]||r,r[0]==="#"&&(r=r.substr(1))),parseInt(r,16)}function Bd(r){return(r[0]*255<<16)+(r[1]*255<<8)+(r[2]*255|0)}function Gd(){for(var r=[],t=[],e=0;e<32;e++)r[e]=e,t[e]=e;r[G.NORMAL_NPM]=G.NORMAL,r[G.ADD_NPM]=G.ADD,r[G.SCREEN_NPM]=G.SCREEN,t[G.NORMAL]=G.NORMAL_NPM,t[G.ADD]=G.ADD_NPM,t[G.SCREEN]=G.SCREEN_NPM;var i=[];return i.push(t),i.push(r),i}var Hd=Gd();function Rn(r,t){if(t===1)return(t*255<<24)+r;if(t===0)return 0;var e=r>>16&255,i=r>>8&255,n=r&255;return e=e*t+.5|0,i=i*t+.5|0,n=n*t+.5|0,(t*255<<24)+(e<<16)+(i<<8)+n}function Xd(r,t,e,i){return e=e||new Float32Array(4),e[0]=(r>>16&255)/255,e[1]=(r>>8&255)/255,e[2]=(r&255)/255,(i||i===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function Qo(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function Vi(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Bs(r){return!(r&r-1)&&!!r}function Gs(r){var t=(r>65535?1:0)<<4;r>>>=t;var e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function ri(r,t,e){var i=r.length,n;if(!(t>=i||e===0)){e=t+e>i?i-t:e;var s=i-e;for(n=t;n<s;++n)r[n]=r[n+e];r.length=s}}function Pe(r){return r===0?0:r<0?-1:1}var zd=0;function Yi(){return++zd}var Hs={};function li(r,t,e){if(e===void 0&&(e=3),!Hs[t]){var i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+r):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+`
Deprecated since v`+r),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+r),console.warn(i))),Hs[t]=!0}}var Xs={},Wt=Object.create(null),ne=Object.create(null);(function(){function r(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||z.RESOLUTION,this.resize(t,e)}return r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},r.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(r.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),r})();function jd(r){var t=r.width,e=r.height,i=r.getContext("2d"),n=i.getImageData(0,0,t,e),s=n.data,o=s.length,a={top:null,left:null,right:null,bottom:null},h=null,u,l,f;for(u=0;u<o;u+=4)s[u+3]!==0&&(l=u/4%t,f=~~(u/4/t),a.top===null&&(a.top=f),(a.left===null||l<a.left)&&(a.left=l),(a.right===null||a.right<l)&&(a.right=l+1),(a.bottom===null||a.bottom<f)&&(a.bottom=f));return a.top!==null&&(t=a.right-a.left,e=a.bottom-a.top+1,h=i.getImageData(a.left,a.top,t,e)),{height:e,width:t,data:h}}var Ei;function Wd(r,t){if(t===void 0&&(t=self.location),r.indexOf("data:")===0)return"";t=t||self.location,Ei||(Ei=document.createElement("a")),Ei.href=r;var e=Yu.parse(Ei.href),i=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!i||e.protocol!==t.protocol?"anonymous":""}function hn(r,t){var e=z.RETINA_PREFIX.exec(r);return e?parseFloat(e[1]):t!==void 0?t:1}/*!
 * @pixi/runner - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Tt=function(){function r(t){this.items=[],this._name=t,this._aliasCount=0}return r.prototype.emit=function(t,e,i,n,s,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");var u=this,l=u.name,f=u.items;this._aliasCount++;for(var d=0,c=f.length;d<c;d++)f[d][l](t,e,i,n,s,o,a,h);return f===this.items&&this._aliasCount--,this},r.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},r.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},r.prototype.remove=function(t){var e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},r.prototype.contains=function(t){return this.items.indexOf(t)!==-1},r.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},r.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(r.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),r}();Object.defineProperties(Tt.prototype,{dispatch:{value:Tt.prototype.emit},run:{value:Tt.prototype.emit}});/*!
 * @pixi/ticker - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */z.TARGET_FPMS=.06;var Be;(function(r){r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY"})(Be||(Be={}));var Er=function(){function r(t,e,i,n){e===void 0&&(e=null),i===void 0&&(i=0),n===void 0&&(n=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=n}return r.prototype.match=function(t,e){return e===void 0&&(e=null),this.fn===t&&this.context===e},r.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},r.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},r.prototype.destroy=function(t){t===void 0&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},r}(),Ut=function(){function r(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Er(null,null,1/0),this.deltaMS=1/z.TARGET_FPMS,this.elapsedMS=1/z.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&t._requestId===null&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return r.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},r.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},r.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},r.prototype.add=function(t,e,i){return i===void 0&&(i=Be.NORMAL),this._addListener(new Er(t,e,i))},r.prototype.addOnce=function(t,e,i){return i===void 0&&(i=Be.NORMAL),this._addListener(new Er(t,e,i,!0))},r.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this},r.prototype.remove=function(t,e){for(var i=this._head.next;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(r.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),r.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},r.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},r.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},r.prototype.update=function(t){t===void 0&&(t=performance.now());var e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*z.TARGET_FPMS;for(var n=this._head,s=n.next;s;)s=s.emit(this.deltaTime);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(r.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,z.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(t===0)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(r,"shared",{get:function(){if(!r._shared){var t=r._shared=new r;t.autoStart=!0,t._protected=!0}return r._shared},enumerable:!1,configurable:!0}),Object.defineProperty(r,"system",{get:function(){if(!r._system){var t=r._system=new r;t.autoStart=!0,t._protected=!0}return r._system},enumerable:!1,configurable:!0}),r}(),$d=function(){function r(){}return r.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(i){this._ticker&&this._ticker.remove(this.render,this),this._ticker=i,i&&i.add(this.render,this,Be.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ut.shared:new Ut,t.autoStart&&this.start()},r.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},r}();/*!
 * @pixi/math - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var we=Math.PI*2,Vd=180/Math.PI,Yd=Math.PI/180,J;(function(r){r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC"})(J||(J={}));var Y=function(){function r(t,e,i,n){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(n),this.type=J.RECT}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r,"EMPTY",{get:function(){return new r(0,0,0,0)},enumerable:!1,configurable:!0}),r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},r.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},r.prototype.pad=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this},r.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),n=Math.max(this.y,t.y),s=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=n,this.height=Math.max(s-n,0),this},r.prototype.ceil=function(t,e){t===void 0&&(t=1),e===void 0&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,n=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=n-this.y,this},r.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),s=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=n,this.height=s-n,this},r.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),Mn=function(){function r(t,e,i){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=J.CIRC}return r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,n=this.x-t,s=this.y-e;return n*=n,s*=s,n+s<=i},r.prototype.getBounds=function(){return new Y(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},r.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},r}(),ta=function(){function r(t,e,i,n){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n,this.type=J.ELIP}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return i*=i,n*=n,i+n<=1},r.prototype.getBounds=function(){return new Y(this.x-this.width,this.y-this.height,this.width,this.height)},r.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),te=function(){function r(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];var n=Array.isArray(e[0])?e[0]:e;if(typeof n[0]!="number"){for(var s=[],o=0,a=n.length;o<a;o++)s.push(n[o].x,n[o].y);n=s}this.points=n,this.type=J.POLY,this.closeStroke=!0}return r.prototype.clone=function(){var t=this.points.slice(),e=new r(t);return e.closeStroke=this.closeStroke,e},r.prototype.contains=function(t,e){for(var i=!1,n=this.points.length/2,s=0,o=n-1;s<n;o=s++){var a=this.points[s*2],h=this.points[s*2+1],u=this.points[o*2],l=this.points[o*2+1],f=h>e!=l>e&&t<(u-a)*((e-h)/(l-h))+a;f&&(i=!i)}return i},r.prototype.toString=function(){return"[@pixi/math:Polygon"+("closeStroke="+this.closeStroke)+("points="+this.points.reduce(function(t,e){return t+", "+e},"")+"]")},r}(),ea=function(){function r(t,e,i,n,s){t===void 0&&(t=0),e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=0),s===void 0&&(s=20),this.x=t,this.y=e,this.width=i,this.height=n,this.radius=s,this.type=J.RREC}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),n=e-(this.y+this.radius),s=this.radius*this.radius;if(i*i+n*n<=s||(i=t-(this.x+this.width-this.radius),i*i+n*n<=s)||(n=e-(this.y+this.height-this.radius),i*i+n*n<=s)||(i=t-(this.x+this.radius),i*i+n*n<=s))return!0}return!1},r.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+("width="+this.width+" height="+this.height+" radius="+this.radius+"]")},r}(),V=function(){function r(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},r.prototype.copyTo=function(t){return t.set(this.x,this.y),t},r.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},r.prototype.set=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x=t,this.y=e,this},r.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},r}(),Le=function(){function r(t,e,i,n){i===void 0&&(i=0),n===void 0&&(n=0),this._x=i,this._y=n,this.cb=t,this.scope=e}return r.prototype.clone=function(t,e){return t===void 0&&(t=this.cb),e===void 0&&(e=this.scope),new r(t,e,this._x,this._y)},r.prototype.set=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this},r.prototype.copyFrom=function(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},r.prototype.copyTo=function(t){return t.set(this._x,this._y),t},r.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},r.prototype.toString=function(){return"[@pixi/math:ObservablePoint x="+0+" y="+0+" scope="+this.scope+"]"},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),r}(),vt=function(){function r(t,e,i,n,s,o){t===void 0&&(t=1),e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=1),s===void 0&&(s=0),o===void 0&&(o=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=o}return r.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},r.prototype.set=function(t,e,i,n,s,o){return this.a=t,this.b=e,this.c=i,this.d=n,this.tx=s,this.ty=o,this},r.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},r.prototype.apply=function(t,e){e=e||new V;var i=t.x,n=t.y;return e.x=this.a*i+this.c*n+this.tx,e.y=this.b*i+this.d*n+this.ty,e},r.prototype.applyInverse=function(t,e){e=e||new V;var i=1/(this.a*this.d+this.c*-this.b),n=t.x,s=t.y;return e.x=this.d*i*n+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*s+-this.b*i*n+(-this.ty*this.a+this.tx*this.b)*i,e},r.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},r.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},r.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,s=this.c,o=this.tx;return this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this},r.prototype.append=function(t){var e=this.a,i=this.b,n=this.c,s=this.d;return this.a=t.a*e+t.b*n,this.b=t.a*i+t.b*s,this.c=t.c*e+t.d*n,this.d=t.c*i+t.d*s,this.tx=t.tx*e+t.ty*n+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this},r.prototype.setTransform=function(t,e,i,n,s,o,a,h,u){return this.a=Math.cos(a+u)*s,this.b=Math.sin(a+u)*s,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+n*this.c),this.ty=e-(i*this.b+n*this.d),this},r.prototype.prepend=function(t){var e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){var i=this.a,n=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=n*t.a+this.d*t.c,this.d=n*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},r.prototype.decompose=function(t){var e=this.a,i=this.b,n=this.c,s=this.d,o=t.pivot,a=-Math.atan2(-n,s),h=Math.atan2(i,e),u=Math.abs(a+h);return u<1e-5||Math.abs(we-u)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(n*n+s*s),t.position.x=this.tx+(o.x*e+o.y*n),t.position.y=this.ty+(o.x*i+o.y*s),t},r.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,n=this.d,s=this.tx,o=t*n-e*i;return this.a=n/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-n*s)/o,this.ty=-(t*this.ty-e*s)/o,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},r.prototype.clone=function(){var t=new r;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},r.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(r,"IDENTITY",{get:function(){return new r},enumerable:!1,configurable:!0}),Object.defineProperty(r,"TEMP_MATRIX",{get:function(){return new r},enumerable:!1,configurable:!0}),r}(),ue=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],le=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],fe=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],de=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],un=[],ia=[],Ti=Math.sign;function qd(){for(var r=0;r<16;r++){var t=[];un.push(t);for(var e=0;e<16;e++)for(var i=Ti(ue[r]*ue[e]+fe[r]*le[e]),n=Ti(le[r]*ue[e]+de[r]*le[e]),s=Ti(ue[r]*fe[e]+fe[r]*de[e]),o=Ti(le[r]*fe[e]+de[r]*de[e]),a=0;a<16;a++)if(ue[a]===i&&le[a]===n&&fe[a]===s&&de[a]===o){t.push(a);break}}for(var r=0;r<16;r++){var h=new vt;h.set(ue[r],le[r],fe[r],de[r],0,0),ia.push(h)}}qd();var at={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(r){return ue[r]},uY:function(r){return le[r]},vX:function(r){return fe[r]},vY:function(r){return de[r]},inv:function(r){return r&8?r&15:-r&7},add:function(r,t){return un[r][t]},sub:function(r,t){return un[r][at.inv(t)]},rotate180:function(r){return r^4},isVertical:function(r){return(r&3)===2},byDirection:function(r,t){return Math.abs(r)*2<=Math.abs(t)?t>=0?at.S:at.N:Math.abs(t)*2<=Math.abs(r)?r>0?at.E:at.W:t>0?r>0?at.SE:at.SW:r>0?at.NE:at.NW},matrixAppendRotationInv:function(r,t,e,i){e===void 0&&(e=0),i===void 0&&(i=0);var n=ia[at.inv(t)];n.tx=e,n.ty=i,r.append(n)}},Kd=function(){function r(){this.worldTransform=new vt,this.localTransform=new vt,this.position=new Le(this.onChange,this,0,0),this.scale=new Le(this.onChange,this,1,1),this.pivot=new Le(this.onChange,this,0,0),this.skew=new Le(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return r.prototype.onChange=function(){this._localID++},r.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},r.prototype.toString=function(){return"[@pixi/math:Transform "+("position=("+this.position.x+", "+this.position.y+") ")+("rotation="+this.rotation+" ")+("scale=("+this.scale.x+", "+this.scale.y+") ")+("skew=("+this.skew.x+", "+this.skew.y+") ")+"]"},r.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},r.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,n=this.worldTransform;n.a=e.a*i.a+e.b*i.c,n.b=e.a*i.b+e.b*i.d,n.c=e.c*i.a+e.d*i.c,n.d=e.c*i.b+e.d*i.d,n.tx=e.tx*i.a+e.ty*i.c+i.tx,n.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},r.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(r.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),r.IDENTITY=new r,r}();/*!
 * @pixi/core - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */z.PREFER_ENV=pe.any?Kt.WEBGL:Kt.WEBGL2;z.STRICT_TEXTURE_CACHE=!1;var ln=[];function ra(r,t){if(!r)return null;var e="";if(typeof r=="string"){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(e=i[1].toLowerCase())}for(var n=ln.length-1;n>=0;--n){var s=ln[n];if(s.test&&s.test(r,e))return new s(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var fn=function(r,t){return fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},fn(r,t)};function rt(r,t){fn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var dn=function(){return dn=Object.assign||function(t){for(var e=arguments,i,n=1,s=arguments.length;n<s;n++){i=e[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},dn.apply(this,arguments)};function Jd(r,t){var e={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(r);n<i.length;n++)t.indexOf(i[n])<0&&(e[i[n]]=r[i[n]]);return e}var fi=function(){function r(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Tt("setRealSize"),this.onUpdate=new Tt("update"),this.onError=new Tt("onError")}return r.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},r.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},r.prototype.resize=function(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(r.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),r.prototype.update=function(){this.destroyed||this.onUpdate.emit()},r.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),r.prototype.style=function(t,e,i){return!1},r.prototype.dispose=function(){},r.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},r.test=function(t,e){return!1},r}(),Un=function(r){rt(t,r);function t(e,i){var n=this,s=i||{},o=s.width,a=s.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return n=r.call(this,o,a)||this,n.data=e,n}return t.prototype.upload=function(e,i,n){var s=e.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ee.UNPACK);var o=i.realWidth,a=i.realHeight;return n.width===o&&n.height===a?s.texSubImage2D(i.target,0,0,0,o,a,i.format,n.type,this.data):(n.width=o,n.height=a,s.texImage2D(i.target,0,n.internalFormat,o,a,0,i.format,n.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(fi),Zd={scaleMode:Gt.NEAREST,format:R.RGBA,alphaMode:ee.NPM},_t=function(r){rt(t,r);function t(e,i){e===void 0&&(e=null),i===void 0&&(i=null);var n=r.call(this)||this;i=i||{};var s=i.alphaMode,o=i.mipmap,a=i.anisotropicLevel,h=i.scaleMode,u=i.width,l=i.height,f=i.wrapMode,d=i.format,c=i.type,p=i.target,v=i.resolution,g=i.resourceOptions;return e&&!(e instanceof fi)&&(e=ra(e,g),e.internal=!0),n.resolution=v||z.RESOLUTION,n.width=Math.round((u||0)*n.resolution)/n.resolution,n.height=Math.round((l||0)*n.resolution)/n.resolution,n._mipmap=o!==void 0?o:z.MIPMAP_TEXTURES,n.anisotropicLevel=a!==void 0?a:z.ANISOTROPIC_LEVEL,n._wrapMode=f||z.WRAP_MODE,n._scaleMode=h!==void 0?h:z.SCALE_MODE,n.format=d||R.RGBA,n.type=c||W.UNSIGNED_BYTE,n.target=p||ve.TEXTURE_2D,n.alphaMode=s!==void 0?s:ee.UNPACK,n.uid=Yi(),n.touched=0,n.isPowerOfTwo=!1,n._refreshPOT(),n._glTextures={},n.dirtyId=0,n.dirtyStyleId=0,n.cacheId=null,n.valid=u>0&&l>0,n.textureCacheIds=[],n.destroyed=!1,n.resource=null,n._batchEnabled=0,n._batchLocation=0,n.parentTextureArray=null,n.setResource(e),n}return Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mipmap",{get:function(){return this._mipmap},set:function(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,i){var n;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),i!==void 0&&i!==this.mipmap&&(this.mipmap=i,n=!0),n&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,i,n){return n=n||this.resolution,this.setRealSize(e*n,i*n,n)},t.prototype.setRealSize=function(e,i,n){return this.resolution=n||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(i)/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=Bs(this.realWidth)&&Bs(this.realHeight)},t.prototype.setResolution=function(e){var i=this.resolution;return i===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*i)/e,this.height=Math.round(this.height*i)/e,this.emit("update",this)),this._refreshPOT(),this)},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ne[this.cacheId],delete Wt[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,i,n){n===void 0&&(n=z.STRICT_TEXTURE_CACHE);var s=typeof e=="string",o=null;if(s)o=e;else{if(!e._pixiId){var a=i&&i.pixiIdPrefix||"pixiid";e._pixiId=a+"_"+Yi()}o=e._pixiId}var h=ne[o];if(s&&n&&!h)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return h||(h=new t(e,i),h.cacheId=o,t.addToCache(h,o)),h},t.fromBuffer=function(e,i,n,s){e=e||new Float32Array(i*n*4);var o=new Un(e,{width:i,height:n}),a=e instanceof Float32Array?W.FLOAT:W.UNSIGNED_BYTE;return new t(o,Object.assign(Zd,s||{width:i,height:n,type:a}))},t.addToCache=function(e,i){i&&(e.textureCacheIds.indexOf(i)===-1&&e.textureCacheIds.push(i),ne[i]&&console.warn("BaseTexture added to the cache with an id ["+i+"] that already had an entry"),ne[i]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var i=ne[e];if(i){var n=i.textureCacheIds.indexOf(e);return n>-1&&i.textureCacheIds.splice(n,1),delete ne[e],i}}else if(e&&e.textureCacheIds){for(var s=0;s<e.textureCacheIds.length;++s)delete ne[e.textureCacheIds[s]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(vi),na=function(r){rt(t,r);function t(e,i){var n=this,s=i||{},o=s.width,a=s.height;n=r.call(this,o,a)||this,n.items=[],n.itemDirtyIds=[];for(var h=0;h<e;h++){var u=new _t;n.items.push(u),n.itemDirtyIds.push(-2)}return n.length=e,n._load=null,n.baseTexture=null,n}return t.prototype.initFromArray=function(e,i){for(var n=0;n<this.length;n++)e[n]&&(e[n].castToBaseTexture?this.addBaseTextureAt(e[n].castToBaseTexture(),n):e[n]instanceof fi?this.addResourceAt(e[n],n):this.addResourceAt(ra(e[n],i),n))},t.prototype.dispose=function(){for(var e=0,i=this.length;e<i;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,i){if(!this.items[i])throw new Error("Index "+i+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[i].setResource(e),this},t.prototype.bind=function(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");r.prototype.bind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=e,this.items[i].on("update",e.update,e)},t.prototype.unbind=function(e){r.prototype.unbind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",e.update,e)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var i=this.items.map(function(s){return s.resource}).filter(function(s){return s}),n=i.map(function(s){return s.load()});return this._load=Promise.all(n).then(function(){var s=e.items[0],o=s.realWidth,a=s.realHeight;return e.resize(o,a),Promise.resolve(e)}),this._load},t}(fi),Qd=function(r){rt(t,r);function t(e,i){var n=this,s=i||{},o=s.width,a=s.height,h,u;return Array.isArray(e)?(h=e,u=e.length):u=e,n=r.call(this,u,{width:o,height:a})||this,h&&n.initFromArray(h,i),n}return t.prototype.addBaseTextureAt=function(e,i){if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("ArrayResource does not support RenderTexture");return this},t.prototype.bind=function(e){r.prototype.bind.call(this,e),e.target=ve.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,i,n){var s=this,o=s.length,a=s.itemDirtyIds,h=s.items,u=e.gl;n.dirtyId<0&&u.texImage3D(u.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,o,0,i.format,n.type,null);for(var l=0;l<o;l++){var f=h[l];a[l]<f.dirtyId&&(a[l]=f.dirtyId,f.valid&&u.texSubImage3D(u.TEXTURE_2D_ARRAY,0,0,0,l,f.resource.width,f.resource.height,1,i.format,n.type,f.resource.source))}return!0},t}(na),re=function(r){rt(t,r);function t(e){var i=this,n=e,s=n.naturalWidth||n.videoWidth||n.width,o=n.naturalHeight||n.videoHeight||n.height;return i=r.call(this,s,o)||this,i.source=e,i.noSubImage=!1,i}return t.crossOrigin=function(e,i,n){n===void 0&&i.indexOf("data:")!==0?e.crossOrigin=Wd(i):n!==!1&&(e.crossOrigin=typeof n=="string"?n:"anonymous")},t.prototype.upload=function(e,i,n,s){var o=e.gl,a=i.realWidth,h=i.realHeight;return s=s||this.source,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ee.UNPACK),!this.noSubImage&&i.target===o.TEXTURE_2D&&n.width===a&&n.height===h?o.texSubImage2D(o.TEXTURE_2D,0,0,0,i.format,n.type,s):(n.width=a,n.height=h,o.texImage2D(i.target,0,n.internalFormat,i.format,n.type,s)),!0},t.prototype.update=function(){if(!this.destroyed){var e=this.source,i=e.naturalWidth||e.videoWidth||e.width,n=e.naturalHeight||e.videoHeight||e.height;this.resize(i,n),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(fi),sa=function(r){rt(t,r);function t(e){return r.call(this,e)||this}return t.test=function(e){var i=self.OffscreenCanvas;return i&&e instanceof i?!0:self.HTMLCanvasElement&&e instanceof HTMLCanvasElement},t}(re),tc=function(r){rt(t,r);function t(e,i){var n=this,s=i||{},o=s.width,a=s.height,h=s.autoLoad,u=s.linkBaseTexture;if(e&&e.length!==t.SIDES)throw new Error("Invalid length. Got "+e.length+", expected 6");n=r.call(this,6,{width:o,height:a})||this;for(var l=0;l<t.SIDES;l++)n.items[l].target=ve.TEXTURE_CUBE_MAP_POSITIVE_X+l;return n.linkBaseTexture=u!==!1,e&&n.initFromArray(e,i),h!==!1&&n.load(),n}return t.prototype.bind=function(e){r.prototype.bind.call(this,e),e.target=ve.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,i,n){if(n===void 0&&(n=this.linkBaseTexture),!this.items[i])throw new Error("Index "+i+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,i);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=ve.TEXTURE_CUBE_MAP_POSITIVE_X+i,e.parentTextureArray=this.baseTexture,this.items[i]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[i]=e,this},t.prototype.upload=function(e,i,n){for(var s=this.itemDirtyIds,o=0;o<t.SIDES;o++){var a=this.items[o];s[o]<a.dirtyId&&(a.valid&&a.resource?(a.resource.upload(e,a,n),s[o]=a.dirtyId):s[o]<-1&&(e.gl.texImage2D(a.target,0,n.internalFormat,i.realWidth,i.realHeight,0,i.format,n.type,null),s[o]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(na),oa=function(r){rt(t,r);function t(e,i){var n=this;if(i=i||{},!(e instanceof HTMLImageElement)){var s=new Image;re.crossOrigin(s,e,i.crossorigin),s.src=e,e=s}return n=r.call(this,e)||this,!e.complete&&n._width&&n._height&&(n._width=0,n._height=0),n.url=e.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(i.createBitmap!==void 0?i.createBitmap:z.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,n.alphaMode=typeof i.alphaMode=="number"?i.alphaMode:null,n.bitmap=null,n._load=null,i.autoLoad!==!1&&n.load(),n}return t.prototype.load=function(e){var i=this;return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise(function(n,s){var o=i.source;i.url=o.src;var a=function(){i.destroyed||(o.onload=null,o.onerror=null,i.resize(o.width,o.height),i._load=null,i.createBitmap?n(i.process()):n(i))};o.complete&&o.src?a():(o.onload=a,o.onerror=function(h){s(h),i.onError.emit(h)})}),this._load)},t.prototype.process=function(){var e=this,i=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!self.createImageBitmap)return Promise.resolve(this);var n=self.createImageBitmap,s=!i.crossOrigin||i.crossOrigin==="anonymous";return this._process=fetch(i.src,{mode:s?"cors":"no-cors"}).then(function(o){return o.blob()}).then(function(o){return n(o,0,0,i.width,i.height,{premultiplyAlpha:e.alphaMode===ee.UNPACK?"premultiply":"none"})}).then(function(o){return e.destroyed?Promise.reject():(e.bitmap=o,e.update(),e._process=null,Promise.resolve(e))}),this._process},t.prototype.upload=function(e,i,n){if(typeof this.alphaMode=="number"&&(i.alphaMode=this.alphaMode),!this.createBitmap)return r.prototype.upload.call(this,e,i,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(r.prototype.upload.call(this,e,i,n,this.bitmap),!this.preserveBitmap){var s=!0,o=i._glTextures;for(var a in o){var h=o[a];if(h!==n&&h.dirtyId!==i.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,r.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return typeof e=="string"||e instanceof HTMLImageElement},t}(re),ec=function(r){rt(t,r);function t(e,i){var n=this;return i=i||{},n=r.call(this,document.createElement("canvas"))||this,n._width=0,n._height=0,n.svg=e,n.scale=i.scale||1,n._overrideWidth=i.width,n._overrideHeight=i.height,n._resolve=null,n._crossorigin=i.crossorigin,n._load=null,i.autoLoad!==!1&&n.load(),n}return t.prototype.load=function(){var e=this;return this._load?this._load:(this._load=new Promise(function(i){if(e._resolve=function(){e.resize(e.source.width,e.source.height),i(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var e=this,i=new Image;re.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=function(n){e._resolve&&(i.onerror=null,e.onError.emit(n))},i.onload=function(){if(e._resolve){var n=i.width,s=i.height;if(!n||!s)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=n*e.scale,a=s*e.scale;(e._overrideWidth||e._overrideHeight)&&(o=e._overrideWidth||e._overrideHeight/s*n,a=e._overrideHeight||e._overrideWidth/n*s),o=Math.round(o),a=Math.round(a);var h=e.source;h.width=o,h.height=a,h._pixiId="canvas_"+Yi(),h.getContext("2d").drawImage(i,0,0,n,s,0,0,o,a),e._resolve(),e._resolve=null}}},t.getSize=function(e){var i=t.SVG_SIZE.exec(e),n={};return i&&(n[i[1]]=Math.round(parseFloat(i[3])),n[i[5]]=Math.round(parseFloat(i[7]))),n},t.prototype.dispose=function(){r.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,i){return i==="svg"||typeof e=="string"&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||typeof e=="string"&&t.SVG_XML.test(e)},t.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(re),ic=function(r){rt(t,r);function t(e,i){var n=this;if(i=i||{},!(e instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);var o=e[0].src||e[0];re.crossOrigin(s,o,i.crossorigin);for(var a=0;a<e.length;++a){var h=document.createElement("source"),u=e[a],l=u.src,f=u.mime;l=l||e[a];var d=l.split("?").shift().toLowerCase(),c=d.substr(d.lastIndexOf(".")+1);f=f||t.MIME_TYPES[c]||"video/"+c,h.src=l,h.type=f,s.appendChild(h)}e=s}return n=r.call(this,e)||this,n.noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=i.autoPlay!==!1,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),i.autoLoad!==!1&&n.load(),n}return t.prototype.update=function(e){if(!this.destroyed){var i=Ut.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(r.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(function(n){e.valid?n(e):(e._resolve=n,i.load())}),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&e.paused===!1&&e.ended===!1&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return e.readyState===3||e.readyState===4},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var i=this.valid;this.resize(e.videoWidth,e.videoHeight),!i&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),r.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Ut.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ut.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,i){return self.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.indexOf(i)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(re),rc=function(r){rt(t,r);function t(e){return r.call(this,e)||this}return t.test=function(e){return!!self.createImageBitmap&&e instanceof ImageBitmap},t}(re);ln.push(oa,rc,sa,ic,ec,Un,tc,Qd);var nc=function(r){rt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.upload=function(e,i,n){var s=e.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.alphaMode===ee.UNPACK);var o=i.realWidth,a=i.realHeight;return n.width===o&&n.height===a?s.texSubImage2D(i.target,0,0,0,o,a,i.format,n.type,this.data):(n.width=o,n.height=a,s.texImage2D(i.target,0,n.internalFormat,o,a,0,i.format,n.type,this.data)),!0},t}(Un),cn=function(){function r(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Tt("disposeFramebuffer"),this.multisample=yt.NONE}return Object.defineProperty(r.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),r.prototype.addColorTexture=function(t,e){return t===void 0&&(t=0),this.colorTextures[t]=e||new _t(null,{scaleMode:Gt.NEAREST,resolution:1,mipmap:_e.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.addDepthTexture=function(t){return this.depthTexture=t||new _t(new nc(null,{width:this.width,height:this.height}),{scaleMode:Gt.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:_e.OFF,format:R.DEPTH_COMPONENT,type:W.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var n=this.colorTextures[i],s=n.resolution;n.setSize(t/s,e/s)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},r}(),aa=function(r){rt(t,r);function t(e){var i=this;if(typeof e=="number"){var n=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];e={width:n,height:s,scaleMode:o,resolution:a}}return e.width=e.width||100,e.height=e.height||100,e.multisample=e.multisample!==void 0?e.multisample:yt.NONE,i=r.call(this,null,e)||this,i.mipmap=_e.OFF,i.valid=!0,i.clearColor=[0,0,0,0],i.framebuffer=new cn(i.realWidth,i.realHeight).addColorTexture(0,i),i.framebuffer.multisample=e.multisample,i.maskStack=[],i.filterStack=[{}],i}return t.prototype.resize=function(e,i){this.framebuffer.resize(e*this.resolution,i*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},t.prototype.dispose=function(){this.framebuffer.dispose(),r.prototype.dispose.call(this)},t.prototype.destroy=function(){r.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(_t),ha=function(){function r(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return r.prototype.set=function(t,e,i){var n=e.width,s=e.height;if(i){var o=t.width/2/n,a=t.height/2/s,h=t.x/n+o,u=t.y/s+a;i=at.add(i,at.NW),this.x0=h+o*at.uX(i),this.y0=u+a*at.uY(i),i=at.add(i,2),this.x1=h+o*at.uX(i),this.y1=u+a*at.uY(i),i=at.add(i,2),this.x2=h+o*at.uX(i),this.y2=u+a*at.uY(i),i=at.add(i,2),this.x3=h+o*at.uX(i),this.y3=u+a*at.uY(i)}else this.x0=t.x/n,this.y0=t.y/s,this.x1=(t.x+t.width)/n,this.y1=t.y/s,this.x2=(t.x+t.width)/n,this.y2=(t.y+t.height)/s,this.x3=t.x/n,this.y3=(t.y+t.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},r.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0="+this.y0+" ")+("x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" ")+("y2="+this.y2+" x3="+this.x3+" y3="+this.y3)+"]"},r}(),zs=new ha,Z=function(r){rt(t,r);function t(e,i,n,s,o,a){var h=r.call(this)||this;if(h.noFrame=!1,i||(h.noFrame=!0,i=new Y(0,0,1,1)),e instanceof t&&(e=e.baseTexture),h.baseTexture=e,h._frame=i,h.trim=s,h.valid=!1,h._uvs=zs,h.uvMatrix=null,h.orig=n||i,h._rotate=Number(o||0),o===!0)h._rotate=2;else if(h._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new V(a.x,a.y):new V(0,0),h._updateID=0,h.textureCacheIds=[],e.valid?h.noFrame?e.valid&&h.onBaseTextureUpdated(e):h.frame=i:e.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&e.on("update",h.onBaseTextureUpdated,h),h}return t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var i=this.baseTexture.resource;i&&i.url&&Wt[i.url]&&t.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){var e=this._frame.clone(),i=this._frame===this.orig?e:this.orig.clone(),n=new t(this.baseTexture,!this.noFrame&&e,i,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=e),n},t.prototype.updateUvs=function(){this._uvs===zs&&(this._uvs=new ha),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,i,n){i===void 0&&(i={}),n===void 0&&(n=z.STRICT_TEXTURE_CACHE);var s=typeof e=="string",o=null;if(s)o=e;else{if(!e._pixiId){var a=i&&i.pixiIdPrefix||"pixiid";e._pixiId=a+"_"+Yi()}o=e._pixiId}var h=Wt[o];if(s&&n&&!h)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return h||(i.resolution||(i.resolution=hn(e)),h=new t(new _t(e,i)),h.baseTexture.cacheId=o,_t.addToCache(h.baseTexture,o),t.addToCache(h,o)),h},t.fromURL=function(e,i){var n=Object.assign({autoLoad:!1},i==null?void 0:i.resourceOptions),s=t.from(e,Object.assign({resourceOptions:n},i),!1),o=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):o.load().then(function(){return Promise.resolve(s)})},t.fromBuffer=function(e,i,n,s){return new t(_t.fromBuffer(e,i,n,s))},t.fromLoader=function(e,i,n,s){var o=new _t(e,Object.assign({scaleMode:z.SCALE_MODE,resolution:hn(i)},s)),a=o.resource;a instanceof oa&&(a.url=i);var h=new t(o);return n||(n=i),_t.addToCache(h.baseTexture,n),t.addToCache(h,n),n!==i&&(_t.addToCache(h.baseTexture,i),t.addToCache(h,i)),h.baseTexture.valid?Promise.resolve(h):new Promise(function(u){h.baseTexture.once("loaded",function(){return u(h)})})},t.addToCache=function(e,i){i&&(e.textureCacheIds.indexOf(i)===-1&&e.textureCacheIds.push(i),Wt[i]&&console.warn("Texture added to the cache with an id ["+i+"] that already had an entry"),Wt[i]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var i=Wt[e];if(i){var n=i.textureCacheIds.indexOf(e);return n>-1&&i.textureCacheIds.splice(n,1),delete Wt[e],i}}else if(e&&e.textureCacheIds){for(var s=0;s<e.textureCacheIds.length;++s)Wt[e.textureCacheIds[s]]===e&&delete Wt[e.textureCacheIds[s]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var i=e.x,n=e.y,s=e.width,o=e.height,a=i+s>this.baseTexture.width,h=n+o>this.baseTexture.height;if(a||h){var u=a&&h?"and":"or",l="X: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.width,f="Y: "+n+" + "+o+" = "+(n+o)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(l+" "+u+" "+f))}this.valid=s&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(vi);function sc(){var r=document.createElement("canvas");r.width=16,r.height=16;var t=r.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new Z(new _t(new sa(r)))}function hr(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}Z.EMPTY=new Z(new _t);hr(Z.EMPTY);hr(Z.EMPTY.baseTexture);Z.WHITE=sc();hr(Z.WHITE);hr(Z.WHITE.baseTexture);var Fn=function(r){rt(t,r);function t(e,i){var n=r.call(this,e,i)||this;return n.valid=!0,n.filterFrame=null,n.filterPoolKey=null,n.updateUvs(),n}return Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(e){this.framebuffer.multisample=e},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,i,n){n===void 0&&(n=!0);var s=this.baseTexture.resolution,o=Math.round(e*s)/s,a=Math.round(i*s)/s;this.valid=o>0&&a>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=a,n&&this.baseTexture.resize(o,a),this.updateUvs()},t.prototype.setResolution=function(e){var i=this.baseTexture;i.resolution!==e&&(i.setResolution(e),this.resize(i.width,i.height,!1))},t.create=function(e){for(var i=arguments,n=[],s=1;s<arguments.length;s++)n[s-1]=i[s];return typeof e=="number"&&(li("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:n[0],scaleMode:n[1],resolution:n[2]}),new t(new aa(e))},t}(Z),oc=function(){function r(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return r.prototype.createTexture=function(t,e,i){i===void 0&&(i=yt.NONE);var n=new aa(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new Fn(n)},r.prototype.getOptimalTexture=function(t,e,i,n){i===void 0&&(i=1),n===void 0&&(n=yt.NONE);var s;t=Math.ceil(t*i),e=Math.ceil(e*i),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Vi(t),e=Vi(e),s=((t&65535)<<16|e&65535)>>>0,n>1&&(s+=n*4294967296)):s=n>1?-n:-1,this.texturePool[s]||(this.texturePool[s]=[]);var o=this.texturePool[s].pop();return o||(o=this.createTexture(t,e,n)),o.filterPoolKey=s,o.setResolution(i),o},r.prototype.getFilterTexture=function(t,e,i){var n=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||yt.NONE);return n.filterFrame=t.filterFrame,n},r.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},r.prototype.returnFilterTexture=function(t){this.returnTexture(t)},r.prototype.clear=function(t){if(t=t!==!1,t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var n=0;n<i.length;n++)i[n].destroy(!0)}this.texturePool={}},r.prototype.setScreenSize=function(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(var e in this.texturePool)if(Number(e)<0){var i=this.texturePool[e];if(i)for(var n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},r.SCREEN_KEY=-1,r}(),js=function(){function r(t,e,i,n,s,o,a){e===void 0&&(e=0),i===void 0&&(i=!1),n===void 0&&(n=W.FLOAT),this.buffer=t,this.size=e,this.normalized=i,this.type=n,this.stride=s,this.start=o,this.instance=a}return r.prototype.destroy=function(){this.buffer=null},r.from=function(t,e,i,n,s){return new r(t,e,i,n,s)},r}(),ac=0,xt=function(){function r(t,e,i){e===void 0&&(e=!0),i===void 0&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=ac++,this.disposeRunner=new Tt("disposeBuffer")}return r.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(r.prototype,"index",{get:function(){return this.type===zt.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?zt.ELEMENT_ARRAY_BUFFER:zt.ARRAY_BUFFER},enumerable:!1,configurable:!0}),r.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new r(t)},r}(),hc={Float32Array,Uint32Array,Int32Array,Uint8Array};function uc(r,t){for(var e=0,i=0,n={},s=0;s<r.length;s++)i+=t[s],e+=r[s].length;for(var o=new ArrayBuffer(e*4),a=null,h=0,s=0;s<r.length;s++){var u=t[s],l=r[s],f=Qo(l);n[f]||(n[f]=new hc[f](o)),a=n[f];for(var d=0;d<l.length;d++){var c=(d/u|0)*i+h,p=d%u;a[c+p]=l[d]}h+=u}return new Float32Array(o)}var Ws={5126:4,5123:2,5121:1},lc=0,fc={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},gi=function(){function r(t,e){t===void 0&&(t=[]),e===void 0&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=lc++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Tt("disposeGeometry"),this.refCount=0}return r.prototype.addAttribute=function(t,e,i,n,s,o,a,h){if(i===void 0&&(i=0),n===void 0&&(n=!1),h===void 0&&(h=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof xt||(e instanceof Array&&(e=new Float32Array(e)),e=new xt(e));var u=t.split("|");if(u.length>1){for(var l=0;l<u.length;l++)this.addAttribute(u[l],e,i,n,s);return this}var f=this.buffers.indexOf(e);return f===-1&&(this.buffers.push(e),f=this.buffers.length-1),this.attributes[t]=new js(f,i,n,s,o,a,h),this.instanced=this.instanced||h,this},r.prototype.getAttribute=function(t){return this.attributes[t]},r.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},r.prototype.addIndex=function(t){return t instanceof xt||(t instanceof Array&&(t=new Uint16Array(t)),t=new xt(t)),t.type=zt.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.indexOf(t)===-1&&this.buffers.push(t),this},r.prototype.getIndex=function(){return this.indexBuffer},r.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var t=[],e=[],i=new xt,n;for(n in this.attributes){var s=this.attributes[n],o=this.buffers[s.buffer];t.push(o.data),e.push(s.size*Ws[s.type]/4),s.buffer=0}for(i.data=uc(t,e),n=0;n<this.buffers.length;n++)this.buffers[n]!==this.indexBuffer&&this.buffers[n].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},r.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t],i=this.buffers[e.buffer];return i.data.length/(e.stride/4||e.size)}return 0},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},r.prototype.clone=function(){for(var t=new r,e=0;e<this.buffers.length;e++)t.buffers[e]=new xt(this.buffers[e].data.slice(0));for(var e in this.attributes){var i=this.attributes[e];t.attributes[e]=new js(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=zt.ELEMENT_ARRAY_BUFFER),t},r.merge=function(t){for(var e=new r,i=[],n=[],s=[],o,a=0;a<t.length;a++){o=t[a];for(var h=0;h<o.buffers.length;h++)n[h]=n[h]||0,n[h]+=o.buffers[h].data.length,s[h]=0}for(var a=0;a<o.buffers.length;a++)i[a]=new fc[Qo(o.buffers[a].data)](n[a]),e.buffers[a]=new xt(i[a]);for(var a=0;a<t.length;a++){o=t[a];for(var h=0;h<o.buffers.length;h++)i[h].set(o.buffers[h].data,s[h]),s[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=zt.ELEMENT_ARRAY_BUFFER;for(var u=0,l=0,f=0,d=0,a=0;a<o.buffers.length;a++)if(o.buffers[a]!==o.indexBuffer){d=a;break}for(var a in o.attributes){var c=o.attributes[a];(c.buffer|0)===d&&(l+=c.size*Ws[c.type]/4)}for(var a=0;a<t.length;a++){for(var p=t[a].indexBuffer.data,h=0;h<p.length;h++)e.indexBuffer.data[h+f]+=u;u+=t[a].buffers[d].data.length/l,f+=p.length}}return e},r}(),dc=function(r){rt(t,r);function t(){var e=r.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return t}(gi),cc=function(r){rt(t,r);function t(){var e=r.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new xt(e.vertices),e.uvBuffer=new xt(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return t.prototype.map=function(e,i){var n=0,s=0;return this.uvs[0]=n,this.uvs[1]=s,this.uvs[2]=n+i.width/e.width,this.uvs[3]=s,this.uvs[4]=n+i.width/e.width,this.uvs[5]=s+i.height/e.height,this.uvs[6]=n,this.uvs[7]=s+i.height/e.height,n=i.x,s=i.y,this.vertices[0]=n,this.vertices[1]=s,this.vertices[2]=n+i.width,this.vertices[3]=s,this.vertices[4]=n+i.width,this.vertices[5]=s+i.height,this.vertices[6]=n,this.vertices[7]=s+i.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(gi),pc=0,ge=function(){function r(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=pc++,this.static=!!e,this.ubo=!!i,t instanceof xt?(this.buffer=t,this.buffer.type=zt.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new xt(new Float32Array(1)),this.buffer.type=zt.UNIFORM_BUFFER,this.autoManage=!0))}return r.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},r.prototype.add=function(t,e,i){if(!this.ubo)this.uniforms[t]=new r(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")},r.from=function(t,e,i){return new r(t,e,i)},r.uboFrom=function(t,e){return new r(t,e??!0,!0)},r}(),vc=function(){function r(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=yt.NONE,this.sourceFrame=new Y,this.destinationFrame=new Y,this.bindingSourceFrame=new Y,this.bindingDestinationFrame=new Y,this.filters=[],this.transform=null}return r.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},r}(),Ii=[new V,new V,new V,new V],Tr=new vt,gc=function(){function r(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new oc,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new dc,this.quadUv=new cc,this.tempRect=new Y,this.activeState={},this.globalUniforms=new ge({outputFrame:new Y,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return r.prototype.push=function(t,e){for(var i=this.renderer,n=this.defaultFilterStack,s=this.statePool.pop()||new vc,o=this.renderer.renderTexture,a=e[0].resolution,h=e[0].multisample,u=e[0].padding,l=e[0].autoFit,f=e[0].legacy,d=1;d<e.length;d++){var c=e[d];a=Math.min(a,c.resolution),h=Math.min(h,c.multisample),u=this.useMaxPadding?Math.max(u,c.padding):u+c.padding,l=l&&c.autoFit,f=f||c.legacy}if(n.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),n.push(s),s.resolution=a,s.multisample=h,s.legacy=f,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(u),l){var p=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Tr.copyFrom(i.projection.transform).invert(),p),s.sourceFrame.fit(p)}this.roundFrame(s.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,a,h),s.filters=e,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;var v=this.tempRect;v.x=0,v.y=0,v.width=s.sourceFrame.width,v.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(o.sourceFrame),s.bindingDestinationFrame.copyFrom(o.destinationFrame),s.transform=i.projection.transform,i.projection.transform=null,o.bind(s.renderTexture,s.sourceFrame,v),i.framebuffer.clear(0,0,0,0)},r.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var n=this.globalUniforms.uniforms;n.outputFrame=e.sourceFrame,n.resolution=e.resolution;var s=n.inputSize,o=n.inputPixel,a=n.inputClamp;if(s[0]=e.destinationFrame.width,s[1]=e.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],o[0]=Math.round(s[0]*e.resolution),o[1]=Math.round(s[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*s[2]-.5*o[2],a[3]=e.sourceFrame.height*s[3]-.5*o[3],e.legacy){var h=n.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var u=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,u.renderTexture,Qt.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var l=e.renderTexture,f=this.getOptimalFilterTexture(l.width,l.height,e.resolution);f.filterFrame=l.filterFrame;var d=0;for(d=0;d<i.length-1;++d){d===1&&e.multisample>1&&(f=this.getOptimalFilterTexture(l.width,l.height,e.resolution),f.filterFrame=l.filterFrame),i[d].apply(this,l,f,Qt.CLEAR,e);var c=l;l=f,f=c}i[d].apply(this,l,u.renderTexture,Qt.BLEND,e),d>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(f)}e.clear(),this.statePool.push(e)},r.prototype.bindAndClear=function(t,e){e===void 0&&(e=Qt.CLEAR);var i=this.renderer,n=i.renderTexture,s=i.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,n.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var a=s.stateId&1||this.forceClear;(e===Qt.CLEAR||e===Qt.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)},r.prototype.applyFilter=function(t,e,i,n){var s=this.renderer;s.state.set(t.state),this.bindAndClear(i,n),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,s.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(Lt.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(Lt.TRIANGLE_STRIP))},r.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,n=i.sourceFrame,s=i.destinationFrame,o=e._texture.orig,a=t.set(s.width,0,0,s.height,n.x,n.y),h=e.worldTransform.copyTo(vt.TEMP_MATRIX);return h.invert(),a.prepend(h),a.scale(1/o.width,1/o.height),a.translate(e.anchor.x,e.anchor.y),a},r.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},r.prototype.getOptimalFilterTexture=function(t,e,i,n){return i===void 0&&(i=1),n===void 0&&(n=yt.NONE),this.texturePool.getOptimalTexture(t,e,i,n)},r.prototype.getFilterTexture=function(t,e,i){if(typeof t=="number"){var n=t;t=e,e=n}t=t||this.activeState.renderTexture;var s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||yt.NONE);return s.filterFrame=t.filterFrame,s},r.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},r.prototype.emptyPool=function(){this.texturePool.clear(!0)},r.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},r.prototype.transformAABB=function(t,e){var i=Ii[0],n=Ii[1],s=Ii[2],o=Ii[3];i.set(e.left,e.top),n.set(e.left,e.bottom),s.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(i,i),t.apply(n,n),t.apply(s,s),t.apply(o,o);var a=Math.min(i.x,n.x,s.x,o.x),h=Math.min(i.y,n.y,s.y,o.y),u=Math.max(i.x,n.x,s.x,o.x),l=Math.max(i.y,n.y,s.y,o.y);e.x=a,e.y=h,e.width=u-a,e.height=l-h},r.prototype.roundFrame=function(t,e,i,n,s){if(s){var o=s.a,a=s.b,h=s.c,u=s.d;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(u)>1e-4))return}s=s?Tr.copyFrom(s):Tr.identity(),s.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.transformAABB(s,t),t.ceil(e),this.transformAABB(s.invert(),t)},r}(),ua=function(){function r(t){this.renderer=t}return r.prototype.flush=function(){},r.prototype.destroy=function(){this.renderer=null},r.prototype.start=function(){},r.prototype.stop=function(){this.flush()},r.prototype.render=function(t){},r}(),yc=function(){function r(t){this.renderer=t,this.emptyRenderer=new ua(t),this.currentRenderer=this.emptyRenderer}return r.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},r.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,n=e-1;n>=0;--n)t[n]=i[n]||null,t[n]&&(t[n]._batchLocation=n)},r.prototype.boundArray=function(t,e,i,n){for(var s=t.elements,o=t.ids,a=t.count,h=0,u=0;u<a;u++){var l=s[u],f=l._batchLocation;if(f>=0&&f<n&&e[f]===l){o[u]=f;continue}for(;h<n;){var d=e[h];if(d&&d._batchEnabled===i&&d._batchLocation===h){h++;continue}o[u]=h,l._batchLocation=h,e[h]=l;break}}},r.prototype.destroy=function(){this.renderer=null},r}(),$s=0,mc=function(){function r(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(r.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),r.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=$s++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},r.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=$s++,this.renderer.runners.contextChange.emit(t)},r.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},r.prototype.createContext=function(t,e){var i;if(z.PREFER_ENV>=Kt.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},r.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},r.prototype.handleContextLost=function(t){t.preventDefault()},r.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},r.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},r.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},r.prototype.validateContext=function(t){var e=t.getContextAttributes(),i="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext;i&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var n=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=n,n||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},r}(),_c=function(){function r(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=yt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}return r}(),bc=new Y,xc=function(){function r(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new cn(10,10),this.msaaSamples=null}return r.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Y,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),this.renderer.context.webGLVersion===1){var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;z.PREFER_ENV===Kt.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=function(n){return e.drawBuffersWEBGL(n)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},r.prototype.bind=function(t,e,i){i===void 0&&(i=0);var n=this.gl;if(t){var s=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,n.bindFramebuffer(n.FRAMEBUFFER,s.framebuffer)),s.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,s.mipLevel=i),s.dirtyId!==t.dirtyId&&(s.dirtyId=t.dirtyId,s.dirtyFormat!==t.dirtyFormat?(s.dirtyFormat=t.dirtyFormat,s.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):s.dirtySize!==t.dirtySize&&(s.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var o=0;o<t.colorTextures.length;o++){var a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var h=e.width>>i,u=e.height>>i,l=h/e.width;this.setViewport(e.x*l,e.y*l,h,u)}else{var h=t.width>>i,u=t.height>>i;this.setViewport(0,0,h,u)}}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},r.prototype.setViewport=function(t,e,i,n){var s=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),n=Math.round(n),(s.width!==i||s.height!==n||s.x!==t||s.y!==e)&&(s.x=t,s.y=e,s.width=i,s.height=n,this.gl.viewport(t,e,i,n))},Object.defineProperty(r.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),r.prototype.clear=function(t,e,i,n,s){s===void 0&&(s=ji.COLOR|ji.DEPTH);var o=this.gl;o.clearColor(t,e,i,n),o.clear(s)},r.prototype.initFramebuffer=function(t){var e=this.gl,i=new _c(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i},r.prototype.resizeFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.RGBA8,t.width,t.height)),i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var n=t.colorTextures,s=n.length;e.drawBuffers||(s=Math.min(s,1));for(var o=0;o<s;o++){var a=n[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},r.prototype.updateFramebuffer=function(t,e){var i=this.gl,n=t.glFramebuffers[this.CONTEXT_UID],s=t.colorTextures,o=s.length;i.drawBuffers||(o=Math.min(o,1)),n.multisample>1&&this.canMultisampleFramebuffer(t)?(n.msaaBuffer=n.msaaBuffer||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.RGBA8,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n.msaaBuffer)):n.msaaBuffer&&(i.deleteRenderbuffer(n.msaaBuffer),n.msaaBuffer=null);for(var a=[],h=0;h<o;h++){var u=s[h],l=u.parentTextureArray||u;this.renderer.texture.bind(l,0),!(h===0&&n.msaaBuffer)&&(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,u.target,l._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+h))}if(a.length>1&&i.drawBuffers(a),t.depthTexture){var f=this.writeDepthTexture;if(f){var d=t.depthTexture;this.renderer.texture.bind(d,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,d._glTextures[this.CONTEXT_UID].texture,e)}}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(n.stencil=n.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,n.stencil),n.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,n.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,n.stencil)):n.stencil&&(i.deleteRenderbuffer(n.stencil),n.stencil=null)},r.prototype.canMultisampleFramebuffer=function(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture},r.prototype.detectSamples=function(t){var e=this.msaaSamples,i=yt.NONE;if(t<=1||e===null)return i;for(var n=0;n<e.length;n++)if(e[n]<=t){i=e[n];break}return i===1&&(i=yt.NONE),i},r.prototype.blit=function(t,e,i){var n=this,s=n.current,o=n.renderer,a=n.gl,h=n.CONTEXT_UID;if(o.context.webGLVersion===2&&s){var u=s.glFramebuffers[h];if(u){if(!t){if(!u.msaaBuffer)return;u.blitFramebuffer||(u.blitFramebuffer=new cn(s.width,s.height),u.blitFramebuffer.addColorTexture(0,s.colorTextures[0])),t=u.blitFramebuffer,t.width=s.width,t.height=s.height}e||(e=bc,e.width=s.width,e.height=s.height),i||(i=e);var l=e.width===i.width&&e.height===i.height;this.bind(t),a.bindFramebuffer(a.READ_FRAMEBUFFER,u.framebuffer),a.blitFramebuffer(e.x,e.y,e.width,e.height,i.x,i.y,i.width,i.height,a.COLOR_BUFFER_BIT,l?a.NEAREST:a.LINEAR)}}},r.prototype.disposeFramebuffer=function(t,e){var i=t.glFramebuffers[this.CONTEXT_UID],n=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var s=this.managedFramebuffers.indexOf(t);s>=0&&this.managedFramebuffers.splice(s,1),t.disposeRunner.remove(this),e||(n.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&n.deleteRenderbuffer(i.msaaBuffer),i.stencil&&n.deleteRenderbuffer(i.stencil))}},r.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},r.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(!(!e||e.stencil)){t.stencil=!0;var i=t.width,n=t.height,s=this.gl,o=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,o),e.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,e.multisample,s.DEPTH24_STENCIL8,i,n):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,n),e.stencil=o,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,o)}}},r.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Y},r.prototype.destroy=function(){this.renderer=null},r}(),Ir={5126:4,5123:2,5121:1},wc=function(){function r(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return r.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){var i=this.renderer.context.extensions.vertexArrayObject;z.PREFER_ENV===Kt.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(s){return i.bindVertexArrayOES(s)},t.deleteVertexArray=function(s){return i.deleteVertexArrayOES(s)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(e.webGLVersion!==2){var n=t.getExtension("ANGLE_instanced_arrays");n?(t.vertexAttribDivisor=function(s,o){return n.vertexAttribDivisorANGLE(s,o)},t.drawElementsInstanced=function(s,o,a,h,u){return n.drawElementsInstancedANGLE(s,o,a,h,u)},t.drawArraysInstanced=function(s,o,a,h){return n.drawArraysInstancedANGLE(s,o,a,h)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex},r.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,n=t.glVertexArrayObjects[this.CONTEXT_UID],s=!1;n||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=n={},s=!0);var o=n[e.program.id]||this.initGeometryVao(t,e,s);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()},r.prototype.reset=function(){this.unbind()},r.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,i=0;i<t.buffers.length;i++){var n=t.buffers[i];e.update(n)}},r.prototype.checkCompatibility=function(t,e){var i=t.attributes,n=e.attributeData;for(var s in n)if(!i[s])throw new Error('shader and geometry incompatible, geometry missing the "'+s+'" attribute')},r.prototype.getSignature=function(t,e){var i=t.attributes,n=e.attributeData,s=["g",t.id];for(var o in i)n[o]&&s.push(o);return s.join("-")},r.prototype.initGeometryVao=function(t,e,i){i===void 0&&(i=!0);var n=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[s]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);var h=this.getSignature(t,a),u=t.glVertexArrayObjects[this.CONTEXT_UID],l=u[h];if(l)return u[a.id]=l,l;var f=t.buffers,d=t.attributes,c={},p={};for(var v in f)c[v]=0,p[v]=0;for(var v in d)!d[v].size&&a.attributeData[v]?d[v].size=a.attributeData[v].size:d[v].size||console.warn("PIXI Geometry attribute '"+v+"' size cannot be determined (likely the bound shader does not have the attribute)"),c[d[v].buffer]+=d[v].size*Ir[d[v].type];for(var v in d){var g=d[v],y=g.size;g.stride===void 0&&(c[g.buffer]===y*Ir[g.type]?g.stride=0:g.stride=c[g.buffer]),g.start===void 0&&(g.start=p[g.buffer],p[g.buffer]+=y*Ir[g.type])}l=n.createVertexArray(),n.bindVertexArray(l);for(var b=0;b<f.length;b++){var _=f[b];o.bind(_),i&&_._glBuffers[s].refCount++}return this.activateVao(t,a),this._activeVao=l,u[a.id]=l,u[h]=l,l},r.prototype.disposeGeometry=function(t,e){var i;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var n=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,o=t.buffers,a=(i=this.renderer)===null||i===void 0?void 0:i.buffer;if(t.disposeRunner.remove(this),!!n){if(a)for(var h=0;h<o.length;h++){var u=o[h]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!e&&a.dispose(o[h],e))}if(!e){for(var l in n)if(l[0]==="g"){var f=n[l];this._activeVao===f&&this.unbind(),s.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},r.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)},r.prototype.activateVao=function(t,e){var i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&s.bind(t.indexBuffer);var h=null;for(var u in a){var l=a[u],f=o[l.buffer],d=f._glBuffers[n];if(e.attributeData[u]){h!==d&&(s.bind(f),h=d);var c=e.attributeData[u].location;if(i.enableVertexAttribArray(c),i.vertexAttribPointer(c,l.size,l.type||i.FLOAT,l.normalized,l.stride,l.start),l.instance)if(this.hasInstance)i.vertexAttribDivisor(c,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},r.prototype.draw=function(t,e,i,n){var s=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?s.UNSIGNED_SHORT:s.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?s.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(i||0)*a,n||1):s.drawElements(t,e||o.indexBuffer.data.length,h,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?s.drawArraysInstanced(t,i,e||o.getSize(),n||1):s.drawArrays(t,i,e||o.getSize());return this},r.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},r.prototype.destroy=function(){this.renderer=null},r}(),Ec=function(){function r(t){t===void 0&&(t=null),this.type=Ct.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=z.FILTER_MULTISAMPLE,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return r.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Ct.NONE,this.autoDetect=!0),this._target=null},r.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},r}();function Vs(r,t,e){var i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}function Ys(r,t){var e=r.getShaderSource(t).split(`
`).map(function(u,l){return l+": "+u}),i=r.getShaderInfoLog(t),n=i.split(`
`),s={},o=n.map(function(u){return parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(u){return u&&!s[u]?(s[u]=!0,!0):!1}),a=[""];o.forEach(function(u){e[u-1]="%c"+e[u-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var h=e.join(`
`);a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function Tc(r,t,e,i){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||Ys(r,e),r.getShaderParameter(i,r.COMPILE_STATUS)||Ys(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}function Ar(r){for(var t=new Array(r),e=0;e<t.length;e++)t[e]=!1;return t}function la(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Ar(2*t);case"bvec3":return Ar(3*t);case"bvec4":return Ar(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var fa={},Ye=fa;function Ic(){if(Ye===fa||Ye&&Ye.isContextLost()){var r=document.createElement("canvas"),t=void 0;z.PREFER_ENV>=Kt.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Ye=t}return Ye}var Ai;function Ac(){if(!Ai){Ai=Ht.MEDIUM;var r=Ic();if(r&&r.getShaderPrecisionFormat){var t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);Ai=t.precision?Ht.HIGH:Ht.MEDIUM}}return Ai}function qs(r,t,e){if(r.substring(0,9)!=="precision"){var i=t;return t===Ht.HIGH&&e!==Ht.HIGH&&(i=Ht.MEDIUM),"precision "+i+` float;
`+r}else if(e!==Ht.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}var Oc={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function da(r){return Oc[r]}var Oi=null,Ks={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ca(r,t){if(!Oi){var e=Object.keys(Ks);Oi={};for(var i=0;i<e.length;++i){var n=e[i];Oi[r[n]]=Ks[n]}}return Oi[t]}var Ue=[{test:function(r){return r.type==="float"&&r.size===1},code:function(r){return`
            if(uv["`+r+'"] !== ud["'+r+`"].value)
            {
                ud["`+r+'"].value = uv["'+r+`"]
                gl.uniform1f(ud["`+r+'"].location, uv["'+r+`"])
            }
            `}},{test:function(r){return(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray},code:function(r){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+r+`"], t);

            if(ud["`+r+`"].value !== t)
            {
                ud["`+r+`"].value = t;
                gl.uniform1i(ud["`+r+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(r,t){return r.type==="mat3"&&r.size===1&&t.a!==void 0},code:function(r){return`
            gl.uniformMatrix3fv(ud["`+r+'"].location, false, uv["'+r+`"].toArray(true));
            `},codeUbo:function(r){return`
                var `+r+"_matrix = uv."+r+`.toArray(true);

                data[offset] = `+r+`_matrix[0];
                data[offset+1] = `+r+`_matrix[1];
                data[offset+2] = `+r+`_matrix[2];
        
                data[offset + 4] = `+r+`_matrix[3];
                data[offset + 5] = `+r+`_matrix[4];
                data[offset + 6] = `+r+`_matrix[5];
        
                data[offset + 8] = `+r+`_matrix[6];
                data[offset + 9] = `+r+`_matrix[7];
                data[offset + 10] = `+r+`_matrix[8];
            `}},{test:function(r,t){return r.type==="vec2"&&r.size===1&&t.x!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+r+`"].location, v.x, v.y);
                }`},codeUbo:function(r){return`
                v = uv.`+r+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(r){return r.type==="vec2"&&r.size===1},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+r+`"].location, v[0], v[1]);
                }
            `}},{test:function(r,t){return r.type==="vec4"&&r.size===1&&t.width!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+r+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(r){return`
                    v = uv.`+r+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(r){return r.type==="vec4"&&r.size===1},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+r+`"].location, v[0], v[1], v[2], v[3])
                }`}}],Sc={float:`
    if(cv !== v)
    {
        cv.v = v;
        gl.uniform1f(location, v)
    }`,vec2:`
    if(cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",uint:"gl.uniform1ui(location, v)",uvec2:"gl.uniform2ui(location, v[0], v[1])",uvec3:"gl.uniform3ui(location, v[0], v[1], v[2])",uvec4:"gl.uniform4ui(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Nc={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Cc(r,t){var e=[`
        var v = null;
        var cv = null
        var t = 0;
        var gl = renderer.gl
    `];for(var i in r.uniforms){var n=t[i];if(!n){r.uniforms[i].group&&(r.uniforms[i].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+i+", '"+i+`');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.`+i+`, syncData);
                    `));continue}for(var s=r.uniforms[i],o=!1,a=0;a<Ue.length;a++)if(Ue[a].test(n,s)){e.push(Ue[a].code(i,s)),o=!0;break}if(!o){var h=n.size===1?Sc:Nc,u=h[n.type].replace("location",'ud["'+i+'"].location');e.push(`
            cv = ud["`+i+`"].value;
            v = uv["`+i+`"];
            `+u+";")}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}var Pc=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Lc(r){for(var t="",e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+="if(test == "+e+".0){}");return t}function Rc(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var e=t.createShader(t.FRAGMENT_SHADER);;){var i=Pc.replace(/%forloop%/gi,Lc(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}var qe;function Mc(){if(typeof qe=="boolean")return qe;try{var r=new Function("param1","param2","param3","return param1[param2] === param3;");qe=r({a:"b"},"a","b")===!0}catch{qe=!1}return qe}var Uc=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Fc=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,Dc=0,Si={},yi=function(){function r(t,e,i){i===void 0&&(i="pixi-shader"),this.id=Dc++,this.vertexSrc=t||r.defaultVertexSrc,this.fragmentSrc=e||r.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Si[i]?(Si[i]++,i+="-"+Si[i]):Si[i]=1,this.vertexSrc="#define SHADER_NAME "+i+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+`
`+this.fragmentSrc,this.vertexSrc=qs(this.vertexSrc,z.PRECISION_VERTEX,Ht.HIGH),this.fragmentSrc=qs(this.fragmentSrc,z.PRECISION_FRAGMENT,Ac())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(r,"defaultVertexSrc",{get:function(){return Fc},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentSrc",{get:function(){return Uc},enumerable:!1,configurable:!0}),r.from=function(t,e,i){var n=t+e,s=Xs[n];return s||(Xs[n]=s=new r(t,e,i)),s},r}(),mi=function(){function r(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ge?this.uniformGroup=e:this.uniformGroup=new ge(e):this.uniformGroup=new ge({})}return r.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var n=e.uniforms[i];if(n.group&&this.checkUniformExists(t,n))return!0}return!1},r.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(r.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),r.from=function(t,e,i){var n=yi.from(t,e);return new r(n,i)},r}(),Or=0,Sr=1,Nr=2,Cr=3,Pr=4,Lr=5,$e=function(){function r(){this.data=0,this.blendMode=G.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(r.prototype,"blend",{get:function(){return!!(this.data&1<<Or)},set:function(t){!!(this.data&1<<Or)!==t&&(this.data^=1<<Or)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsets",{get:function(){return!!(this.data&1<<Sr)},set:function(t){!!(this.data&1<<Sr)!==t&&(this.data^=1<<Sr)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"culling",{get:function(){return!!(this.data&1<<Nr)},set:function(t){!!(this.data&1<<Nr)!==t&&(this.data^=1<<Nr)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthTest",{get:function(){return!!(this.data&1<<Cr)},set:function(t){!!(this.data&1<<Cr)!==t&&(this.data^=1<<Cr)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthMask",{get:function(){return!!(this.data&1<<Lr)},set:function(t){!!(this.data&1<<Lr)!==t&&(this.data^=1<<Lr)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<Pr)},set:function(t){!!(this.data&1<<Pr)!==t&&(this.data^=1<<Pr)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==G.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[@pixi/core:State "+("blendMode="+this.blendMode+" ")+("clockwiseFrontFace="+this.clockwiseFrontFace+" ")+("culling="+this.culling+" ")+("depthMask="+this.depthMask+" ")+("polygonOffset="+this.polygonOffset)+"]"},r.for2d=function(){var t=new r;return t.depthTest=!1,t.blend=!0,t},r}(),kc=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Bc=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Gc=function(r){rt(t,r);function t(e,i,n){var s=this,o=yi.from(e||t.defaultVertexSrc,i||t.defaultFragmentSrc);return s=r.call(this,o,n)||this,s.padding=0,s.resolution=z.FILTER_RESOLUTION,s.multisample=z.FILTER_MULTISAMPLE,s.enabled=!0,s.autoFit=!0,s.state=new $e,s}return t.prototype.apply=function(e,i,n,s,o){e.applyFilter(this,i,n,s)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return kc},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return Bc},enumerable:!1,configurable:!0}),t}(mi),Hc=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,Xc=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Js=new vt,pa=function(){function r(t,e){this._texture=t,this.mapCoord=new vt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}return Object.defineProperty(r.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),r.prototype.multiplyUvs=function(t,e){e===void 0&&(e=t);for(var i=this.mapCoord,n=0;n<t.length;n+=2){var s=t[n],o=t[n+1];e[n]=s*i.a+o*i.c+i.tx,e[n+1]=s*i.b+o*i.d+i.ty}return e},r.prototype.update=function(t){var e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var n=e.orig,s=e.trim;s&&(Js.set(n.width/s.width,0,0,n.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Js));var o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(e._frame.x+h+u)/o.width,a[1]=(e._frame.y+h+u)/o.height,a[2]=(e._frame.x+e._frame.width-h+u)/o.width,a[3]=(e._frame.y+e._frame.height-h+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0},r}(),zc=function(r){rt(t,r);function t(e){var i=this,n=new vt;return i=r.call(this,Hc,Xc)||this,e.renderable=!1,i.maskSprite=e,i.maskMatrix=n,i}return t.prototype.apply=function(e,i,n,s){var o=this.maskSprite,a=o._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new pa(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,o).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,e.applyFilter(this,i,n,s))},t}(Gc),jc=function(){function r(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return r.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},r.prototype.push=function(t,e){var i=e;if(!i.isMaskData){var n=this.maskDataPool.pop()||new Ec;n.pooled=!0,n.maskObject=e,i=n}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=t,i.type){case Ct.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case Ct.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case Ct.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i);break}},r.prototype.pop=function(t){var e=this.maskStack.pop();if(!(!e||e._target!==t)){switch(e.type){case Ct.SCISSOR:this.renderer.scissor.pop();break;case Ct.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ct.SPRITE:this.popSpriteMask();break}e.reset(),e.pooled&&this.maskDataPool.push(e)}},r.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite){t.type=Ct.SPRITE;return}if(t.type=Ct.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,n=Math.atan2(i.b,i.a),s=Math.atan2(i.d,i.c);n=Math.round(n*(180/Math.PI)*100),s=Math.round(s*(180/Math.PI)*100)-n,n=(n%9e3+9e3)%9e3,s=(s%18e3+18e3)%18e3,n===0&&s===9e3&&(t.type=Ct.SCISSOR)}},r.prototype.pushSpriteMask=function(t){var e,i,n=t.maskObject,s=t._target,o=this.alphaMaskPool[this.alphaMaskIndex];o||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new zc(n)]);var a=this.renderer,h=a.renderTexture,u,l;if(h.current){var f=h.current;u=t.resolution||f.resolution,l=(e=t.multisample)!==null&&e!==void 0?e:f.multisample}else u=t.resolution||a.resolution,l=(i=t.multisample)!==null&&i!==void 0?i:a.multisample;o[0].resolution=u,o[0].multisample=l,o[0].maskSprite=n;var d=s.filterArea;s.filterArea=n.getBounds(!0),a.filter.push(s,o),s.filterArea=d,this.alphaMaskIndex++},r.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},r.prototype.destroy=function(){this.renderer=null},r}(),va=function(){function r(t){this.renderer=t,this.maskStack=[],this.glConst=0}return r.prototype.getStackLength=function(){return this.maskStack.length},r.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var n=this.getStackLength();n!==i&&(n===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},r.prototype._useCurrent=function(){},r.prototype.destroy=function(){this.renderer=null,this.maskStack=null},r}(),Wc=function(r){rt(t,r);function t(e){var i=r.call(this,e)||this;return i.glConst=WebGLRenderingContext.SCISSOR_TEST,i}return t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var i=e.maskObject;i.renderable=!0;var n=e._scissorRect,s=i.getBounds(!0),o=this.renderer.gl;i.renderable=!1,n?s.fit(n):o.enable(o.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=s,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,i=this.renderer.renderTexture.current,n=this.renderer.projection,s=n.transform,o=n.sourceFrame,a=n.destinationFrame,h=i?i.resolution:this.renderer.resolution,u=a.width/o.width,l=a.height/o.height,f=((e.x-o.x)*u+a.x)*h,d=((e.y-o.y)*l+a.y)*h,c=e.width*u*h,p=e.height*l*h;s&&(f+=s.tx*h,d+=s.ty*h),i||(d=this.renderer.height-p-d),f=Math.round(f),d=Math.round(d),c=Math.round(c),p=Math.round(p),this.renderer.gl.scissor(f,d,c,p)},t}(va),$c=function(r){rt(t,r);function t(e){var i=r.call(this,e)||this;return i.glConst=WebGLRenderingContext.STENCIL_TEST,i}return t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var i=e.maskObject,n=this.renderer.gl,s=e._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),e._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,s,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),i.renderable=!0,i.render(this.renderer),this.renderer.batch.flush(),i.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var i=this.renderer.gl;this.getStackLength()===0?(i.disable(i.STENCIL_TEST),i.clear(i.STENCIL_BUFFER_BIT),i.clearStencil(0)):(i.colorMask(!1,!1,!1,!1),i.stencilOp(i.KEEP,i.KEEP,i.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(va),Vc=function(){function r(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new vt,this.transform=null}return r.prototype.update=function(t,e,i,n){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,n),this.transform&&this.projectionMatrix.append(this.transform);var s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)},r.prototype.calculateProjection=function(t,e,i,n){var s=this.projectionMatrix,o=n?-1:1;s.identity(),s.a=1/e.width*2,s.d=o*(1/e.height*2),s.tx=-1-e.x*s.a,s.ty=-o-e.y*s.d},r.prototype.setTransform=function(t){},r.prototype.destroy=function(){this.renderer=null},r}(),se=new Y,Ke=new Y,Yc=function(){function r(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Y,this.destinationFrame=new Y,this.viewportFrame=new Y}return r.prototype.bind=function(t,e,i){t===void 0&&(t=null);var n=this.renderer;this.current=t;var s,o,a;t?(s=t.baseTexture,a=s.resolution,e||(se.width=t.frame.width,se.height=t.frame.height,e=se),i||(Ke.x=t.frame.x,Ke.y=t.frame.y,Ke.width=e.width,Ke.height=e.height,i=Ke),o=s.framebuffer):(a=n.resolution,e||(se.width=n.screen.width,se.height=n.screen.height,e=se),i||(i=se,i.width=e.width,i.height=e.height));var h=this.viewportFrame;h.x=i.x*a,h.y=i.y*a,h.width=i.width*a,h.height=i.height*a,t||(h.y=n.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,e,a,!o),t?this.renderer.mask.setMaskStack(s.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)},r.prototype.clear=function(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.clearColor;var i=this.destinationFrame,n=this.current?this.current.baseTexture:this.renderer.screen,s=i.width!==n.width||i.height!==n.height;if(s){var o=this.viewportFrame,a=o.x,h=o.y,u=o.width,l=o.height;a=Math.round(a),h=Math.round(h),u=Math.round(u),l=Math.round(l),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(a,h,u,l)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),s&&this.renderer.scissor.pop()},r.prototype.resize=function(){this.bind(null)},r.prototype.reset=function(){this.bind(null)},r.prototype.destroy=function(){this.renderer=null},r}();function qc(r,t,e,i,n){e.buffer.update(n)}var Kc={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},ga={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Jc(r){for(var t=r.map(function(h){return{data:h,offset:0,dataLen:0,dirty:0}}),e=0,i=0,n=0,s=0;s<t.length;s++){var o=t[s];if(e=ga[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,i%e!==0&&i<16){var a=i%e%16;i+=a,n+=a}i+e>16?(n=Math.ceil(n/16)*16,o.offset=n,n+=e,i=e):(o.offset=n,i+=e,n+=e)}return n=Math.ceil(n/16)*16,{uboElements:t,size:n}}function Zc(r,t){var e=[];for(var i in r)t[i]&&e.push(t[i]);return e.sort(function(n,s){return n.index-s.index}),e}function Qc(r,t){if(!r.autoManage)return{size:0,syncFunc:qc};for(var e=Zc(r.uniforms,t),i=Jc(e),n=i.uboElements,s=i.size,o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],a=0;a<n.length;a++){for(var h=n[a],u=r.uniforms[h.data.name],l=h.data.name,f=!1,d=0;d<Ue.length;d++){var c=Ue[d];if(c.codeUbo&&c.test(h.data,u)){o.push("offset = "+h.offset/4+";",Ue[d].codeUbo(h.data.name,u)),f=!0;break}}if(!f)if(h.data.size>1){var p=da(h.data.type),v=Math.max(ga[h.data.type]/16,1),g=p/v,y=(4-g%4)%4;o.push(`
                cv = ud.`+l+`.value;
                v = uv.`+l+`;
                offset = `+h.offset/4+`;

                t = 0;

                for(var i=0; i < `+h.data.size*v+`; i++)
                {
                    for(var j = 0; j < `+g+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+y+`;
                }

                `)}else{var b=Kc[h.data.type];o.push(`
                cv = ud.`+l+`.value;
                v = uv.`+l+`;
                offset = `+h.offset/4+`;
                `+b+`;
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}var tp=function(){function r(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return r.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},r}();function ep(r,t){for(var e={},i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),n=0;n<i;n++){var s=t.getActiveAttrib(r,n);if(!s.name.startsWith("gl_")){var o=ca(t,s.type),a={type:o,name:s.name,size:da(o),location:n};e[s.name]=a}}return e}function ip(r,t){for(var e={},i=t.getProgramParameter(r,t.ACTIVE_UNIFORMS),n=0;n<i;n++){var s=t.getActiveUniform(r,n),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),h=ca(t,s.type);e[o]={name:o,index:n,type:h,size:s.size,isArray:a,value:la(h,s.size)}}return e}function rp(r,t){var e=Vs(r,r.VERTEX_SHADER,t.vertexSrc),i=Vs(r,r.FRAGMENT_SHADER,t.fragmentSrc),n=r.createProgram();r.attachShader(n,e),r.attachShader(n,i),r.linkProgram(n),r.getProgramParameter(n,r.LINK_STATUS)||Tc(r,n,e,i),t.attributeData=ep(n,r),t.uniformData=ip(n,r);var s=Object.keys(t.attributeData);s.sort(function(l,f){return l>f?1:-1});for(var o=0;o<s.length;o++)t.attributeData[s[o]].location=o,r.bindAttribLocation(n,o,s[o]);r.linkProgram(n),r.deleteShader(e),r.deleteShader(i);var a={};for(var o in t.uniformData){var h=t.uniformData[o];a[o]={location:r.getUniformLocation(n,o),value:la(h.type,h.size)}}var u=new tp(n,a);return u}var np=0,Ni={textureCount:0,uboCount:0},sp=function(){function r(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=np++}return r.prototype.systemCheck=function(){if(!Mc())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},r.prototype.contextChange=function(t){this.gl=t,this.reset()},r.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,n=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(n.program)),e||(Ni.textureCount=0,Ni.uboCount=0,this.syncUniformGroup(t.uniformGroup,Ni)),n},r.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},r.prototype.syncUniformGroup=function(t,e){var i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))},r.prototype.syncUniforms=function(t,e,i){var n=t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t);n(e.uniformData,t.uniforms,this.renderer,i)},r.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Cc(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},r.prototype.syncUniformBufferGroup=function(t,e){var i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;var n=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),n(i.uniformData,t.uniforms,this.renderer,Ni,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])},r.prototype.createSyncBufferGroup=function(t,e,i){var n=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var s=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,n.uniformBlockBinding(e.program,s,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(t,this.shader.program.uniformData,"ubo"),a=this._uboCache[o];if(a||(a=this._uboCache[o]=Qc(t,this.shader.program.uniformData)),t.autoManage){var h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]},r.prototype.getSignature=function(t,e,i){var n=t.uniforms,s=[i+"-"];for(var o in n)s.push(o),e[o]&&s.push(e[o].type);return s.join("-")},r.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},r.prototype.generateProgram=function(t){var e=this.gl,i=t.program,n=rp(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=n,n},r.prototype.reset=function(){this.program=null,this.shader=null},r.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},r}();function op(r,t){return t===void 0&&(t=[]),t[G.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.ADD]=[r.ONE,r.ONE],t[G.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.NONE]=[0,0],t[G.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[G.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[G.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[G.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[G.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[G.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[G.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[G.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[G.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[G.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[G.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}var ap=0,hp=1,up=2,lp=3,fp=4,dp=5,cp=function(){function r(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=G.NONE,this._blendEq=!1,this.map=[],this.map[ap]=this.setBlend,this.map[hp]=this.setOffset,this.map[up]=this.setCullFace,this.map[lp]=this.setDepthTest,this.map[fp]=this.setFrontFace,this.map[dp]=this.setDepthMask,this.checks=[],this.defaultState=new $e,this.defaultState.blend=!0}return r.prototype.contextChange=function(t){this.gl=t,this.blendModes=op(t),this.set(this.defaultState),this.reset()},r.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(var i=0;i<this.checks.length;i++)this.checks[i](this,t)},r.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},r.prototype.setBlend=function(t){this.updateCheck(r.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},r.prototype.setOffset=function(t){this.updateCheck(r.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},r.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},r.prototype.setDepthMask=function(t){this.gl.depthMask(t)},r.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},r.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},r.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},r.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},r.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},r.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)},r.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},r.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},r.prototype.destroy=function(){this.gl=null},r}(),pp=function(){function r(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=z.GC_MAX_IDLE,this.checkCountMax=z.GC_MAX_CHECK_COUNT,this.mode=z.GC_MODE}return r.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Yr.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},r.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,n=0;n<e.length;n++){var s=e[n];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(t.destroyTexture(s,!0),e[n]=null,i=!0)}if(i){for(var o=0,n=0;n<e.length;n++)e[n]!==null&&(e[o++]=e[n]);e.length=o}},r.prototype.unload=function(t){var e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(var n=t.children.length-1;n>=0;n--)this.unload(t.children[n])},r.prototype.destroy=function(){this.renderer=null},r}();function vp(r){var t,e,i,n,s,o,a,h,u,l,f,d,c,p,v,g,y,b,_,T,m,x,A;return"WebGL2RenderingContext"in self&&r instanceof self.WebGL2RenderingContext?A=(t={},t[W.UNSIGNED_BYTE]=(e={},e[R.RGBA]=r.RGBA8,e[R.RGB]=r.RGB8,e[R.RG]=r.RG8,e[R.RED]=r.R8,e[R.RGBA_INTEGER]=r.RGBA8UI,e[R.RGB_INTEGER]=r.RGB8UI,e[R.RG_INTEGER]=r.RG8UI,e[R.RED_INTEGER]=r.R8UI,e[R.ALPHA]=r.ALPHA,e[R.LUMINANCE]=r.LUMINANCE,e[R.LUMINANCE_ALPHA]=r.LUMINANCE_ALPHA,e),t[W.BYTE]=(i={},i[R.RGBA]=r.RGBA8_SNORM,i[R.RGB]=r.RGB8_SNORM,i[R.RG]=r.RG8_SNORM,i[R.RED]=r.R8_SNORM,i[R.RGBA_INTEGER]=r.RGBA8I,i[R.RGB_INTEGER]=r.RGB8I,i[R.RG_INTEGER]=r.RG8I,i[R.RED_INTEGER]=r.R8I,i),t[W.UNSIGNED_SHORT]=(n={},n[R.RGBA_INTEGER]=r.RGBA16UI,n[R.RGB_INTEGER]=r.RGB16UI,n[R.RG_INTEGER]=r.RG16UI,n[R.RED_INTEGER]=r.R16UI,n[R.DEPTH_COMPONENT]=r.DEPTH_COMPONENT16,n),t[W.SHORT]=(s={},s[R.RGBA_INTEGER]=r.RGBA16I,s[R.RGB_INTEGER]=r.RGB16I,s[R.RG_INTEGER]=r.RG16I,s[R.RED_INTEGER]=r.R16I,s),t[W.UNSIGNED_INT]=(o={},o[R.RGBA_INTEGER]=r.RGBA32UI,o[R.RGB_INTEGER]=r.RGB32UI,o[R.RG_INTEGER]=r.RG32UI,o[R.RED_INTEGER]=r.R32UI,o[R.DEPTH_COMPONENT]=r.DEPTH_COMPONENT24,o),t[W.INT]=(a={},a[R.RGBA_INTEGER]=r.RGBA32I,a[R.RGB_INTEGER]=r.RGB32I,a[R.RG_INTEGER]=r.RG32I,a[R.RED_INTEGER]=r.R32I,a),t[W.FLOAT]=(h={},h[R.RGBA]=r.RGBA32F,h[R.RGB]=r.RGB32F,h[R.RG]=r.RG32F,h[R.RED]=r.R32F,h[R.DEPTH_COMPONENT]=r.DEPTH_COMPONENT32F,h),t[W.HALF_FLOAT]=(u={},u[R.RGBA]=r.RGBA16F,u[R.RGB]=r.RGB16F,u[R.RG]=r.RG16F,u[R.RED]=r.R16F,u),t[W.UNSIGNED_SHORT_5_6_5]=(l={},l[R.RGB]=r.RGB565,l),t[W.UNSIGNED_SHORT_4_4_4_4]=(f={},f[R.RGBA]=r.RGBA4,f),t[W.UNSIGNED_SHORT_5_5_5_1]=(d={},d[R.RGBA]=r.RGB5_A1,d),t[W.UNSIGNED_INT_2_10_10_10_REV]=(c={},c[R.RGBA]=r.RGB10_A2,c[R.RGBA_INTEGER]=r.RGB10_A2UI,c),t[W.UNSIGNED_INT_10F_11F_11F_REV]=(p={},p[R.RGB]=r.R11F_G11F_B10F,p),t[W.UNSIGNED_INT_5_9_9_9_REV]=(v={},v[R.RGB]=r.RGB9_E5,v),t[W.UNSIGNED_INT_24_8]=(g={},g[R.DEPTH_STENCIL]=r.DEPTH24_STENCIL8,g),t[W.FLOAT_32_UNSIGNED_INT_24_8_REV]=(y={},y[R.DEPTH_STENCIL]=r.DEPTH32F_STENCIL8,y),t):A=(b={},b[W.UNSIGNED_BYTE]=(_={},_[R.RGBA]=r.RGBA,_[R.RGB]=r.RGB,_[R.ALPHA]=r.ALPHA,_[R.LUMINANCE]=r.LUMINANCE,_[R.LUMINANCE_ALPHA]=r.LUMINANCE_ALPHA,_),b[W.UNSIGNED_SHORT_5_6_5]=(T={},T[R.RGB]=r.RGB,T),b[W.UNSIGNED_SHORT_4_4_4_4]=(m={},m[R.RGBA]=r.RGBA,m),b[W.UNSIGNED_SHORT_5_5_5_1]=(x={},x[R.RGBA]=r.RGBA,x),b),A}var Rr=function(){function r(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=W.UNSIGNED_BYTE,this.internalFormat=R.RGBA,this.samplerType=0}return r}(),gp=function(){function r(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new _t,this.hasIntegerTextures=!1}return r.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=vp(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var n=new Rr(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Rr(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var i=0;i<this.boundTextures.length;i++)this.bind(null,i)},r.prototype.bind=function(t,e){e===void 0&&(e=0);var i=this.gl;if(t=t==null?void 0:t.castToBaseTexture(),t&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var n=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,n.texture)),n.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},r.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},r.prototype.unbind=function(t){var e=this,i=e.gl,n=e.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var s=0;s<n.length;s++)n[s]===this.unknownTexture&&this.bind(null,s)}for(var s=0;s<n.length;s++)n[s]===t&&(this.currentLocation!==s&&(i.activeTexture(i.TEXTURE0+s),this.currentLocation=s),i.bindTexture(t.target,this.emptyTextures[t.target].texture),n[s]=null)},r.prototype.ensureSamplerType=function(t){var e=this,i=e.boundTextures,n=e.hasIntegerTextures,s=e.CONTEXT_UID;if(n)for(var o=t-1;o>=0;--o){var a=i[o];if(a){var h=a._glTextures[s];h.samplerType!==Wi.FLOAT&&this.renderer.texture.unbind(a)}}},r.prototype.initTexture=function(t){var e=new Rr(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},r.prototype.initTextureType=function(t,e){var i,n;e.internalFormat=(n=(i=this.internalFormats[t.type])===null||i===void 0?void 0:i[t.format])!==null&&n!==void 0?n:t.format,this.webGLVersion===2&&t.type===W.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},r.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e))e.samplerType!==Wi.FLOAT&&(this.hasIntegerTextures=!0);else{var n=t.realWidth,s=t.realHeight,o=i.gl;(e.width!==n||e.height!==s||e.dirtyId<0)&&(e.width=n,e.height=s,o.texImage2D(t.target,0,e.internalFormat,n,s,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},r.prototype.destroyTexture=function(t,e){var i=this.gl;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var n=this.managedTextures.indexOf(t);n!==-1&&ri(this.managedTextures,n,1)}},r.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===_e.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=ke.CLAMP:e.wrapMode=t.wrapMode,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},r.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&t.mipmap!==_e.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Gt.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&t.anisotropicLevel>0&&t.scaleMode===Gt.LINEAR){var s=Math.min(t.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Gt.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Gt.LINEAR?i.LINEAR:i.NEAREST)},r.prototype.destroy=function(){this.renderer=null},r}(),Mr=new vt,yp=function(r){rt(t,r);function t(e,i){e===void 0&&(e=si.UNKNOWN);var n=r.call(this)||this;return i=Object.assign({},z.RENDER_OPTIONS,i),n.options=i,n.type=e,n.screen=new Y(0,0,i.width,i.height),n.view=i.view||document.createElement("canvas"),n.resolution=i.resolution||z.RESOLUTION,n.useContextAlpha=i.useContextAlpha,n.autoDensity=!!i.autoDensity,n.preserveDrawingBuffer=i.preserveDrawingBuffer,n.clearBeforeRender=i.clearBeforeRender,n._backgroundColor=0,n._backgroundColorRgba=[0,0,0,1],n._backgroundColorString="#000000",n.backgroundColor=i.backgroundColor||n._backgroundColor,n.backgroundAlpha=i.backgroundAlpha,i.transparent!==void 0&&(li("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),n.useContextAlpha=i.transparent,n.backgroundAlpha=i.transparent?0:1),n._lastObjectRendered=null,n.plugins={},n}return t.prototype.initPlugins=function(e){for(var i in e)this.plugins[i]=new e[i](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,i){this.view.width=Math.round(e*this.resolution),this.view.height=Math.round(i*this.resolution);var n=this.view.width/this.resolution,s=this.view.height/this.resolution;this.screen.width=n,this.screen.height=s,this.autoDensity&&(this.view.style.width=n+"px",this.view.style.height=s+"px"),this.emit("resize",n,s)},t.prototype.generateTexture=function(e,i,n,s){i===void 0&&(i={}),typeof i=="number"&&(li("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),i={scaleMode:i,resolution:n,region:s});var o=i.region,a=Jd(i,["region"]);s=o||e.getLocalBounds(null,!0),s.width===0&&(s.width=1),s.height===0&&(s.height=1);var h=Fn.create(dn({width:s.width,height:s.height},a));return Mr.tx=-s.x,Mr.ty=-s.y,this.render(e,{renderTexture:h,clear:!1,transform:Mr,skipUpdateTransform:!!e.parent}),h},t.prototype.destroy=function(e){for(var i in this.plugins)this.plugins[i].destroy(),this.plugins[i]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=si.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=Jo(e),xe(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),t}(vi),mp=function(){function r(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return r}(),_p=function(){function r(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return r.prototype.destroy=function(){this.renderer=null},r.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},r.prototype.bind=function(t){var e=this,i=e.gl,n=e.CONTEXT_UID,s=t._glBuffers[n]||this.createGLBuffer(t);i.bindBuffer(t.type,s.buffer)},r.prototype.bindBufferBase=function(t,e){var i=this,n=i.gl,s=i.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var o=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,o.buffer)}},r.prototype.bindBufferRange=function(t,e,i){var n=this,s=n.gl,o=n.CONTEXT_UID;i=i||0;var a=t._glBuffers[o]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,a.buffer,i*256,256)},r.prototype.update=function(t){var e=this,i=e.gl,n=e.CONTEXT_UID,s=t._glBuffers[n];if(t._updateID!==s.updateID)if(s.updateID=t._updateID,i.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)i.bufferSubData(t.type,0,t.data);else{var o=t.static?i.STATIC_DRAW:i.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,i.bufferData(t.type,t.data,o)}},r.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],n=this.gl;t.disposeRunner.remove(this),i&&(e||n.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},r.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)},r.prototype.createGLBuffer=function(t){var e=this,i=e.CONTEXT_UID,n=e.gl;return t._glBuffers[i]=new mp(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[i]},r}(),Dn=function(r){rt(t,r);function t(e){var i=r.call(this,si.WEBGL,e)||this;return e=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new Tt("destroy"),contextChange:new Tt("contextChange"),reset:new Tt("reset"),update:new Tt("update"),postrender:new Tt("postrender"),prerender:new Tt("prerender"),resize:new Tt("resize")},i.runners.contextChange.add(i),i.globalUniforms=new ge({projectionMatrix:new vt},!0),i.addSystem(jc,"mask").addSystem(mc,"context").addSystem(cp,"state").addSystem(sp,"shader").addSystem(gp,"texture").addSystem(_p,"buffer").addSystem(wc,"geometry").addSystem(xc,"framebuffer").addSystem(Wc,"scissor").addSystem($c,"stencil").addSystem(Vc,"projection").addSystem(pp,"textureGC").addSystem(gc,"filter").addSystem(Yc,"renderTexture").addSystem(yc,"batch"),i.initPlugins(t.__plugins),i.multisample=void 0,e.context?i.context.initFromContext(e.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:e.antialias,premultipliedAlpha:i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,qu(i.context.webGLVersion===2?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return t.create=function(e){if(Ku())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.contextChange=function(){var e=this.gl,i;if(this.context.webGLVersion===1){var n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{var n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),i=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}i>=yt.HIGH?this.multisample=yt.HIGH:i>=yt.MEDIUM?this.multisample=yt.MEDIUM:i>=yt.LOW?this.multisample=yt.LOW:this.multisample=yt.NONE},t.prototype.addSystem=function(e,i){var n=new e(this);if(this[i])throw new Error('Whoops! The name "'+i+'" is already in use');this[i]=n;for(var s in this.runners)this.runners[s].add(n);return this},t.prototype.render=function(e,i){var n,s,o,a;if(i&&(i instanceof Fn?(li("6.0.0","Renderer#render arguments changed, use options instead."),n=i,s=arguments[2],o=arguments[3],a=arguments[4]):(n=i.renderTexture,s=i.clear,o=i.transform,a=i.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=o,!this.context.isLost){if(n||(this._lastObjectRendered=e),!a){var h=e.enableTempParent();e.updateTransform(),e.disableTempParent(h)}this.renderTexture.bind(n),this.batch.currentRenderer.start(),(s!==void 0?s:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.generateTexture=function(e,i,n,s){i===void 0&&(i={});var o=r.prototype.generateTexture.call(this,e,i,n,s);return this.framebuffer.blit(),o},t.prototype.resize=function(e,i){r.prototype.resize.call(this,e,i),this.runners.resize.emit(this.screen.height,this.screen.width)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(e){this.runners.destroy.emit();for(var i in this.runners)this.runners[i].destroy();r.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(t.prototype,"extract",{get:function(){return li("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),t.registerPlugin=function(e,i){t.__plugins=t.__plugins||{},t.__plugins[e]=i},t}(yp);function bp(r){return Dn.create(r)}var pn=function(){function r(){this.texArray=null,this.blend=0,this.type=Lt.TRIANGLES,this.start=0,this.size=0,this.data=null}return r}(),qi=function(){function r(){this.elements=[],this.ids=[],this.count=0}return r.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},r}(),xp=function(){function r(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(r.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),r.prototype.view=function(t){return this[t+"View"]},r.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},r.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},r}(),wp=function(r){rt(t,r);function t(e){var i=r.call(this,e)||this;return i.shaderGenerator=null,i.geometryClass=null,i.vertexSize=null,i.state=$e.for2d(),i.size=z.SPRITE_BATCH_SIZE*4,i._vertexCount=0,i._indexCount=0,i._bufferedElements=[],i._bufferedTextures=[],i._bufferSize=0,i._shader=null,i._packedGeometries=[],i._packedGeometryPoolSize=2,i._flushId=0,i._aBuffers={},i._iBuffers={},i.MAX_TEXTURES=1,i.renderer.on("prerender",i.onPrerender,i),e.runners.contextChange.add(i),i._dcIndex=0,i._aIndex=0,i._iIndex=0,i._attributeBuffer=null,i._indexBuffer=null,i._tempBoundTextures=[],i}return t.prototype.contextChange=function(){var e=this.renderer.gl;z.PREFER_ENV===Kt.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),z.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Rc(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,i=t._textureArrayPool,n=this.size/4,s=Math.floor(n/this.MAX_TEXTURES)+1;e.length<n;)e.push(new pn);for(;i.length<s;)i.push(new qi);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this,i=e._bufferedTextures,n=e.MAX_TEXTURES,s=t._textureArrayPool,o=this.renderer.batch,a=this._tempBoundTextures,h=this.renderer.textureGC.count,u=++_t._globalBatch,l=0,f=s[0],d=0;o.copyBoundTextures(a,n);for(var c=0;c<this._bufferSize;++c){var p=i[c];i[c]=null,p._batchEnabled!==u&&(f.count>=n&&(o.boundArray(f,a,u,n),this.buildDrawCalls(f,d,c),d=c,f=s[++l],++u),p._batchEnabled=u,p.touched=h,f.elements[f.count++]=p)}f.count>0&&(o.boundArray(f,a,u,n),this.buildDrawCalls(f,d,this._bufferSize),++l,++u);for(var c=0;c<a.length;c++)a[c]=null;_t._globalBatch=u},t.prototype.buildDrawCalls=function(e,i,n){var s=this,o=s._bufferedElements,a=s._attributeBuffer,h=s._indexBuffer,u=s.vertexSize,l=t._drawCallPool,f=this._dcIndex,d=this._aIndex,c=this._iIndex,p=l[f];p.start=this._iIndex,p.texArray=e;for(var v=i;v<n;++v){var g=o[v],y=g._texture.baseTexture,b=Hd[y.alphaMode?1:0][g.blendMode];o[v]=null,i<v&&p.blend!==b&&(p.size=c-p.start,i=v,p=l[++f],p.texArray=e,p.start=c),this.packInterleavedGeometry(g,a,h,d,c),d+=g.vertexData.length/2*u,c+=g.indices.length,p.blend=b}i<n&&(p.size=c-p.start,++f),this._dcIndex=f,this._aIndex=d,this._iIndex=c},t.prototype.bindAndClearTexArray=function(e){for(var i=this.renderer.texture,n=0;n<e.count;n++)i.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,i=e._packedGeometries,n=e._attributeBuffer,s=e._indexBuffer;z.CAN_UPLOAD_SAME_BUFFER?(i[this._flushId]._buffer.update(n.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(n.rawBinaryData),i[this._flushId]._indexBuffer.update(s),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,i=this.renderer,n=i.gl,s=i.state,o=t._drawCallPool,a=null,h=0;h<e;h++){var u=o[h],l=u.texArray,f=u.type,d=u.size,c=u.start,p=u.blend;a!==l&&(a=l,this.bindAndClearTexArray(l)),this.state.blendMode=p,s.set(this.state),n.drawElements(f,d,n.UNSIGNED_SHORT,c*2)}},t.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),z.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),r.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var i=Vi(Math.ceil(e/8)),n=Gs(i),s=i*8;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var o=this._aBuffers[s];return o||(this._aBuffers[s]=o=new xp(s*this.vertexSize*4)),o},t.prototype.getIndexBuffer=function(e){var i=Vi(Math.ceil(e/12)),n=Gs(i),s=i*12;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var o=this._iBuffers[n];return o||(this._iBuffers[n]=o=new Uint16Array(s)),o},t.prototype.packInterleavedGeometry=function(e,i,n,s,o){for(var a=i.uint32View,h=i.float32View,u=s/this.vertexSize,l=e.uvs,f=e.indices,d=e.vertexData,c=e._texture.baseTexture._batchLocation,p=Math.min(e.worldAlpha,1),v=p<1&&e._texture.baseTexture.alphaMode?Rn(e._tintRGB,p):e._tintRGB+(p*255<<24),g=0;g<d.length;g+=2)h[s++]=d[g],h[s++]=d[g+1],h[s++]=l[g],h[s++]=l[g+1],a[s++]=v,h[s++]=c;for(var g=0;g<f.length;g++)n[o++]=u+f[g]},t._drawCallPool=[],t._textureArrayPool=[],t}(ua),Ep=function(){function r(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return r.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=ge.from({uSamplers:e},!0);var n=this.fragTemplate;n=n.replace(/%count%/gi,""+t),n=n.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new yi(this.vertexSrc,n)}var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new vt,default:this.defaultGroupCache[t]};return new mi(this.programCache[t],s)},r.prototype.generateSampleSrc=function(t){var e="";e+=`
`,e+=`
`;for(var i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+=`
{`,e+=`
	color = texture2D(uSamplers[`+i+"], vTextureCoord);",e+=`
}`;return e+=`
`,e+=`
`,e},r}(),ya=function(r){rt(t,r);function t(e){e===void 0&&(e=!1);var i=r.call(this)||this;return i._buffer=new xt(null,e,!1),i._indexBuffer=new xt(null,e,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,W.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,W.FLOAT).addAttribute("aColor",i._buffer,4,!0,W.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,W.FLOAT).addIndex(i._indexBuffer),i}return t}(gi),Zs=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,Qs=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Tp=function(){function r(){}return r.create=function(t){var e=Object.assign({vertex:Zs,fragment:Qs,geometryClass:ya,vertexSize:6},t),i=e.vertex,n=e.fragment,s=e.vertexSize,o=e.geometryClass;return function(a){rt(h,a);function h(u){var l=a.call(this,u)||this;return l.shaderGenerator=new Ep(i,n),l.geometryClass=o,l.vertexSize=s,l}return h}(wp)},Object.defineProperty(r,"defaultVertexSrc",{get:function(){return Zs},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentTemplate",{get:function(){return Qs},enumerable:!1,configurable:!0}),r}(),Ip=Tp.create();/*!
 * @pixi/display - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */z.SORTABLE_CHILDREN=!1;var Ge=function(){function r(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return r.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},r.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},r.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Y.EMPTY:(t=t||new Y(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},r.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},r.prototype.addPointMatrix=function(t,e){var i=t.a,n=t.b,s=t.c,o=t.d,a=t.tx,h=t.ty,u=i*e.x+s*e.y+a,l=n*e.x+o*e.y+h;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,l),this.maxY=Math.max(this.maxY,l)},r.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,s=this.maxY,o=t[0],a=t[1];e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=t[2],a=t[3],e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=t[4],a=t[5],e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,o=t[6],a=t[7],e=o<e?o:e,i=a<i?a:i,n=o>n?o:n,s=a>s?a:s,this.minX=e,this.minY=i,this.maxX=n,this.maxY=s},r.prototype.addFrame=function(t,e,i,n,s){this.addFrameMatrix(t.worldTransform,e,i,n,s)},r.prototype.addFrameMatrix=function(t,e,i,n,s){var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,f=t.ty,d=this.minX,c=this.minY,p=this.maxX,v=this.maxY,g=o*e+h*i+l,y=a*e+u*i+f;d=g<d?g:d,c=y<c?y:c,p=g>p?g:p,v=y>v?y:v,g=o*n+h*i+l,y=a*n+u*i+f,d=g<d?g:d,c=y<c?y:c,p=g>p?g:p,v=y>v?y:v,g=o*e+h*s+l,y=a*e+u*s+f,d=g<d?g:d,c=y<c?y:c,p=g>p?g:p,v=y>v?y:v,g=o*n+h*s+l,y=a*n+u*s+f,d=g<d?g:d,c=y<c?y:c,p=g>p?g:p,v=y>v?y:v,this.minX=d,this.minY=c,this.maxX=p,this.maxY=v},r.prototype.addVertexData=function(t,e,i){for(var n=this.minX,s=this.minY,o=this.maxX,a=this.maxY,h=e;h<i;h+=2){var u=t[h],l=t[h+1];n=u<n?u:n,s=l<s?l:s,o=u>o?u:o,a=l>a?l:a}this.minX=n,this.minY=s,this.maxX=o,this.maxY=a},r.prototype.addVertices=function(t,e,i,n){this.addVerticesMatrix(t.worldTransform,e,i,n)},r.prototype.addVerticesMatrix=function(t,e,i,n,s,o){s===void 0&&(s=0),o===void 0&&(o=s);for(var a=t.a,h=t.b,u=t.c,l=t.d,f=t.tx,d=t.ty,c=this.minX,p=this.minY,v=this.maxX,g=this.maxY,y=i;y<n;y+=2){var b=e[y],_=e[y+1],T=a*b+u*_+f,m=l*_+h*b+d;c=Math.min(c,T-s),v=Math.max(v,T+s),p=Math.min(p,m-o),g=Math.max(g,m+o)}this.minX=c,this.minY=p,this.maxX=v,this.maxY=g},r.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,s=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>s?t.maxY:s},r.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,s=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=s&&n<=o){var a=this.minX,h=this.minY,u=this.maxX,l=this.maxY;this.minX=i<a?i:a,this.minY=n<h?n:h,this.maxX=s>u?s:u,this.maxY=o>l?o:l}},r.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},r.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,s=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=s&&n<=o){var a=this.minX,h=this.minY,u=this.maxX,l=this.maxY;this.minX=i<a?i:a,this.minY=n<h?n:h,this.maxX=s>u?s:u,this.maxY=o>l?o:l}},r.prototype.pad=function(t,e){t===void 0&&(t=0),e===void 0&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},r.prototype.addFramePad=function(t,e,i,n,s,o){t-=s,e-=o,i+=s,n+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n},r}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var vn=function(r,t){return vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},vn(r,t)};function kn(r,t){vn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var He=function(r){kn(t,r);function t(){var e=r.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Kd,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Ge,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return t.mixin=function(e){for(var i=Object.keys(e),n=0;n<i.length;++n){var s=i[n];Object.defineProperty(t.prototype,s,Object.getOwnPropertyDescriptor(e,s))}},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,i){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new Y),i=this._boundsRect),this._bounds.getRectangle(i)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new Y),e=this._localBoundsRect),this._localBounds||(this._localBounds=new Ge);var i=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,e);return this.parent=n,this.transform=i,this._bounds=s,this._bounds.updateID+=this._boundsID-o,a},t.prototype.toGlobal=function(e,i,n){return n===void 0&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,i)},t.prototype.toLocal=function(e,i,n,s){return i&&(e=i.toGlobal(e,n,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,i,n,s,o,a,h,u,l){return e===void 0&&(e=0),i===void 0&&(i=0),n===void 0&&(n=1),s===void 0&&(s=1),o===void 0&&(o=0),a===void 0&&(a=0),h===void 0&&(h=0),u===void 0&&(u=0),l===void 0&&(l=0),this.position.x=e,this.position.y=i,this.scale.x=n||1,this.scale.y=s||1,this.rotation=o,this.skew.x=a,this.skew.y=h,this.pivot.x=u,this.pivot.y=l,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new ma),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*Vd},set:function(e){this.transform.rotation=e*Yd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!0,i.isMask=!1}if(this._mask=e,this._mask){var i=this._mask.maskObject||this._mask;i.renderable=!1,i.isMask=!0}},enumerable:!1,configurable:!0}),t}(vi),ma=function(r){kn(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.sortDirty=null,e}return t}(He);He.prototype.displayObjectUpdateTransform=He.prototype.updateTransform;function Ap(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}var dt=function(r){kn(t,r);function t(){var e=r.call(this)||this;return e.children=[],e.sortableChildren=z.SORTABLE_CHILDREN,e.sortDirty=!1,e}return t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,i=[],n=0;n<arguments.length;n++)i[n]=e[n];if(i.length>1)for(var s=0;s<i.length;s++)this.addChild(i[s]);else{var o=i[0];o.parent&&o.parent.removeChild(o),o.parent=this,this.sortDirty=!0,o.transform._parentID=-1,this.children.push(o),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",o,this,this.children.length-1),o.emit("added",this)}return i[0]},t.prototype.addChildAt=function(e,i){if(i<0||i>this.children.length)throw new Error(e+"addChildAt: The index "+i+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(i,0,e),this._boundsID++,this.onChildrenChange(i),e.emit("added",this),this.emit("childAdded",e,this,i),e},t.prototype.swapChildren=function(e,i){if(e!==i){var n=this.getChildIndex(e),s=this.getChildIndex(i);this.children[n]=i,this.children[s]=e,this.onChildrenChange(n<s?n:s)}},t.prototype.getChildIndex=function(e){var i=this.children.indexOf(e);if(i===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return i},t.prototype.setChildIndex=function(e,i){if(i<0||i>=this.children.length)throw new Error("The index "+i+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(e);ri(this.children,n,1),this.children.splice(i,0,e),this.onChildrenChange(i)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,i=[],n=0;n<arguments.length;n++)i[n]=e[n];if(i.length>1)for(var s=0;s<i.length;s++)this.removeChild(i[s]);else{var o=i[0],a=this.children.indexOf(o);if(a===-1)return null;o.parent=null,o.transform._parentID=-1,ri(this.children,a,1),this._boundsID++,this.onChildrenChange(a),o.emit("removed",this),this.emit("childRemoved",o,this,a)}return i[0]},t.prototype.removeChildAt=function(e){var i=this.getChildAt(e);return i.parent=null,i.transform._parentID=-1,ri(this.children,e,1),this._boundsID++,this.onChildrenChange(e),i.emit("removed",this),this.emit("childRemoved",i,this,e),i},t.prototype.removeChildren=function(e,i){e===void 0&&(e=0),i===void 0&&(i=this.children.length);var n=e,s=i,o=s-n,a;if(o>0&&o<=s){a=this.children.splice(n,o);for(var h=0;h<a.length;++h)a[h].parent=null,a[h].transform&&(a[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var h=0;h<a.length;++h)a[h].emit("removed",this),this.emit("childRemoved",a[h],this,h);return a}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,i=0,n=this.children.length;i<n;++i){var s=this.children[i];s._lastSortedIndex=i,!e&&s.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(Ap),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,i=this.children.length;e<i;++e){var n=this.children[e];n.visible&&n.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var i=this.children[e];if(!(!i.visible||!i.renderable))if(i.calculateBounds(),i._mask){var n=i._mask.maskObject||i._mask;n.calculateBounds(),this._bounds.addBoundsMask(i._bounds,n._bounds)}else i.filterArea?this._bounds.addBoundsArea(i._bounds,i.filterArea):this._bounds.addBounds(i._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,i){i===void 0&&(i=!1);var n=r.prototype.getLocalBounds.call(this,e);if(!i)for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s];a.visible&&a.updateTransform()}return n},t.prototype._calculateBounds=function(){},t.prototype.render=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var i=0,n=this.children.length;i<n;++i)this.children[i].render(e)}},t.prototype.renderAdvanced=function(e){e.batch.flush();var i=this.filters,n=this._mask;if(i){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var s=0;s<i.length;s++)i[s].enabled&&this._enabledFilters.push(i[s]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}n&&e.mask.push(this,this._mask),this._render(e);for(var s=0,o=this.children.length;s<o;s++)this.children[s].render(e);e.batch.flush(),n&&e.mask.pop(this),i&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(e){r.prototype.destroy.call(this),this.sortDirty=!1;var i=typeof e=="boolean"?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(i)for(var s=0;s<n.length;++s)n[s].destroy(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var i=this.getLocalBounds().width;i!==0?this.scale.x=e/i:this.scale.x=1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var i=this.getLocalBounds().height;i!==0?this.scale.y=e/i:this.scale.y=1,this._height=e},enumerable:!1,configurable:!0}),t}(He);dt.prototype.containerUpdateTransform=dt.prototype.updateTransform;/*!
 * @pixi/sprite - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var gn=function(r,t){return gn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},gn(r,t)};function Op(r,t){gn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Je=new V,Sp=new Uint16Array([0,1,2,0,2,3]),ye=function(r){Op(t,r);function t(e){var i=r.call(this)||this;return i._anchor=new Le(i._onAnchorUpdate,i,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),i._texture=null,i._width=0,i._height=0,i._tint=null,i._tintRGB=null,i.tint=16777215,i.blendMode=G.NORMAL,i._cachedTint=16777215,i.uvs=null,i.texture=e||Z.EMPTY,i.vertexData=new Float32Array(8),i.vertexTrimmedData=null,i._transformID=-1,i._textureID=-1,i._transformTrimmedID=-1,i._textureTrimmedID=-1,i.indices=Sp,i.pluginName="batch",i.isSprite=!0,i._roundPixels=z.ROUND_PIXELS,i}return t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Pe(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Pe(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===e._updateID)){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var i=this.transform.worldTransform,n=i.a,s=i.b,o=i.c,a=i.d,h=i.tx,u=i.ty,l=this.vertexData,f=e.trim,d=e.orig,c=this._anchor,p=0,v=0,g=0,y=0;if(f?(v=f.x-c._x*d.width,p=v+f.width,y=f.y-c._y*d.height,g=y+f.height):(v=-c._x*d.width,p=v+d.width,y=-c._y*d.height,g=y+d.height),l[0]=n*v+o*y+h,l[1]=a*y+s*v+u,l[2]=n*p+o*y+h,l[3]=a*y+s*p+u,l[4]=n*p+o*g+h,l[5]=a*g+s*p+u,l[6]=n*v+o*g+h,l[7]=a*g+s*v+u,this._roundPixels)for(var b=z.RESOLUTION,_=0;_<l.length;++_)l[_]=Math.round((l[_]*b|0)/b)}},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,i=this.vertexTrimmedData,n=e.orig,s=this._anchor,o=this.transform.worldTransform,a=o.a,h=o.b,u=o.c,l=o.d,f=o.tx,d=o.ty,c=-s._x*n.width,p=c+n.width,v=-s._y*n.height,g=v+n.height;i[0]=a*c+u*v+f,i[1]=l*v+h*c+d,i[2]=a*p+u*v+f,i[3]=l*v+h*p+d,i[4]=a*p+u*g+f,i[5]=l*g+h*p+d,i[6]=a*c+u*g+f,i[7]=l*g+h*c+d},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,i=this._texture.orig;!e||e.width===i.width&&e.height===i.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Y),e=this._localBoundsRect),this._bounds.getRectangle(e)):r.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Je);var i=this._texture.orig.width,n=this._texture.orig.height,s=-i*this.anchor.x,o=0;return Je.x>=s&&Je.x<s+i&&(o=-n*this.anchor.y,Je.y>=o&&Je.y<o+n)},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var i=typeof e=="boolean"?e:e&&e.texture;if(i){var n=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},t.from=function(e,i){var n=e instanceof Z?e:Z.from(e,i);return new t(n)},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var i=Pe(this.scale.x)||1;this.scale.x=i*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var i=Pe(this.scale.y)||1;this.scale.y=i*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||Z.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(dt);/*!
 * @pixi/text - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var yn=function(r,t){return yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},yn(r,t)};function Np(r,t){yn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var di;(function(r){r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(di||(di={}));var Ur={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:di.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Cp=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Ki=function(){function r(t){this.styleID=0,this.reset(),Dr(this,t,t)}return r.prototype.clone=function(){var t={};return Dr(t,this,Ur),new r(t)},r.prototype.reset=function(){Dr(this,Ur,Ur)},Object.defineProperty(r.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Fr(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Fr(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){Pp(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Fr(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),r.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var n=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&Cp.indexOf(n)<0&&(n='"'+n+'"'),e[i]=n}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},r}();function to(r){return typeof r=="number"?Jo(r):(typeof r=="string"&&r.indexOf("0x")===0&&(r=r.replace("0x","#")),r)}function Fr(r){if(Array.isArray(r)){for(var t=0;t<r.length;++t)r[t]=to(r[t]);return r}else return to(r)}function Pp(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(var e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function Dr(r,t,e){for(var i in e)Array.isArray(t[i])?r[i]=t[i].slice():r[i]=t[i]}var Dt=function(){function r(t,e,i,n,s,o,a,h,u){this.text=t,this.style=e,this.width=i,this.height=n,this.lines=s,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=u}return r.measureText=function(t,e,i,n){n===void 0&&(n=r._canvas),i=i??e.wordWrap;var s=e.toFontString(),o=r.measureFont(s);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);var a=n.getContext("2d");a.font=s;for(var h=i?r.wordWrap(t,e,n):t,u=h.split(/(?:\r\n|\r|\n)/),l=new Array(u.length),f=0,d=0;d<u.length;d++){var c=a.measureText(u[d]).width+(u[d].length-1)*e.letterSpacing;l[d]=c,f=Math.max(f,c)}var p=f+e.strokeThickness;e.dropShadow&&(p+=e.dropShadowDistance);var v=e.lineHeight||o.fontSize+e.strokeThickness,g=Math.max(v,o.fontSize+e.strokeThickness)+(u.length-1)*(v+e.leading);return e.dropShadow&&(g+=e.dropShadowDistance),new r(t,e,p,g,u,l,v+e.leading,f,o)},r.wordWrap=function(t,e,i){i===void 0&&(i=r._canvas);for(var n=i.getContext("2d"),s=0,o="",a="",h=Object.create(null),u=e.letterSpacing,l=e.whiteSpace,f=r.collapseSpaces(l),d=r.collapseNewlines(l),c=!f,p=e.wordWrapWidth+u,v=r.tokenize(t),g=0;g<v.length;g++){var y=v[g];if(r.isNewline(y)){if(!d){a+=r.addLine(o),c=!f,o="",s=0;continue}y=" "}if(f){var b=r.isBreakingSpace(y),_=r.isBreakingSpace(o[o.length-1]);if(b&&_)continue}var T=r.getFromCache(y,u,h,n);if(T>p)if(o!==""&&(a+=r.addLine(o),o="",s=0),r.canBreakWords(y,e.breakWords))for(var m=r.wordWrapSplit(y),x=0;x<m.length;x++){for(var A=m[x],S=1;m[x+S];){var I=m[x+S],E=A[A.length-1];if(!r.canBreakChars(E,I,y,x,e.breakWords))A+=I;else break;S++}x+=A.length-1;var k=r.getFromCache(A,u,h,n);k+s>p&&(a+=r.addLine(o),c=!1,o="",s=0),o+=A,s+=k}else{o.length>0&&(a+=r.addLine(o),o="",s=0);var w=g===v.length-1;a+=r.addLine(y,!w),c=!1,o="",s=0}else T+s>p&&(c=!1,a+=r.addLine(o),o="",s=0),(o.length>0||!r.isBreakingSpace(y)||c)&&(o+=y,s+=T)}return a+=r.addLine(o,!1),a},r.addLine=function(t,e){return e===void 0&&(e=!0),t=r.trimRight(t),t=e?t+`
`:t,t},r.getFromCache=function(t,e,i,n){var s=i[t];if(typeof s!="number"){var o=t.length*e;s=n.measureText(t).width+o,i[t]=s}return s},r.collapseSpaces=function(t){return t==="normal"||t==="pre-line"},r.collapseNewlines=function(t){return t==="normal"},r.trimRight=function(t){if(typeof t!="string")return"";for(var e=t.length-1;e>=0;e--){var i=t[e];if(!r.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},r.isNewline=function(t){return typeof t!="string"?!1:r._newlines.indexOf(t.charCodeAt(0))>=0},r.isBreakingSpace=function(t,e){return typeof t!="string"?!1:r._breakingSpaces.indexOf(t.charCodeAt(0))>=0},r.tokenize=function(t){var e=[],i="";if(typeof t!="string")return e;for(var n=0;n<t.length;n++){var s=t[n],o=t[n+1];if(r.isBreakingSpace(s,o)||r.isNewline(s)){i!==""&&(e.push(i),i=""),e.push(s);continue}i+=s}return i!==""&&e.push(i),e},r.canBreakWords=function(t,e){return e},r.canBreakChars=function(t,e,i,n,s){return!0},r.wordWrapSplit=function(t){return t.split("")},r.measureFont=function(t){if(r._fonts[t])return r._fonts[t];var e={ascent:0,descent:0,fontSize:0},i=r._canvas,n=r._context;n.font=t;var s=r.METRICS_STRING+r.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width),a=Math.ceil(n.measureText(r.BASELINE_SYMBOL).width),h=Math.ceil(r.HEIGHT_MULTIPLIER*a);a=a*r.BASELINE_MULTIPLIER|0,i.width=o,i.height=h,n.fillStyle="#f00",n.fillRect(0,0,o,h),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);var u=n.getImageData(0,0,o,h).data,l=u.length,f=o*4,d=0,c=0,p=!1;for(d=0;d<a;++d){for(var v=0;v<f;v+=4)if(u[c+v]!==255){p=!0;break}if(!p)c+=f;else break}for(e.ascent=a-d,c=l-f,p=!1,d=h;d>a;--d){for(var v=0;v<f;v+=4)if(u[c+v]!==255){p=!0;break}if(!p)c-=f;else break}return e.descent=d-a,e.fontSize=e.ascent+e.descent,r._fonts[t]=e,e},r.clearMetrics=function(t){t===void 0&&(t=""),t?delete r._fonts[t]:r._fonts={}},r}(),Ji=function(){try{var r=new OffscreenCanvas(0,0),t=r.getContext("2d");return t&&t.measureText?r:document.createElement("canvas")}catch{return document.createElement("canvas")}}();Ji.width=Ji.height=10;Dt._canvas=Ji;Dt._context=Ji.getContext("2d");Dt._fonts={};Dt.METRICS_STRING="|q";Dt.BASELINE_SYMBOL="M";Dt.BASELINE_MULTIPLIER=1.4;Dt.HEIGHT_MULTIPLIER=2;Dt._newlines=[10,13];Dt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Lp={texture:!0,children:!1,baseTexture:!0},Rp=function(r){Np(t,r);function t(e,i,n){var s=this,o=!1;n||(n=document.createElement("canvas"),o=!0),n.width=3,n.height=3;var a=Z.from(n);return a.orig=new Y,a.trim=new Y,s=r.call(this,a)||this,s._ownCanvas=o,s.canvas=n,s.context=s.canvas.getContext("2d"),s._resolution=z.RESOLUTION,s._autoResolution=!0,s._text=null,s._style=null,s._styleListener=null,s._font="",s.text=e,s.style=i,s.localStyleID=-1,s}return t.prototype.updateText=function(e){var i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),!(!this.dirty&&e)){this._font=this._style.toFontString();var n=this.context,s=Dt.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,h=s.lines,u=s.lineHeight,l=s.lineWidths,f=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+i.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+i.padding*2)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=i.strokeThickness,n.textBaseline=i.textBaseline,n.lineJoin=i.lineJoin,n.miterLimit=i.miterLimit;for(var c,p,v=i.dropShadow?2:1,g=0;g<v;++g){var y=i.dropShadow&&g===0,b=y?Math.ceil(Math.max(1,a)+i.padding*2):0,_=b*this._resolution;if(y){n.fillStyle="black",n.strokeStyle="black";var T=i.dropShadowColor,m=xe(typeof T=="number"?T:Zo(T));n.shadowColor="rgba("+m[0]*255+","+m[1]*255+","+m[2]*255+","+i.dropShadowAlpha+")",n.shadowBlur=i.dropShadowBlur,n.shadowOffsetX=Math.cos(i.dropShadowAngle)*i.dropShadowDistance,n.shadowOffsetY=Math.sin(i.dropShadowAngle)*i.dropShadowDistance+_}else n.fillStyle=this._generateFillStyle(i,h,s),n.strokeStyle=i.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;var x=(u-d.fontSize)/2;(!t.nextLineHeightBehavior||u-d.fontSize<0)&&(x=0);for(var A=0;A<h.length;A++)c=i.strokeThickness/2,p=i.strokeThickness/2+A*u+d.ascent+x,i.align==="right"?c+=f-l[A]:i.align==="center"&&(c+=(f-l[A])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(h[A],c+i.padding,p+i.padding-b,!0),i.fill&&this.drawLetterSpacing(h[A],c+i.padding,p+i.padding-b)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,i,n,s){s===void 0&&(s=!1);var o=this._style,a=o.letterSpacing;if(a===0){s?this.context.strokeText(e,i,n):this.context.fillText(e,i,n);return}for(var h=i,u=Array.from?Array.from(e):e.split(""),l=this.context.measureText(e).width,f=0,d=0;d<u.length;++d){var c=u[d];s?this.context.strokeText(c,h,n):this.context.fillText(c,h,n),f=this.context.measureText(e.substring(d+1)).width,h+=l-f+a,l=f}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var i=jd(e);i.data&&(e.width=i.width,e.height=i.height,this.context.putImageData(i.data,0,0))}var n=this._texture,s=this._style,o=s.trim?0:s.padding,a=n.baseTexture;n.trim.width=n._frame.width=e.width/this._resolution,n.trim.height=n._frame.height=e.height/this._resolution,n.trim.x=-o,n.trim.y=-o,n.orig.width=n._frame.width-o*2,n.orig.height=n._frame.height-o*2,this._onTextureUpdate(),a.setRealSize(e.width,e.height,this._resolution),n.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),r.prototype._render.call(this,e)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),r.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,i,n){var s=e.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;var o,a=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,u=this.canvas.width/this._resolution-a-h*2,l=this.canvas.height/this._resolution-a-h*2,f=s.slice(),d=e.fillGradientStops.slice();if(!d.length)for(var c=f.length+1,p=1;p<c;++p)d.push(p/c);if(f.unshift(s[0]),d.unshift(0),f.push(s[s.length-1]),d.push(1),e.fillGradientType===di.LINEAR_VERTICAL){o=this.context.createLinearGradient(u/2,h,u/2,l+h);for(var v=n.fontProperties.fontSize+e.strokeThickness,p=0;p<i.length;p++){var g=n.lineHeight*(p-1)+v,y=n.lineHeight*p,b=y;p>0&&g>y&&(b=(y+g)/2);var _=y+v,T=n.lineHeight*(p+1),m=_;p+1<i.length&&T<_&&(m=(_+T)/2);for(var x=(m-b)/l,A=0;A<f.length;A++){var S=0;typeof d[A]=="number"?S=d[A]:S=A/f.length;var I=Math.min(1,Math.max(0,b/l+S*x));I=Number(I.toFixed(5)),o.addColorStop(I,f[A])}}}else{o=this.context.createLinearGradient(h,l/2,u+h,l/2);for(var E=f.length+1,k=1,p=0;p<f.length;p++){var w=void 0;typeof d[p]=="number"?w=d[p]:w=k/E,o.addColorStop(w,f[p]),k++}}return o},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},Lp,e),r.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var i=Pe(this.scale.x)||1;this.scale.x=i*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var i=Pe(this.scale.y)||1;this.scale.y=i*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},e instanceof Ki?this._style=e:this._style=new Ki(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t}(ye);/*!
 * @pixi/mesh - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/mesh is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var mn=function(r,t){return mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},mn(r,t)};function Bn(r,t){mn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Mp=function(){function r(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return r.prototype.update=function(t){if(!(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},r}(),kr=new V,eo=new te,io=function(r){Bn(t,r);function t(e,i,n,s){s===void 0&&(s=Lt.TRIANGLES);var o=r.call(this)||this;return o.geometry=e,e.refCount++,o.shader=i,o.state=n||$e.for2d(),o.drawMode=s,o.start=0,o.size=0,o.uvs=null,o.indices=null,o.vertexData=new Float32Array(1),o.vertexDirty=-1,o._transformID=-1,o._roundPixels=z.ROUND_PIXELS,o.batchUvs=null,o}return Object.defineProperty(t.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this.shader},set:function(e){this.shader=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(e){this.shader.tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(e){this.shader.texture=e},enumerable:!1,configurable:!0}),t.prototype._render=function(e){var i=this.geometry.buffers[0].data,n=this.shader;n.batchable&&this.drawMode===Lt.TRIANGLES&&i.length<t.BATCHABLE_SIZE*2?this._renderToBatch(e):this._renderDefault(e)},t.prototype._renderDefault=function(e){var i=this.shader;i.alpha=this.worldAlpha,i.update&&i.update(),e.batch.flush(),i.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(i),e.state.set(this.state),e.geometry.bind(this.geometry,i),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},t.prototype._renderToBatch=function(e){var i=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=i.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var s=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[s]),e.plugins[s].render(this)},t.prototype.calculateVertices=function(){var e=this.geometry,i=e.buffers[0],n=i.data,s=i._updateID;if(!(s===this.vertexDirty&&this._transformID===this.transform._worldID)){this._transformID=this.transform._worldID,this.vertexData.length!==n.length&&(this.vertexData=new Float32Array(n.length));for(var o=this.transform.worldTransform,a=o.a,h=o.b,u=o.c,l=o.d,f=o.tx,d=o.ty,c=this.vertexData,p=0;p<c.length/2;p++){var v=n[p*2],g=n[p*2+1];c[p*2]=a*v+u*g+f,c[p*2+1]=h*v+l*g+d}if(this._roundPixels)for(var y=z.RESOLUTION,p=0;p<c.length;++p)c[p]=Math.round((c[p]*y|0)/y);this.vertexDirty=s}},t.prototype.calculateUvs=function(){var e=this.geometry.buffers[1],i=this.shader;i.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new Mp(e,i.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},t.prototype.containsPoint=function(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,kr);for(var i=this.geometry.getBuffer("aVertexPosition").data,n=eo.points,s=this.geometry.getIndex().data,o=s.length,a=this.drawMode===4?3:1,h=0;h+2<o;h+=a){var u=s[h]*2,l=s[h+1]*2,f=s[h+2]*2;if(n[0]=i[u],n[1]=i[u+1],n[2]=i[l],n[3]=i[l+1],n[4]=i[f],n[5]=i[f+1],eo.contains(kr.x,kr.y))return!0}return!1},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this.geometry.refCount--,this.geometry.refCount===0&&this.geometry.dispose(),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},t.BATCHABLE_SIZE=100,t}(dt),Up=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,Fp=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`,Dp=function(r){Bn(t,r);function t(e,i){var n=this,s={uSampler:e,alpha:1,uTextureMatrix:vt.IDENTITY,uColor:new Float32Array([1,1,1,1])};return i=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},i),i.uniforms&&Object.assign(s,i.uniforms),n=r.call(this,i.program||yi.from(Fp,Up),s)||this,n._colorDirty=!1,n.uvMatrix=new pa(e),n.batchable=i.program===void 0,n.pluginName=i.pluginName,n.tint=i.tint,n.alpha=i.alpha,n}return Object.defineProperty(t.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(e){this.uniforms.uSampler!==e&&(this.uniforms.uSampler=e,this.uvMatrix.texture=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){e!==this._alpha&&(this._alpha=e,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var e=this.texture.baseTexture;Xd(this._tint,this._alpha,this.uniforms.uColor,e.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},t}(mi),kp=function(r){Bn(t,r);function t(e,i,n){var s=r.call(this)||this,o=new xt(e),a=new xt(i,!0),h=new xt(n,!0,!0);return s.addAttribute("aVertexPosition",o,2,!1,W.FLOAT).addAttribute("aTextureCoord",a,2,!1,W.FLOAT).addIndex(h),s._updateId=-1,s}return Object.defineProperty(t.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),t}(gi);/*!
 * @pixi/loaders - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ci=function(){function r(t,e,i){e===void 0&&(e=!1),this._fn=t,this._once=e,this._thisArg=i,this._next=this._prev=this._owner=null}return r.prototype.detach=function(){return this._owner===null?!1:(this._owner.detach(this),!0)},r}();function ro(r,t){return r._head?(r._tail._next=t,t._prev=r._tail,r._tail=t):(r._head=t,r._tail=t),t._owner=r,t}var Vt=function(){function r(){this._head=this._tail=void 0}return r.prototype.handlers=function(t){t===void 0&&(t=!1);var e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i},r.prototype.has=function(t){if(!(t instanceof Ci))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},r.prototype.dispatch=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];var n=this._head;if(!n)return!1;for(;n;)n._once&&this.detach(n),n._fn.apply(n._thisArg,e),n=n._next;return!0},r.prototype.add=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return ro(this,new Ci(t,!1,e))},r.prototype.once=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return ro(this,new Ci(t,!0,e))},r.prototype.detach=function(t){if(!(t instanceof Ci))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)},r.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},r}();function _a(r,t){t=t||{};for(var e={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=e.parser[t.strictMode?"strict":"loose"].exec(r),n={},s=14;s--;)n[e.key[s]]=i[s]||"";return n[e.q.name]={},n[e.key[12]].replace(e.q.parser,function(o,a,h){a&&(n[e.q.name][a]=h)}),n}var Bp=!!(self.XDomainRequest&&!("withCredentials"in new XMLHttpRequest)),Pi=null,Gp=0,no=200,Hp=204,Xp=1223,zp=2;function so(){}function oo(r,t,e){t&&t.indexOf(".")===0&&(t=t.substring(1)),t&&(r[t]=e)}function Br(r){return r.toString().replace("object ","")}var At=function(){function r(t,e,i){if(this._dequeue=so,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof t!="string"||typeof e!="string")throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(r.STATUS_FLAGS.DATA_URL,e.indexOf("data:")===0),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=i.crossOrigin===!0?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=r.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=so,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Vt,this.onProgress=new Vt,this.onComplete=new Vt,this.onAfterMiddleware=new Vt}return r.setExtensionLoadType=function(t,e){oo(r._loadTypeMap,t,e)},r.setExtensionXhrType=function(t,e){oo(r._xhrTypeMap,t,e)},Object.defineProperty(r.prototype,"isDataUrl",{get:function(){return this._hasFlag(r.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isComplete",{get:function(){return this._hasFlag(r.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLoading",{get:function(){return this._hasFlag(r.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),r.prototype.complete=function(){this._clearEvents(),this._finish()},r.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=r.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},r.prototype.load=function(t){var e=this;if(!this.isLoading){if(this.isComplete){t&&setTimeout(function(){return t(e)},1);return}else t&&this.onComplete.once(t);switch(this._setFlag(r.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this.type=r.TYPE.IMAGE,this._loadElement("image");break;case r.LOAD_TYPE.AUDIO:this.type=r.TYPE.AUDIO,this._loadSourceElement("audio");break;case r.LOAD_TYPE.VIDEO:this.type=r.TYPE.VIDEO,this._loadSourceElement("video");break;case r.LOAD_TYPE.XHR:default:Bp&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},r.prototype._hasFlag=function(t){return(this._flags&t)!==0},r.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},r.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},r.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(r.STATUS_FLAGS.COMPLETE,!0),this._setFlag(r.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},r.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&typeof self.Image<"u"?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&typeof self.Audio<"u"?this.data=new Audio:this.data=document.createElement(t),this.data===null){this.abort("Unsupported element: "+t);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=r.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},r.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new self.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},r.prototype._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var n=document.createElement("source");return n.src=e,n.type=i,n},r.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},r.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},r.prototype._onTimeout=function(){this.abort("Load timed out.")},r.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Br(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},r.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Br(t)+" Request timed out.")},r.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Br(t)+" Request was aborted by the user.")},r.prototype._xhrOnLoad=function(){var t=this.xhr,e="",i=typeof t.status>"u"?no:t.status;(t.responseType===""||t.responseType==="text"||typeof t.responseType>"u")&&(e=t.responseText),i===Gp&&(e.length>0||t.responseType===r.XHR_RESPONSE_TYPE.BUFFER)?i=no:i===Xp&&(i=Hp);var n=i/100|0;if(n===zp)if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=r.TYPE.TEXT;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=r.TYPE.JSON}catch(a){this.abort("Error trying to parse loaded json: "+a);return}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(self.DOMParser){var s=new DOMParser;this.data=s.parseFromString(e,"text/xml")}else{var o=document.createElement("div");o.innerHTML=e,this.data=o}this.type=r.TYPE.XML}catch(a){this.abort("Error trying to parse loaded xml: "+a);return}else this.data=t.response||e;else{this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL);return}this.complete()},r.prototype._determineCrossOrigin=function(t,e){if(t.indexOf("data:")===0)return"";if(self.origin!==self.location.origin)return"anonymous";e=e||self.location,Pi||(Pi=document.createElement("a")),Pi.href=t;var i=_a(Pi.href,{strictMode:!0}),n=!i.port&&e.port===""||i.port===e.port,s=i.protocol?i.protocol+":":"";return i.host!==e.hostname||!n||s!==e.protocol?"anonymous":""},r.prototype._determineXhrType=function(){return r._xhrTypeMap[this.extension]||r.XHR_RESPONSE_TYPE.TEXT},r.prototype._determineLoadType=function(){return r._loadTypeMap[this.extension]||r.LOAD_TYPE.XHR},r.prototype._getExtension=function(t){t===void 0&&(t=this.url);var e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var n=t.indexOf("?"),s=t.indexOf("#"),o=Math.min(n>-1?n:t.length,s>-1?s:t.length);t=t.substring(0,o),e=t.substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},r.prototype._getMimeFromXhrType=function(t){switch(t){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r}();(function(r){(function(t){t[t.NONE=0]="NONE",t[t.DATA_URL=1]="DATA_URL",t[t.COMPLETE=2]="COMPLETE",t[t.LOADING=4]="LOADING"})(r.STATUS_FLAGS||(r.STATUS_FLAGS={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JSON=1]="JSON",t[t.XML=2]="XML",t[t.IMAGE=3]="IMAGE",t[t.AUDIO=4]="AUDIO",t[t.VIDEO=5]="VIDEO",t[t.TEXT=6]="TEXT"}(r.TYPE||(r.TYPE={})),function(t){t[t.XHR=1]="XHR",t[t.IMAGE=2]="IMAGE",t[t.AUDIO=3]="AUDIO",t[t.VIDEO=4]="VIDEO"}(r.LOAD_TYPE||(r.LOAD_TYPE={})),function(t){t.DEFAULT="text",t.BUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(r.XHR_RESPONSE_TYPE||(r.XHR_RESPONSE_TYPE={})),r._loadTypeMap={gif:r.LOAD_TYPE.IMAGE,png:r.LOAD_TYPE.IMAGE,bmp:r.LOAD_TYPE.IMAGE,jpg:r.LOAD_TYPE.IMAGE,jpeg:r.LOAD_TYPE.IMAGE,tif:r.LOAD_TYPE.IMAGE,tiff:r.LOAD_TYPE.IMAGE,webp:r.LOAD_TYPE.IMAGE,tga:r.LOAD_TYPE.IMAGE,svg:r.LOAD_TYPE.IMAGE,"svg+xml":r.LOAD_TYPE.IMAGE,mp3:r.LOAD_TYPE.AUDIO,ogg:r.LOAD_TYPE.AUDIO,wav:r.LOAD_TYPE.AUDIO,mp4:r.LOAD_TYPE.VIDEO,webm:r.LOAD_TYPE.VIDEO},r._xhrTypeMap={xhtml:r.XHR_RESPONSE_TYPE.DOCUMENT,html:r.XHR_RESPONSE_TYPE.DOCUMENT,htm:r.XHR_RESPONSE_TYPE.DOCUMENT,xml:r.XHR_RESPONSE_TYPE.DOCUMENT,tmx:r.XHR_RESPONSE_TYPE.DOCUMENT,svg:r.XHR_RESPONSE_TYPE.DOCUMENT,tsx:r.XHR_RESPONSE_TYPE.DOCUMENT,gif:r.XHR_RESPONSE_TYPE.BLOB,png:r.XHR_RESPONSE_TYPE.BLOB,bmp:r.XHR_RESPONSE_TYPE.BLOB,jpg:r.XHR_RESPONSE_TYPE.BLOB,jpeg:r.XHR_RESPONSE_TYPE.BLOB,tif:r.XHR_RESPONSE_TYPE.BLOB,tiff:r.XHR_RESPONSE_TYPE.BLOB,webp:r.XHR_RESPONSE_TYPE.BLOB,tga:r.XHR_RESPONSE_TYPE.BLOB,json:r.XHR_RESPONSE_TYPE.JSON,text:r.XHR_RESPONSE_TYPE.TEXT,txt:r.XHR_RESPONSE_TYPE.TEXT,ttf:r.XHR_RESPONSE_TYPE.BUFFER,otf:r.XHR_RESPONSE_TYPE.BUFFER},r.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(At||(At={}));function oe(){}function jp(r){return function(){for(var e=arguments,i=[],n=0;n<arguments.length;n++)i[n]=e[n];if(r===null)throw new Error("Callback was already called.");var s=r;r=null,s.apply(this,i)}}var Wp=function(){function r(t,e){this.data=t,this.callback=e}return r}(),Gr=function(){function r(t,e){var i=this;if(e===void 0&&(e=1),this.workers=0,this.saturated=oe,this.unsaturated=oe,this.empty=oe,this.drain=oe,this.error=oe,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(n,s,o){if(o&&typeof o!="function")throw new Error("task callback must be a function");if(i.started=!0,n==null&&i.idle()){setTimeout(function(){return i.drain()},1);return}var a=new Wp(n,typeof o=="function"?o:oe);s?i._tasks.unshift(a):i._tasks.push(a),setTimeout(i.process,1)},this.process=function(){for(;!i.paused&&i.workers<i.concurrency&&i._tasks.length;){var n=i._tasks.shift();i._tasks.length===0&&i.empty(),i.workers+=1,i.workers===i.concurrency&&i.saturated(),i._worker(n.data,jp(i._next(n)))}},this._worker=t,e===0)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return r.prototype._next=function(t){var e=this;return function(){for(var i=arguments,n=[],s=0;s<arguments.length;s++)n[s]=i[s];e.workers-=1,t.callback.apply(t,n),n[0]!=null&&e.error(n[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},r.prototype.push=function(t,e){this._insert(t,!1,e)},r.prototype.kill=function(){this.workers=0,this.drain=oe,this.started=!1,this._tasks=[]},r.prototype.unshift=function(t,e){this._insert(t,!0,e)},r.prototype.length=function(){return this._tasks.length},r.prototype.running=function(){return this.workers},r.prototype.idle=function(){return this._tasks.length+this.workers===0},r.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},r.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},r.eachSeries=function(t,e,i,n){var s=0,o=t.length;function a(h){if(h||s===o){i&&i(h);return}n?setTimeout(function(){e(t[s++],a)},1):e(t[s++],a)}a()},r.queue=function(t,e){return new r(t,e)},r}(),Hr=100,$p=/(#[\w-]+)?$/,Xe=function(){function r(t,e){var i=this;t===void 0&&(t=""),e===void 0&&(e=10),this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(h,u){return i._loadResource(h,u)},this.resources={},this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(h,u){return i._loadResource(h,u)},this._queue=Gr.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new Vt,this.onError=new Vt,this.onLoad=new Vt,this.onStart=new Vt,this.onComplete=new Vt;for(var n=0;n<r._plugins.length;++n){var s=r._plugins[n],o=s.pre,a=s.use;o&&this.pre(o),a&&this.use(a)}this._protected=!1}return r.prototype._add=function(t,e,i,n){if(this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new At(t,e,i),typeof n=="function"&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var s=i.parentResource,o=[],a=0;a<s.children.length;++a)s.children[a].isComplete||o.push(s.children[a]);var h=s.progressChunk*(o.length+1),u=h/(o.length+2);s.children.push(this.resources[t]),s.progressChunk=u;for(var a=0;a<o.length;++a)o[a].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},r.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},r.prototype.use=function(t){return this._afterMiddleware.push(t),this},r.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var t in this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},r.prototype.load=function(t){if(typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=this._queue._tasks.length,i=Hr/e,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=i;this._onStart(),this._queue.resume()}return this},Object.defineProperty(r.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),r.prototype._prepareUrl=function(t){var e=_a(t,{strictMode:!0}),i;if(e.protocol||!e.path||t.indexOf("//")===0?i=t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?i=this.baseUrl+"/"+t:i=this.baseUrl+t,this.defaultQueryString){var n=$p.exec(i)[0];i=i.substr(0,i.length-n.length),i.indexOf("?")!==-1?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=n}return i},r.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,Gr.eachSeries(this._beforeMiddleware,function(n,s){n.call(i,t,function(){s(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())},!0)},r.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},r.prototype._onComplete=function(){this.progress=Hr,this.loading=!1,this.onComplete.dispatch(this,this.resources)},r.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Gr.eachSeries(this._afterMiddleware,function(i,n){i.call(e,t,n)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(Hr,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},r.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(r,"shared",{get:function(){var t=r._shared;return t||(t=new r,t._protected=!0,r._shared=t),t},enumerable:!1,configurable:!0}),r.registerPlugin=function(t){return r._plugins.push(t),t.add&&t.add(),r},r._plugins=[],r}();Xe.prototype.add=function(t,e,i,n){if(Array.isArray(t)){for(var s=0;s<t.length;++s)this.add(t[s]);return this}if(typeof t=="object"&&(i=t,n=e||i.callback||i.onComplete,e=i.url,t=i.name||i.key||i.url),typeof e!="string"&&(n=i,i=e,e=t),typeof e!="string")throw new Error("No url passed to add resource to loader.");return typeof i=="function"&&(n=i,i=null),this._add(t,e,i,n)};var Vp=function(){function r(){}return r.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Xe.shared:new Xe},r.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},r}(),Yp=function(){function r(){}return r.add=function(){At.setExtensionLoadType("svg",At.LOAD_TYPE.XHR),At.setExtensionXhrType("svg",At.XHR_RESPONSE_TYPE.TEXT)},r.use=function(t,e){if(t.data&&(t.type===At.TYPE.IMAGE||t.extension==="svg")){var i=t.data,n=t.url,s=t.name,o=t.metadata;Z.fromLoader(i,n,s,o).then(function(a){t.texture=a,e()}).catch(e)}else e()},r}(),qp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Kp(r){for(var t="",e=0;e<r.length;){for(var i=[0,0,0],n=[0,0,0,0],s=0;s<i.length;++s)e<r.length?i[s]=r.charCodeAt(e++)&255:i[s]=0;n[0]=i[0]>>2,n[1]=(i[0]&3)<<4|i[1]>>4,n[2]=(i[1]&15)<<2|i[2]>>6,n[3]=i[2]&63;var o=e-(r.length-1);switch(o){case 2:n[3]=64,n[2]=64;break;case 1:n[3]=64;break}for(var s=0;s<n.length;++s)t+=qp.charAt(n[s])}return t}var ao=self.URL||self.webkitURL;function Jp(r,t){if(!r.data){t();return}if(r.xhr&&r.xhrType===At.XHR_RESPONSE_TYPE.BLOB){if(!self.Blob||typeof r.data=="string"){var e=r.xhr.getResponseHeader("content-type");if(e&&e.indexOf("image")===0){r.data=new Image,r.data.src="data:"+e+";base64,"+Kp(r.xhr.responseText),r.type=At.TYPE.IMAGE,r.data.onload=function(){r.data.onload=null,t()};return}}else if(r.data.type.indexOf("image")===0){var i=ao.createObjectURL(r.data);r.blob=r.data,r.data=new Image,r.data.src=i,r.type=At.TYPE.IMAGE,r.data.onload=function(){ao.revokeObjectURL(i),r.data.onload=null,t()};return}}t()}Xe.registerPlugin({use:Jp});Xe.registerPlugin(Yp);/*!
 * @pixi/text-bitmap - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/text-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var _n=function(r,t){return _n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},_n(r,t)};function Zp(r,t){_n(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Zi=function(){function r(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]}return r}(),Qp=function(){function r(){}return r.test=function(t){return typeof t=="string"&&t.indexOf("info face=")===0},r.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var n in e){var s=e[n].match(/^[a-z]+/gm)[0],o=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),a={};for(var h in o){var u=o[h].split("="),l=u[0],f=u[1].replace(/"/gm,""),d=parseFloat(f),c=isNaN(d)?f:d;a[l]=c}i[s].push(a)}var p=new Zi;return i.info.forEach(function(v){return p.info.push({face:v.face,size:parseInt(v.size,10)})}),i.common.forEach(function(v){return p.common.push({lineHeight:parseInt(v.lineHeight,10)})}),i.page.forEach(function(v){return p.page.push({id:parseInt(v.id,10),file:v.file})}),i.char.forEach(function(v){return p.char.push({id:parseInt(v.id,10),page:parseInt(v.page,10),x:parseInt(v.x,10),y:parseInt(v.y,10),width:parseInt(v.width,10),height:parseInt(v.height,10),xoffset:parseInt(v.xoffset,10),yoffset:parseInt(v.yoffset,10),xadvance:parseInt(v.xadvance,10)})}),i.kerning.forEach(function(v){return p.kerning.push({first:parseInt(v.first,10),second:parseInt(v.second,10),amount:parseInt(v.amount,10)})}),p},r}(),bn=function(){function r(){}return r.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},r.parse=function(t){for(var e=new Zi,i=t.getElementsByTagName("info"),n=t.getElementsByTagName("common"),s=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),h=0;h<i.length;h++)e.info.push({face:i[h].getAttribute("face"),size:parseInt(i[h].getAttribute("size"),10)});for(var h=0;h<n.length;h++)e.common.push({lineHeight:parseInt(n[h].getAttribute("lineHeight"),10)});for(var h=0;h<s.length;h++)e.page.push({id:parseInt(s[h].getAttribute("id"),10)||0,file:s[h].getAttribute("file")});for(var h=0;h<o.length;h++){var u=o[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(var h=0;h<a.length;h++)e.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});return e},r}(),tv=function(){function r(){}return r.test=function(t){if(typeof t=="string"&&t.indexOf("<font>")>-1){var e=new self.DOMParser().parseFromString(t,"text/xml");return bn.test(e)}return!1},r.parse=function(t){var e=new self.DOMParser().parseFromString(t,"text/xml");return bn.parse(e)},r}(),Xr=[Qp,bn,tv];function ba(r){for(var t=0;t<Xr.length;t++)if(Xr[t].test(r))return Xr[t];return null}function ev(r,t,e,i,n,s){var o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;var a,h=e.dropShadow?e.dropShadowDistance:0,u=e.padding||0,l=r.width/i-h-u*2,f=r.height/i-h-u*2,d=o.slice(),c=e.fillGradientStops.slice();if(!c.length)for(var p=d.length+1,v=1;v<p;++v)c.push(v/p);if(d.unshift(o[0]),c.unshift(0),d.push(o[o.length-1]),c.push(1),e.fillGradientType===di.LINEAR_VERTICAL){a=t.createLinearGradient(l/2,u,l/2,f+u);for(var g=0,y=s.fontProperties.fontSize+e.strokeThickness,b=y/f,v=0;v<n.length;v++)for(var _=s.lineHeight*v,T=0;T<d.length;T++){var m=0;typeof c[T]=="number"?m=c[T]:m=T/d.length;var x=_/f+m*b,A=Math.max(g,x);A=Math.min(A,1),a.addColorStop(A,d[T]),g=A}}else{a=t.createLinearGradient(u,f/2,l+u,f/2);for(var S=d.length+1,I=1,v=0;v<d.length;v++){var E=void 0;typeof c[v]=="number"?E=c[v]:E=I/S,a.addColorStop(E,d[v]),I++}}return a}function iv(r,t,e,i,n,s,o){var a=e.text,h=e.fontProperties;t.translate(i,n),t.scale(s,s);var u=o.strokeThickness/2,l=-(o.strokeThickness/2);t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=ev(r,t,o,s,[a],e),t.strokeStyle=o.stroke;var f=o.dropShadowColor,d=xe(typeof f=="number"?f:Zo(f));o.dropShadow?(t.shadowColor="rgba("+d[0]*255+","+d[1]*255+","+d[2]*255+","+o.dropShadowAlpha+")",t.shadowBlur=o.dropShadowBlur,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*o.dropShadowDistance,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*o.dropShadowDistance):(t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),o.stroke&&o.strokeThickness&&t.strokeText(a,u,l+e.lineHeight-h.descent),o.fill&&t.fillText(a,u,l+e.lineHeight-h.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function rv(r){typeof r=="string"&&(r=[r]);for(var t=[],e=0,i=r.length;e<i;e++){var n=r[e];if(Array.isArray(n)){if(n.length!==2)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var s=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push.apply(t,n.split(""))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var Qe=function(){function r(t,e,i){var n=t.info[0],s=t.common[0],o=t.page[0],a=hn(o.file),h={};this._ownsTextures=i,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/a,this.chars={},this.pageTextures=h;for(var u=0;u<t.page.length;u++){var l=t.page[u],f=l.id,d=l.file;h[f]=e instanceof Array?e[u]:e[d]}for(var u=0;u<t.char.length;u++){var c=t.char[u],f=c.id,p=c.page,v=t.char[u],g=v.x,y=v.y,b=v.width,_=v.height,T=v.xoffset,m=v.yoffset,x=v.xadvance;g/=a,y/=a,b/=a,_/=a,T/=a,m/=a,x/=a;var A=new Y(g+h[p].frame.x/a,y+h[p].frame.y/a,b,_);this.chars[f]={xOffset:T,yOffset:m,xAdvance:x,kerning:{},texture:new Z(h[p].baseTexture,A),page:p}}for(var u=0;u<t.kerning.length;u++){var S=t.kerning[u],I=S.first,E=S.second,k=S.amount;I/=a,E/=a,k/=a,this.chars[E]&&(this.chars[E].kerning[I]=k)}}return r.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},r.install=function(t,e,i){var n;if(t instanceof Zi)n=t;else{var s=ba(t);if(!s)throw new Error("Unrecognized data format for font.");n=s.parse(t)}e instanceof Z&&(e=[e]);var o=new r(n,e,i);return r.available[o.font]=o,o},r.uninstall=function(t){var e=r.available[t];if(!e)throw new Error("No font found named '"+t+"'");e.destroy(),delete r.available[t]},r.from=function(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");var n=Object.assign({},r.defaultOptions,i),s=n.chars,o=n.padding,a=n.resolution,h=n.textureWidth,u=n.textureHeight,l=rv(s),f=e instanceof Ki?e:new Ki(e),d=h,c=new Zi;c.info[0]={face:f.fontFamily,size:f.fontSize},c.common[0]={lineHeight:f.fontSize};for(var p=0,v=0,g,y,b,_=0,T=[],m=0;m<l.length;m++){g||(g=document.createElement("canvas"),g.width=h,g.height=u,y=g.getContext("2d"),b=new _t(g,{resolution:a}),T.push(new Z(b)),c.page.push({id:T.length-1,file:""}));var x=Dt.measureText(l[m],f,!1,g),A=x.width,S=Math.ceil(x.height),I=Math.ceil((f.fontStyle==="italic"?2:1)*A);if(v>=u-S*a){if(v===0)throw new Error("[BitmapFont] textureHeight "+u+"px is "+("too small for "+f.fontSize+"px fonts"));--m,g=null,y=null,b=null,v=0,p=0,_=0;continue}if(_=Math.max(S+x.fontProperties.descent,_),I*a+p>=d){--m,v+=_*a,v=Math.ceil(v),p=0,_=0;continue}iv(g,y,x,p,v,a,f);var E=x.text.charCodeAt(0);c.char.push({id:E,page:T.length-1,x:p/a,y:v/a,width:I,height:S,xoffset:0,yoffset:0,xadvance:Math.ceil(A-(f.dropShadow?f.dropShadowDistance:0)-(f.stroke?f.strokeThickness:0))}),p+=(I+2*o)*a,p=Math.ceil(p)}for(var m=0,k=l.length;m<k;m++)for(var w=l[m],O=0;O<k;O++){var j=l[O],L=y.measureText(w).width,P=y.measureText(j).width,H=y.measureText(w+j).width,pt=H-(L+P);pt&&c.kerning.push({first:w.charCodeAt(0),second:j.charCodeAt(0),amount:pt})}var B=new r(c,T,!0);return r.available[t]!==void 0&&r.uninstall(t),r.available[t]=B,B},r.ALPHA=[["a","z"],["A","Z"]," "],r.NUMERIC=[["0","9"]],r.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],r.ASCII=[[" ","~"]],r.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:r.ALPHANUMERIC},r.available={},r}(),ho=[],uo=[],nv=function(r){Zp(t,r);function t(e,i){i===void 0&&(i={});var n=r.call(this)||this;n._tint=16777215;var s=Object.assign({},t.styleDefaults,i),o=s.align,a=s.tint,h=s.maxWidth,u=s.letterSpacing,l=s.fontName,f=s.fontSize;if(!Qe.available[l])throw new Error('Missing BitmapFont "'+l+'"');return n._activePagesMeshData=[],n._textWidth=0,n._textHeight=0,n._align=o,n._tint=a,n._fontName=l,n._fontSize=f||Qe.available[l].size,n._text=e,n._maxWidth=h,n._maxLineHeight=0,n._letterSpacing=u,n._anchor=new Le(function(){n.dirty=!0},n,0,0),n._roundPixels=z.ROUND_PIXELS,n.dirty=!0,n._textureCache={},n}return t.prototype.updateText=function(){for(var e,i=Qe.available[this._fontName],n=this._fontSize/i.size,s=new V,o=[],a=[],h=[],u=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",l=u.length,f=this._maxWidth*i.size/this._fontSize,d=null,c=0,p=0,v=0,g=-1,y=0,b=0,_=0,T=0,m=0;m<l;m++){var x=u.charCodeAt(m),A=u.charAt(m);if(/(?:\s)/.test(A)&&(g=m,y=c,T++),A==="\r"||A===`
`){a.push(c),h.push(-1),p=Math.max(p,c),++v,++b,s.x=0,s.y+=i.lineHeight,d=null,T=0;continue}var S=i.chars[x];if(S){d&&S.kerning[d]&&(s.x+=S.kerning[d]);var I=uo.pop()||{texture:Z.EMPTY,line:0,charCode:0,prevSpaces:0,position:new V};I.texture=S.texture,I.line=v,I.charCode=x,I.position.x=s.x+S.xOffset+this._letterSpacing/2,I.position.y=s.y+S.yOffset,I.prevSpaces=T,o.push(I),c=I.position.x+S.texture.orig.width,s.x+=S.xAdvance+this._letterSpacing,_=Math.max(_,S.yOffset+S.texture.height),d=x,g!==-1&&f>0&&s.x>f&&(++b,ri(o,1+g-b,1+m-g),m=g,g=-1,a.push(y),h.push(o.length>0?o[o.length-1].prevSpaces:0),p=Math.max(p,y),v++,s.x=0,s.y+=i.lineHeight,d=null,T=0)}}var E=u.charAt(u.length-1);E!=="\r"&&E!==`
`&&(/(?:\s)/.test(E)&&(c=y),a.push(c),p=Math.max(p,c),h.push(-1));for(var k=[],m=0;m<=v;m++){var w=0;this._align==="right"?w=p-a[m]:this._align==="center"?w=(p-a[m])/2:this._align==="justify"&&(w=h[m]<0?0:(p-a[m])/h[m]),k.push(w)}for(var O=o.length,j={},L=[],P=this._activePagesMeshData,m=0;m<P.length;m++)ho.push(P[m]);for(var m=0;m<O;m++){var H=o[m].texture,pt=H.baseTexture.uid;if(!j[pt]){var B=ho.pop();if(!B){var M=new kp,F=new Dp(Z.EMPTY),D=new io(M,F);B={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:D,vertices:null,uvs:null,indices:null}}B.index=0,B.indexCount=0,B.vertexCount=0,B.uvsCount=0,B.total=0;var q=this._textureCache;q[pt]=q[pt]||new Z(H.baseTexture),B.mesh.texture=q[pt],B.mesh.tint=this._tint,L.push(B),j[pt]=B}j[pt].total++}for(var m=0;m<P.length;m++)L.indexOf(P[m])===-1&&this.removeChild(P[m].mesh);for(var m=0;m<L.length;m++)L[m].mesh.parent!==this&&this.addChild(L[m].mesh);this._activePagesMeshData=L;for(var m in j){var B=j[m],Q=B.total;if(!(((e=B.indices)===null||e===void 0?void 0:e.length)>6*Q)||B.vertices.length<io.BATCHABLE_SIZE*2)B.vertices=new Float32Array(4*2*Q),B.uvs=new Float32Array(4*2*Q),B.indices=new Uint16Array(6*Q);else for(var gt=B.total,nt=B.vertices,ut=gt*4*2;ut<nt.length;ut++)nt[ut]=0;B.mesh.size=6*Q}for(var m=0;m<O;m++){var A=o[m],mt=A.position.x+k[A.line]*(this._align==="justify"?A.prevSpaces:1);this._roundPixels&&(mt=Math.round(mt));var ot=mt*n,lt=A.position.y*n,H=A.texture,X=j[H.baseTexture.uid],st=H.frame,ft=H._uvs,$=X.index++;X.indices[$*6+0]=0+$*4,X.indices[$*6+1]=1+$*4,X.indices[$*6+2]=2+$*4,X.indices[$*6+3]=0+$*4,X.indices[$*6+4]=2+$*4,X.indices[$*6+5]=3+$*4,X.vertices[$*8+0]=ot,X.vertices[$*8+1]=lt,X.vertices[$*8+2]=ot+st.width*n,X.vertices[$*8+3]=lt,X.vertices[$*8+4]=ot+st.width*n,X.vertices[$*8+5]=lt+st.height*n,X.vertices[$*8+6]=ot,X.vertices[$*8+7]=lt+st.height*n,X.uvs[$*8+0]=ft.x0,X.uvs[$*8+1]=ft.y0,X.uvs[$*8+2]=ft.x1,X.uvs[$*8+3]=ft.y1,X.uvs[$*8+4]=ft.x2,X.uvs[$*8+5]=ft.y2,X.uvs[$*8+6]=ft.x3,X.uvs[$*8+7]=ft.y3}this._textWidth=p*n,this._textHeight=(s.y+i.lineHeight)*n;for(var m in j){var B=j[m];if(this.anchor.x!==0||this.anchor.y!==0)for(var bt=0,kt=this._textWidth*this.anchor.x,Ee=this._textHeight*this.anchor.y,_i=0;_i<B.total;_i++)B.vertices[bt++]-=kt,B.vertices[bt++]-=Ee,B.vertices[bt++]-=kt,B.vertices[bt++]-=Ee,B.vertices[bt++]-=kt,B.vertices[bt++]-=Ee,B.vertices[bt++]-=kt,B.vertices[bt++]-=Ee;this._maxLineHeight=_*n;var Vn=B.mesh.geometry.getBuffer("aVertexPosition"),Yn=B.mesh.geometry.getBuffer("aTextureCoord"),qn=B.mesh.geometry.getIndex();Vn.data=B.vertices,Yn.data=B.uvs,qn.data=B.indices,Vn.update(),Yn.update(),qn.update()}for(var m=0;m<o.length;m++)uo.push(o[m])},t.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},t.prototype.getLocalBounds=function(){return this.validate(),r.prototype.getLocalBounds.call(this)},t.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var i=0;i<this._activePagesMeshData.length;i++)this._activePagesMeshData[i].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!Qe.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){typeof e=="number"?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e){var i=this._textureCache;for(var n in i){var s=i[n];s.destroy(),delete i[n]}this._textureCache=null,r.prototype.destroy.call(this,e)},t.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},t}(dt),sv=function(){function r(){}return r.add=function(){At.setExtensionXhrType("fnt",At.XHR_RESPONSE_TYPE.TEXT)},r.use=function(t,e){var i=ba(t.data);if(!i){e();return}for(var n=r.getBaseUrl(this,t),s=i.parse(t.data),o={},a=function(v){o[v.metadata.pageFile]=v.texture,Object.keys(o).length===s.page.length&&(t.bitmapFont=Qe.install(s,o,!0),e())},h=0;h<s.page.length;++h){var u=s.page[h].file,l=n+u,f=!1;for(var d in this.resources){var c=this.resources[d];if(c.url===l){c.metadata.pageFile=u,c.texture?a(c):c.onAfterMiddleware.add(a),f=!0;break}}if(!f){var p={crossOrigin:t.crossOrigin,loadType:At.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},t.metadata.imageMetadata),parentResource:t};this.add(l,p,a)}}},r.getBaseUrl=function(t,e){var i=e.isDataUrl?"":r.dirname(e.url);return e.isDataUrl&&(i==="."&&(i=""),t.baseUrl&&i&&t.baseUrl.charAt(t.baseUrl.length-1)==="/"&&(i+="/")),i=i.replace(t.baseUrl,""),i&&i.charAt(i.length-1)!=="/"&&(i+="/"),i},r.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":e===""?"/":e},r}();/*!
 * @pixi/app - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ur=function(){function r(t){var e=this;this.stage=new dt,t=Object.assign({forceCanvas:!1},t),this.renderer=bp(t),r._plugins.forEach(function(i){i.init.call(e,t)})}return r.registerPlugin=function(t){r._plugins.push(t)},r.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(r.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),r.prototype.destroy=function(t,e){var i=this,n=r._plugins.slice(0);n.reverse(),n.forEach(function(s){s.destroy.call(i)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},r._plugins=[],r}(),ov=function(){function r(){}return r.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(i){self.removeEventListener("resize",this.queueResize),this._resizeTo=i,i&&(self.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){e.cancelResize();var i,n;if(e._resizeTo===self)i=self.innerWidth,n=self.innerHeight;else{var s=e._resizeTo,o=s.clientWidth,a=s.clientHeight;i=o,n=a}e.renderer.resize(i,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},r.destroy=function(){self.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},r}();ur.registerPlugin(ov);/*!
 * @pixi/interaction - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var lo=function(){function r(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new V,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(r.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),r.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},r.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},r.prototype.reset=function(){this.isPrimary=!1},r}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var xn=function(r,t){return xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},xn(r,t)};function av(r,t){xn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var hv=function(){function r(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return r.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},r.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},r}(),zr=function(){function r(t){this._pointerId=t,this._flags=r.FLAGS.NONE}return r.prototype._doSet=function(t,e){e?this._flags=this._flags|t:this._flags=this._flags&~t},Object.defineProperty(r.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"none",{get:function(){return this._flags===r.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"over",{get:function(){return(this._flags&r.FLAGS.OVER)!==0},set:function(t){this._doSet(r.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rightDown",{get:function(){return(this._flags&r.FLAGS.RIGHT_DOWN)!==0},set:function(t){this._doSet(r.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leftDown",{get:function(){return(this._flags&r.FLAGS.LEFT_DOWN)!==0},set:function(t){this._doSet(r.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),r.FLAGS=Object.freeze({NONE:0,OVER:1<<0,LEFT_DOWN:1<<1,RIGHT_DOWN:1<<2}),r}(),uv=function(){function r(){this._tempPoint=new V}return r.prototype.recursiveFindHit=function(t,e,i,n,s){if(!e||!e.visible)return!1;var o=t.data.global;s=e.interactive||s;var a=!1,h=s,u=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?a=!0:(n=!1,u=!1)),h=!1):e._mask&&n&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(n=!1)),u&&e.interactiveChildren&&e.children)for(var l=e.children,f=l.length-1;f>=0;f--){var d=l[f],c=this.recursiveFindHit(t,d,i,n,h);if(c){if(!d.parent)continue;h=!1,c&&(t.target&&(n=!1),a=!0)}}return s&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(a=!0),e.interactive&&(a&&!t.target&&(t.target=e),i&&i(t,e,!!a))),a},r.prototype.findHit=function(t,e,i,n){this.recursiveFindHit(t,e,i,n,!1)},r}(),lv={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(r){r?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};He.mixin(lv);var Li=1,Ri={target:null,data:{global:null}},fv=function(r){av(t,r);function t(e,i){var n=r.call(this)||this;return i=i||{},n.renderer=e,n.autoPreventDefault=i.autoPreventDefault!==void 0?i.autoPreventDefault:!0,n.interactionFrequency=i.interactionFrequency||10,n.mouse=new lo,n.mouse.identifier=Li,n.mouse.global.set(-999999),n.activeInteractionData={},n.activeInteractionData[Li]=n.mouse,n.interactionDataPool=[],n.eventData=new hv,n.interactionDOMElement=null,n.moveWhenInside=!1,n.eventsAdded=!1,n.tickerAdded=!1,n.mouseOverRenderer=!("PointerEvent"in self),n.supportsTouchEvents="ontouchstart"in self,n.supportsPointerEvents=!!self.PointerEvent,n.onPointerUp=n.onPointerUp.bind(n),n.processPointerUp=n.processPointerUp.bind(n),n.onPointerCancel=n.onPointerCancel.bind(n),n.processPointerCancel=n.processPointerCancel.bind(n),n.onPointerDown=n.onPointerDown.bind(n),n.processPointerDown=n.processPointerDown.bind(n),n.onPointerMove=n.onPointerMove.bind(n),n.processPointerMove=n.processPointerMove.bind(n),n.onPointerOut=n.onPointerOut.bind(n),n.processPointerOverOut=n.processPointerOverOut.bind(n),n.onPointerOver=n.onPointerOver.bind(n),n.cursorStyles={default:"inherit",pointer:"pointer"},n.currentCursorMode=null,n.cursor=null,n.resolution=1,n.delayedEvents=[],n.search=new uv,n._tempDisplayObject=new ma,n._eventListenerOptions={capture:!0,passive:!1},n._useSystemTicker=i.useSystemTicker!==void 0?i.useSystemTicker:!0,n.setTargetElement(n.renderer.view,n.renderer.resolution),n}return Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,i){return Ri.target=null,Ri.data.global=e,i||(i=this.lastObjectRendered),this.processInteractive(Ri,i,null,!0),Ri.target},t.prototype.setTargetElement=function(e,i){i===void 0&&(i=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=i,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(Ut.system.add(this.tickerUpdate,this,Be.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(Ut.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var e=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var e in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&i.pointerType!=="touch"){var n=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var i=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(i=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var n=this.cursorStyles[e];if(n)switch(typeof n){case"string":i&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(e);break;case"object":i&&Object.assign(this.interactionDOMElement.style,n);break}else i&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,i,n){(!n.stopPropagationHint||e===n.stopsPropagatingAt)&&(n.currentTarget=e,n.type=i,e.emit(i,n),e[i]&&e[i](n))},t.prototype.delayDispatchEvent=function(e,i,n){this.delayedEvents.push({displayObject:e,eventString:i,eventData:n})},t.prototype.mapPositionToPoint=function(e,i,n){var s;this.interactionDOMElement.parentElement?s=this.interactionDOMElement.getBoundingClientRect():s={x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var o=1/this.resolution;e.x=(i-s.left)*(this.interactionDOMElement.width/s.width)*o,e.y=(n-s.top)*(this.interactionDOMElement.height/s.height)*o},t.prototype.processInteractive=function(e,i,n,s){var o=this.search.findHit(e,i,n,s),a=this.delayedEvents;if(!a.length)return o;e.stopPropagationHint=!1;var h=a.length;this.delayedEvents=[];for(var u=0;u<h;u++){var l=a[u],f=l.displayObject,d=l.eventString,c=l.eventData;c.stopsPropagatingAt===f&&(c.stopPropagationHint=!0),this.dispatchEvent(f,d,c)}return o},t.prototype.onPointerDown=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var i=this.normalizeToPointerData(e);if(this.autoPreventDefault&&i[0].isNormalized){var n=e.cancelable||!("cancelable"in e);n&&e.preventDefault()}for(var s=i.length,o=0;o<s;o++){var a=i[o],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=e,this.processInteractive(u,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",u),a.pointerType==="touch")this.emit("touchstart",u);else if(a.pointerType==="mouse"||a.pointerType==="pen"){var l=a.button===2;this.emit(l?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,i,n){var s=e.data,o=e.data.identifier;if(n){if(i.trackedPointers[o]||(i.trackedPointers[o]=new zr(o)),this.dispatchEvent(i,"pointerdown",e),s.pointerType==="touch")this.dispatchEvent(i,"touchstart",e);else if(s.pointerType==="mouse"||s.pointerType==="pen"){var a=s.button===2;a?i.trackedPointers[o].rightDown=!0:i.trackedPointers[o].leftDown=!0,this.dispatchEvent(i,a?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,i,n){for(var s=this.normalizeToPointerData(e),o=s.length,a=e.target!==this.interactionDOMElement?"outside":"",h=0;h<o;h++){var u=s[h],l=this.getInteractionDataForPointerId(u),f=this.configureInteractionEventForDOMEvent(this.eventData,u,l);if(f.data.originalEvent=e,this.processInteractive(f,this.lastObjectRendered,n,i||!a),this.emit(i?"pointercancel":"pointerup"+a,f),u.pointerType==="mouse"||u.pointerType==="pen"){var d=u.button===2;this.emit(d?"rightup"+a:"mouseup"+a,f)}else u.pointerType==="touch"&&(this.emit(i?"touchcancel":"touchend"+a,f),this.releaseInteractionDataForPointerId(u.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,i){var n=e.data,s=e.data.identifier;i.trackedPointers[s]!==void 0&&(delete i.trackedPointers[s],this.dispatchEvent(i,"pointercancel",e),n.pointerType==="touch"&&this.dispatchEvent(i,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,i,n){var s=e.data,o=e.data.identifier,a=i.trackedPointers[o],h=s.pointerType==="touch",u=s.pointerType==="mouse"||s.pointerType==="pen",l=!1;if(u){var f=s.button===2,d=zr.FLAGS,c=f?d.RIGHT_DOWN:d.LEFT_DOWN,p=a!==void 0&&a.flags&c;n?(this.dispatchEvent(i,f?"rightup":"mouseup",e),p&&(this.dispatchEvent(i,f?"rightclick":"click",e),l=!0)):p&&this.dispatchEvent(i,f?"rightupoutside":"mouseupoutside",e),a&&(f?a.rightDown=!1:a.leftDown=!1)}n?(this.dispatchEvent(i,"pointerup",e),h&&this.dispatchEvent(i,"touchend",e),a&&((!u||l)&&this.dispatchEvent(i,"pointertap",e),h&&(this.dispatchEvent(i,"tap",e),a.over=!1))):a&&(this.dispatchEvent(i,"pointerupoutside",e),h&&this.dispatchEvent(i,"touchendoutside",e)),a&&a.none&&delete i.trackedPointers[o]},t.prototype.onPointerMove=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var i=this.normalizeToPointerData(e);(i[0].pointerType==="mouse"||i[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var n=i.length,s=0;s<n;s++){var o=i[s],a=this.getInteractionDataForPointerId(o),h=this.configureInteractionEventForDOMEvent(this.eventData,o,a);h.data.originalEvent=e,this.processInteractive(h,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",h),o.pointerType==="touch"&&this.emit("touchmove",h),(o.pointerType==="mouse"||o.pointerType==="pen")&&this.emit("mousemove",h)}i[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,i,n){var s=e.data,o=s.pointerType==="touch",a=s.pointerType==="mouse"||s.pointerType==="pen";a&&this.processPointerOverOut(e,i,n),(!this.moveWhenInside||n)&&(this.dispatchEvent(i,"pointermove",e),o&&this.dispatchEvent(i,"touchmove",e),a&&this.dispatchEvent(i,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var i=this.normalizeToPointerData(e),n=i[0];n.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=n,this.processInteractive(o,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",o),n.pointerType==="mouse"||n.pointerType==="pen"?this.emit("mouseout",o):this.releaseInteractionDataForPointerId(s.identifier)}},t.prototype.processPointerOverOut=function(e,i,n){var s=e.data,o=e.data.identifier,a=s.pointerType==="mouse"||s.pointerType==="pen",h=i.trackedPointers[o];n&&!h&&(h=i.trackedPointers[o]=new zr(o)),h!==void 0&&(n&&this.mouseOverRenderer?(h.over||(h.over=!0,this.delayDispatchEvent(i,"pointerover",e),a&&this.delayDispatchEvent(i,"mouseover",e)),a&&this.cursor===null&&(this.cursor=i.cursor)):h.over&&(h.over=!1,this.dispatchEvent(i,"pointerout",this.eventData),a&&this.dispatchEvent(i,"mouseout",e),h.none&&delete i.trackedPointers[o]))},t.prototype.onPointerOver=function(e){var i=this.normalizeToPointerData(e),n=i[0],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=n,n.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",o),(n.pointerType==="mouse"||n.pointerType==="pen")&&this.emit("mouseover",o)},t.prototype.getInteractionDataForPointerId=function(e){var i=e.pointerId,n;return i===Li||e.pointerType==="mouse"?n=this.mouse:this.activeInteractionData[i]?n=this.activeInteractionData[i]:(n=this.interactionDataPool.pop()||new lo,n.identifier=i,this.activeInteractionData[i]=n),n.copyEvent(e),n},t.prototype.releaseInteractionDataForPointerId=function(e){var i=this.activeInteractionData[e];i&&(delete this.activeInteractionData[e],i.reset(),this.interactionDataPool.push(i))},t.prototype.configureInteractionEventForDOMEvent=function(e,i,n){return e.data=n,this.mapPositionToPoint(n.global,i.clientX,i.clientY),i.pointerType==="touch"&&(i.globalX=n.global.x,i.globalY=n.global.y),n.originalEvent=i,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var i=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var n=0,s=e.changedTouches.length;n<s;n++){var o=e.changedTouches[n];typeof o.button>"u"&&(o.button=e.touches.length?1:0),typeof o.buttons>"u"&&(o.buttons=e.touches.length?1:0),typeof o.isPrimary>"u"&&(o.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,i.push(o)}else if(!self.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof self.PointerEvent))){var a=e;typeof a.isPrimary>"u"&&(a.isPrimary=!0),typeof a.width>"u"&&(a.width=1),typeof a.height>"u"&&(a.height=1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="mouse"),typeof a.pointerId>"u"&&(a.pointerId=Li),typeof a.pressure>"u"&&(a.pressure=.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),a.isNormalized=!0,i.push(a)}else i.push(e);return i},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t}(vi),wn={},dv={get exports(){return wn},set exports(r){wn=r}};(function(r,t){(function(){var e,i;i=function(n){return r.exports=n},e={linear:function(n,s,o,a){return o*n/a+s},easeInQuad:function(n,s,o,a){return o*(n/=a)*n+s},easeOutQuad:function(n,s,o,a){return-o*(n/=a)*(n-2)+s},easeInOutQuad:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n+s:-o/2*(--n*(n-2)-1)+s},easeInCubic:function(n,s,o,a){return o*(n/=a)*n*n+s},easeOutCubic:function(n,s,o,a){return o*((n=n/a-1)*n*n+1)+s},easeInOutCubic:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n*n+s:o/2*((n-=2)*n*n+2)+s},easeInQuart:function(n,s,o,a){return o*(n/=a)*n*n*n+s},easeOutQuart:function(n,s,o,a){return-o*((n=n/a-1)*n*n*n-1)+s},easeInOutQuart:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n*n*n+s:-o/2*((n-=2)*n*n*n-2)+s},easeInQuint:function(n,s,o,a){return o*(n/=a)*n*n*n*n+s},easeOutQuint:function(n,s,o,a){return o*((n=n/a-1)*n*n*n*n+1)+s},easeInOutQuint:function(n,s,o,a){return(n/=a/2)<1?o/2*n*n*n*n*n+s:o/2*((n-=2)*n*n*n*n+2)+s},easeInSine:function(n,s,o,a){return-o*Math.cos(n/a*(Math.PI/2))+o+s},easeOutSine:function(n,s,o,a){return o*Math.sin(n/a*(Math.PI/2))+s},easeInOutSine:function(n,s,o,a){return-o/2*(Math.cos(Math.PI*n/a)-1)+s},easeInExpo:function(n,s,o,a){return n===0?s:o*Math.pow(2,10*(n/a-1))+s},easeOutExpo:function(n,s,o,a){return n===a?s+o:o*(-Math.pow(2,-10*n/a)+1)+s},easeInOutExpo:function(n,s,o,a){return(n/=a/2)<1?o/2*Math.pow(2,10*(n-1))+s:o/2*(-Math.pow(2,-10*--n)+2)+s},easeInCirc:function(n,s,o,a){return-o*(Math.sqrt(1-(n/=a)*n)-1)+s},easeOutCirc:function(n,s,o,a){return o*Math.sqrt(1-(n=n/a-1)*n)+s},easeInOutCirc:function(n,s,o,a){return(n/=a/2)<1?-o/2*(Math.sqrt(1-n*n)-1)+s:o/2*(Math.sqrt(1-(n-=2)*n)+1)+s},easeInElastic:function(n,s,o,a){var h,u,l;return l=1.70158,u=0,h=o,n===0||(n/=a),u||(u=a*.3),h<Math.abs(o)?(h=o,l=u/4):l=u/(2*Math.PI)*Math.asin(o/h),-(h*Math.pow(2,10*(n-=1))*Math.sin((n*a-l)*(2*Math.PI)/u))+s},easeOutElastic:function(n,s,o,a){var h,u,l;return l=1.70158,u=0,h=o,n===0||(n/=a),u||(u=a*.3),h<Math.abs(o)?(h=o,l=u/4):l=u/(2*Math.PI)*Math.asin(o/h),h*Math.pow(2,-10*n)*Math.sin((n*a-l)*(2*Math.PI)/u)+o+s},easeInOutElastic:function(n,s,o,a){var h,u,l;return l=1.70158,u=0,h=o,n===0||(n/=a/2),u||(u=a*(.3*1.5)),h<Math.abs(o)?(h=o,l=u/4):l=u/(2*Math.PI)*Math.asin(o/h),n<1?-.5*(h*Math.pow(2,10*(n-=1))*Math.sin((n*a-l)*(2*Math.PI)/u))+s:h*Math.pow(2,-10*(n-=1))*Math.sin((n*a-l)*(2*Math.PI)/u)*.5+o+s},easeInBack:function(n,s,o,a,h){return h===void 0&&(h=1.70158),o*(n/=a)*n*((h+1)*n-h)+s},easeOutBack:function(n,s,o,a,h){return h===void 0&&(h=1.70158),o*((n=n/a-1)*n*((h+1)*n+h)+1)+s},easeInOutBack:function(n,s,o,a,h){return h===void 0&&(h=1.70158),(n/=a/2)<1?o/2*(n*n*(((h*=1.525)+1)*n-h))+s:o/2*((n-=2)*n*(((h*=1.525)+1)*n+h)+2)+s},easeInBounce:function(n,s,o,a){var h;return h=e.easeOutBounce(a-n,0,o,a),o-h+s},easeOutBounce:function(n,s,o,a){return(n/=a)<1/2.75?o*(7.5625*n*n)+s:n<2/2.75?o*(7.5625*(n-=1.5/2.75)*n+.75)+s:n<2.5/2.75?o*(7.5625*(n-=2.25/2.75)*n+.9375)+s:o*(7.5625*(n-=2.625/2.75)*n+.984375)+s},easeInOutBounce:function(n,s,o,a){var h;return n<a/2?(h=e.easeInBounce(n*2,0,o,a),h*.5+s):(h=e.easeOutBounce(n*2-a,0,o,a),h*.5+o*.5+s)}},i(e)}).call(Bi)})(dv);const fo=wn;class Mt{constructor(t){this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}function lr(r,t){if(r){if(typeof r=="function")return r;if(typeof r=="string")return fo[r]}else return fo[t]}const cv={removeOnInterrupt:!1,ease:"linear",time:1e3};class $t extends Mt{__init(){this.startWidth=null}__init2(){this.startHeight=null}__init3(){this.deltaWidth=null}__init4(){this.deltaHeight=null}__init5(){this.width=null}__init6(){this.height=null}__init7(){this.time=0}constructor(t,e={}){super(t),$t.prototype.__init.call(this),$t.prototype.__init2.call(this),$t.prototype.__init3.call(this),$t.prototype.__init4.call(this),$t.prototype.__init5.call(this),$t.prototype.__init6.call(this),$t.prototype.__init7.call(this),this.options=Object.assign({},cv,e),this.options.ease=lr(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),this.width!==null&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),this.height!==null&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),this.width!==null&&this.parent.fitWidth(this.width,this.keepCenter,this.height===null),this.height!==null&&this.parent.fitHeight(this.height,this.keepCenter,this.width===null),this.keepCenter||this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(!this.paused)if(this.time+=t,this.time>=this.options.time)this.complete();else{const e=new V(this.parent.scale.x,this.parent.scale.y),i=this.options.ease(this.time,0,1,this.options.time);if(this.width!==null){const n=this.startWidth,s=this.deltaWidth;this.parent.fitWidth(n+s*i,this.keepCenter,this.height===null)}if(this.height!==null){const n=this.startHeight,s=this.deltaHeight;this.parent.fitHeight(n+s*i,this.keepCenter,this.width===null)}if(this.width===null?this.parent.scale.x=this.parent.scale.y:this.height===null&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const n=this.startX,s=this.startY,o=this.deltaX,a=this.deltaY,h=new V(this.parent.x,this.parent.y);this.parent.moveCenter(n+o*i,s+a*i),this.parent.emit("moved",{viewport:this.parent,original:h,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:e,type:"animate"})}}}function Mi(r){let t,e=r[0],i=1;for(;i<r.length;){const n=r[i],s=r[i+1];if(i+=2,(n==="optionalAccess"||n==="optionalCall")&&e==null)return;n==="access"||n==="optionalAccess"?(t=e,e=s(e)):(n==="call"||n==="optionalCall")&&(e=s((...o)=>e.call(t,...o)),t=void 0)}return e}const pv={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class vv extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},pv,e),this.ease=lr(this.options.ease,"easeInOutSine"),this.options.sides?this.options.sides==="all"?this.top=this.bottom=this.left=this.right=!0:this.options.sides==="horizontal"?(this.right=this.left=!0,this.top=this.bottom=!1):this.options.sides==="vertical"?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=this.options.sides.indexOf("top")!==-1,this.bottom=this.options.sides.indexOf("bottom")!==-1,this.left=this.options.sides.indexOf("left")!==-1,this.right=this.options.sides.indexOf("right")!==-1):this.left=this.top=this.right=this.bottom=!1;const i=this.options.underflow.toLowerCase();i==="center"?(this.underflowX=0,this.underflowY=0):(this.underflowX=i.indexOf("left")!==-1?-1:i.indexOf("right")!==-1?1:0,this.underflowY=i.indexOf("top")!==-1?-1:i.indexOf("bottom")!==-1?1:0),this.reset()}isActive(){return this.toX!==null||this.toY!==null}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=typeof t.x>"u"?0:t.x,i=typeof t.y>"u"?0:t.y,n=typeof t.width>"u"?this.parent.worldWidth:t.width,s=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>n,top:this.parent.top<i,bottom:this.parent.bottom>s,topLeft:new V(e*this.parent.scale.x,i*this.parent.scale.y),bottomRight:new V(n*this.parent.scale.x-this.parent.screenWidth,s*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new V(0,0),bottomRight:new V(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let t,e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.x&&e.percentChangeX===Mi([e,"access",s=>s.options,"optionalAccess",s=>s.friction])||e.y&&e.percentChangeY===Mi([e,"access",s=>s.options,"optionalAccess",s=>s.friction]))&&(t=this.oob(),(t.left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));const i=this.parent.plugins.get("drag",!0)||{},n=this.parent.plugins.get("pinch",!0)||{};if(e=e||{},!Mi([i,"optionalAccess",s=>s.active])&&!Mi([n,"optionalAccess",s=>s.active])&&(!this.toX||!this.toY)&&(!e.x||!e.y)){t=t||this.oob();const s=t.topLeft,o=t.bottomRight;if(!this.toX&&!e.x){let a=null;t.left&&this.left?a=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-s.x:t.right&&this.right&&(a=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-o.x),a!==null&&this.parent.x!==a&&(this.toX={time:0,start:this.parent.x,delta:a-this.parent.x,end:a},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){let a=null;t.top&&this.top?a=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-s.y:t.bottom&&this.bottom&&(a=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-o.y),a!==null&&this.parent.y!==a&&(this.toY={time:0,start:this.parent.y,delta:a-this.parent.y,end:a},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const gv={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class yv extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},gv,e),this.options.direction&&(this.options.left=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.right=this.options.direction==="x"||this.options.direction==="all"?!0:null,this.options.top=this.options.direction==="y"||this.options.direction==="all"?!0:null,this.options.bottom=this.options.direction==="y"||this.options.direction==="all"?!0:null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();t==="none"?this.noUnderflow=!0:t==="center"?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=t.indexOf("left")!==-1?-1:t.indexOf("right")!==-1?1:0,this.underflowY=t.indexOf("top")!==-1?-1:t.indexOf("bottom")!==-1?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(this.options.left!==null||this.options.right!==null){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x!==0&&(this.parent.x=0,i=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,i=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,i=!0)}else this.options.left!==null&&this.parent.left<(this.options.left===!0?0:this.options.left)&&(this.parent.x=-(this.options.left===!0?0:this.options.left)*this.parent.scale.x,e.x=0,i=!0),this.options.right!==null&&this.parent.right>(this.options.right===!0?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(this.options.right===!0?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(this.options.top!==null||this.options.bottom!==null){let i=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y!==0&&(this.parent.y=0,i=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,i=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,i=!0)}else this.options.top!==null&&this.parent.top<(this.options.top===!0?0:this.options.top)&&(this.parent.y=-(this.options.top===!0?0:this.options.top)*this.parent.scale.y,e.y=0,i=!0),this.options.bottom!==null&&this.parent.bottom>(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(this.options.bottom===!0?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,i=!0);i&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const mv={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class _v extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},mv,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused){if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(this.options.minWidth!==null&&t<this.options.minWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxWidth!==null&&t>this.options.maxWidth){const i=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.minHeight!==null&&e<this.options.minHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(this.options.maxHeight!==null&&e>this.options.maxHeight){const i=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/i,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if(typeof this.options.minScale=="number")t.x=this.options.minScale,t.y=this.options.minScale;else if(this.options.minScale!==null){const s=this.options.minScale;t.x=typeof s.x>"u"?null:s.x,t.y=typeof s.y>"u"?null:s.y}if(typeof this.options.maxScale=="number")e.x=this.options.maxScale,e.y=this.options.maxScale;else if(this.options.maxScale!==null){const s=this.options.maxScale;e.x=typeof s.x>"u"?null:s.x,e.y=typeof s.y>"u"?null:s.y}let i=this.parent.scale.x,n=this.parent.scale.y;t.x!==null&&i<t.x&&(i=t.x),e.x!==null&&i>e.x&&(i=e.x),t.y!==null&&n<t.y&&(n=t.y),e.y!==null&&n>e.y&&(n=e.y),(i!==this.parent.scale.x||n!==this.parent.scale.y)&&(this.parent.scale.set(i,n),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}}reset(){this.clamp()}}const bv={friction:.98,bounce:.8,minSpeed:.01},Zt=16;class xv extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},bv,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",i=>this.moved(i))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!!(this.x||this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(t===1||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}moved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];t.type==="clamp-x"?e.x===t.original.x&&(e.x=this.parent.x):t.type==="clamp-y"&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(this.parent.input.count()===0&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const i=t-e.time;this.x=(this.parent.x-e.x)/i,this.y=(this.parent.y-e.y)/i,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){t=t||{},typeof t.x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,i=this.timeSinceRelease,n=this.timeSinceRelease+t;if(this.x){const s=this.percentChangeX,o=Math.log(s);this.parent.x+=this.x*Zt/o*(Math.pow(s,n/Zt)-Math.pow(s,i/Zt)),this.x*=Math.pow(this.percentChangeX,t/Zt)}if(this.y){const s=this.percentChangeY,o=Math.log(s);this.parent.y+=this.y*Zt/o*(Math.pow(s,n/Zt)-Math.pow(s,i/Zt)),this.y*=Math.pow(this.percentChangeY,t/Zt)}this.timeSinceRelease+=t,Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const wv={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20};class Ev extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},wv,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="x",this.yDirection=!this.options.direction||this.options.direction==="all"||this.options.direction==="y",this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",e=>{t.includes(e.code)&&(this.keyIsPressed=!0)}),window.addEventListener("keyup",e=>{t.includes(e.code)&&(this.keyIsPressed=!1)})}mouseButtons(t){!t||t==="all"?this.mouse=[!0,!0,!0]:this.mouse=[t.indexOf("left")!==-1,t.indexOf("middle")!==-1,t.indexOf("right")!==-1]}parseUnderflow(){const t=this.options.underflow.toLowerCase();t==="center"?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e=t.data.pointerType==="mouse",i=this.parent.input.count();return!!((i===1||i>1&&!this.parent.plugins.get("pinch",!0))&&(!e||this.mouse[t.data.button]))}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&t.data.pointerType==="touch"}down(t){return this.paused||!this.options.pressDrag?!1:this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,!0):(this.last=null,!1)}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.data.global.x,i=t.data.global.y,n=this.parent.input.count();if(n===1||n>1&&!this.parent.plugins.get("pinch",!0)){const s=e-this.last.x,o=i-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(s)||this.yDirection&&this.parent.input.checkThreshold(o)){const a={x:e,y:i};return this.xDirection&&(this.parent.x+=(a.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(a.y-this.last.y)*this.options.factor),this.last=a,this.moved||this.parent.emit("drag-start",{event:t,screen:new V(this.last.x,this.last.y),world:this.parent.toWorld(new V(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(e.length===1){const i=e[0];return i.last&&(this.last={x:i.last.x,y:i.last.y},this.current=i.id),this.moved=!1,!0}else if(this.last&&this.moved){const i=new V(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:i,world:this.parent.toWorld(i),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel&&!this.parent.plugins.get("wheel",!0)){const i=t.deltaMode?this.options.lineHeight:1;return this.xDirection&&(this.parent.x+=t.deltaX*i*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=t.deltaY*i*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if(this.options.clampWheel!=="y")if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if(this.options.clampWheel!=="x")if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const Tv={speed:0,acceleration:null,radius:null};class Iv extends Mt{constructor(t,e,i={}){super(t),this.target=e,this.options=Object.assign({},Tv,i),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let i=this.target.x,n=this.target.y;if(this.options.radius)if(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius){const h=Math.atan2(this.target.y-e.y,this.target.x-e.x);i=this.target.x-Math.cos(h)*this.options.radius,n=this.target.y-Math.sin(h)*this.options.radius}else return;const s=i-e.x,o=n-e.y;if(s||o)if(this.options.speed)if(this.options.acceleration){const a=Math.atan2(n-e.y,i-e.x),h=Math.sqrt(Math.pow(s,2)+Math.pow(o,2));if(h){const u=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);h>u?this.velocity={x:Math.min(this.velocity.x+this.options.acceleration*t,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*t,this.options.speed)}:this.velocity={x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const l=Math.cos(a)*this.velocity.x,f=Math.sin(a)*this.velocity.y,d=Math.abs(l)>Math.abs(s)?i:e.x+l,c=Math.abs(f)>Math.abs(o)?n:e.y+f;this.parent.moveCenter(d,c),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const a=Math.atan2(n-e.y,i-e.x),h=Math.cos(a)*this.options.speed,u=Math.sin(a)*this.options.speed,l=Math.abs(h)>Math.abs(s)?i:e.x+h,f=Math.abs(u)>Math.abs(o)?n:e.y+u;this.parent.moveCenter(l,f),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(i,n),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const Av={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class Ov extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},Av,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared=typeof this.options.radius=="number"?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;t!==null?(this.left=t,this.top=t,this.right=this.parent.worldScreenWidth-t,this.bottom=this.parent.worldScreenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=this.options.right===null?null:this.parent.worldScreenWidth-this.options.right,this.bottom=this.options.bottom===null?null:this.parent.worldScreenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||t.data.pointerType!=="mouse"&&t.data.identifier!==1||!this.options.allowButtons&&t.data.buttons!==0)return!1;const e=t.data.global.x,i=t.data.global.y;if(this.radiusSquared){const n=this.parent.toScreen(this.parent.center);if(Math.pow(n.x-e,2)+Math.pow(n.y-i,2)>=this.radiusSquared){const o=Math.atan2(n.y-i,n.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(o))*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.round(Math.sin(o))*this.options.speed*this.reverse*(60/1e3)):(this.horizontal=Math.cos(o)*this.options.speed*this.reverse*(60/1e3),this.vertical=Math.sin(o)*this.options.speed*this.reverse*(60/1e3))}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else this.left!==null&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*(60/1e3):this.right!==null&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateHorizontal(),this.horizontal=0),this.top!==null&&i<this.top?this.vertical=Number(this.reverse)*this.options.speed*(60/1e3):this.bottom!==null&&i>this.bottom?this.vertical=-1*this.reverse*this.options.speed*(60/1e3):(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const Sv={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class ni extends Mt{__init(){this.active=!1}__init2(){this.pinching=!1}__init3(){this.moved=!1}constructor(t,e={}){super(t),ni.prototype.__init.call(this),ni.prototype.__init2.call(this),ni.prototype.__init3.call(this),this.options=Object.assign({},Sv,e)}down(){return this.parent.input.count()>=2?(this.active=!0,!0):!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.data.global.x,i=t.data.global.y,n=this.parent.input.touches;if(n.length>=2){const s=n[0],o=n[1],a=s.last&&o.last?Math.sqrt(Math.pow(o.last.x-s.last.x,2)+Math.pow(o.last.y-s.last.y,2)):null;if(s.id===t.data.pointerId?s.last={x:e,y:i,data:t.data}:o.id===t.data.pointerId&&(o.last={x:e,y:i,data:t.data}),a){let h;const u={x:s.last.x+(o.last.x-s.last.x)/2,y:s.last.y+(o.last.y-s.last.y)/2};this.options.center||(h=this.parent.toLocal(u));let l=Math.sqrt(Math.pow(o.last.x-s.last.x,2)+Math.pow(o.last.y-s.last.y,2));l=l===0?l=1e-10:l;const f=(1-a/l)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=f),this.isAxisY()&&(this.parent.scale.y+=f),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:u});const d=this.parent.plugins.get("clamp-zoom",!0);if(d&&d.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const c=this.parent.toGlobal(h);this.parent.x+=(u.x-c.x)*this.options.factor,this.parent.y+=(u.y-c.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(u.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(u.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=u,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return this.pinching&&this.parent.input.touches.length<=1?(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0):!1}}const Nv={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class Cv extends Mt{constructor(t,e,i,n={}){super(t),this.options=Object.assign({},Nv,n),this.ease=lr(n.ease,"easeInOutSine"),this.x=e,this.y=i,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(this.parent.input.count()===0){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!this.paused&&!(this.options.interrupt&&this.parent.input.count()!==0))if(this.snapping){const e=this.snapping;e.time+=t;let i,n,s;const o=this.startX,a=this.startY,h=this.deltaX,u=this.deltaY;if(e.time>this.options.time)i=!0,n=o+h,s=a+u;else{const l=this.ease(e.time,0,1,this.options.time);n=o+h*l,s=a+u*l}this.options.topLeft?this.parent.moveCorner(n,s):this.parent.moveCenter(n,s),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),i&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const e=this.options.topLeft?this.parent.corner:this.parent.center;(e.x!==this.x||e.y!==this.y)&&this.snapStart()}}}const Pv={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class Lv extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},Pv,e),this.ease=lr(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,this.options.time===0?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,i=this.parent.screenWidth/this.xScale,n=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:i-t,deltaY:n-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&this.parent.input.count()!==0)return;let e;if(!this.options.center&&!this.options.noMove&&(e=this.parent.center),!this.snapping)(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping();else if(this.snapping){const i=this.snapping;if(i.time+=t,i.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const s=this.snapping,o=this.ease(s.time,s.startX,s.deltaX,this.options.time),a=this.ease(s.time,s.startY,s.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/o,this.parent.scale.y=this.parent.screenHeight/a}const n=this.parent.plugins.get("clamp-zoom",!0);n&&n.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}resume(){this.snapping=null,super.resume()}}const Rv={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all"};class Mv extends Mt{constructor(t,e={}){super(t),this.options=Object.assign({},Rv,e)}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let i;this.options.center||(i=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const s=this.parent.toGlobal(i);this.parent.x+=t.x-s.x,this.parent.y+=t.y-s.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}wheel(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),n=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,s=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){const o={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+o.x)*s-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+o.y)*s-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let o;this.options.center||(o=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=s),this.isAxisY()&&(this.parent.scale.y*=s),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const h=this.parent.toGlobal(o);this.parent.x+=e.x-h.x,this.parent.y+=e.y-h.y}}if(this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent}),!this.parent.options.passiveWheel)return!0}}class Uv{constructor(t){this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new Y(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(t){if(this.viewport.pause||!this.viewport.worldVisible)return;if(t.data.pointerType==="mouse"?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),this.count()===1){this.last=t.data.global.clone();const i=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);(!i||!i.isActive())&&(!n||!n.isActive())?this.clickedAvailable=!0:this.clickedAvailable=!1}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const i=t.data.global.x-this.last.x,n=t.data.global.y-this.last.y;(this.checkThreshold(i)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;t.data.pointerType==="mouse"&&(this.isMouseDown=!1),t.data.pointerType!=="mouse"&&this.remove(t.data.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&this.count()===0&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new V;return this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(e,t.clientX,t.clientY):(e.x=t.clientX,e.y=t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible||this.viewport.options.interaction&&this.viewport.options.interaction.interactionDOMElement!==t.target)return;const e=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t){this.touches.splice(e,1);return}}count(){return(this.isMouseDown?1:0)+this.touches.length}}function jr(r){let t,e=r[0],i=1;for(;i<r.length;){const n=r[i],s=r[i+1];if(i+=2,(n==="optionalAccess"||n==="optionalCall")&&e==null)return;n==="access"||n==="optionalAccess"?(t=e,e=s(e)):(n==="call"||n==="optionalCall")&&(e=s((...o)=>e.call(t,...o)),t=void 0)}return e}const Ze=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class Fv{constructor(t){this.viewport=t,this.list=[],this.plugins={}}add(t,e,i=Ze.length){this.plugins[t]=e;const n=Ze.indexOf(t);n!==-1&&Ze.splice(n,1),Ze.splice(i,0,t),this.sort()}get(t,e){return e&&jr([this,"access",i=>i.plugins,"access",i=>i[t],"optionalAccess",i=>i.paused])?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.plugins={},this.sort()}remove(t){this.plugins[t]&&(delete this.plugins[t],this.viewport.emit(`${t}-remove`),this.sort())}pause(t){jr([this,"access",e=>e.plugins,"access",e=>e[t],"optionalAccess",e=>e.pause,"call",e=>e()])}resume(t){jr([this,"access",e=>e.plugins,"access",e=>e[t],"optionalAccess",e=>e.resume,"call",e=>e()])}sort(){this.list=[];for(const t of Ze)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const i of this.list)i.down(t)&&(e=!0);return e}move(t){let e=!1;for(const i of this.viewport.plugins.list)i.move(t)&&(e=!0);return e}up(t){let e=!1;for(const i of this.list)i.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const i of this.list)i.wheel(t)&&(e=!0);return e}}const Dv={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:Ut.shared};class kv extends dt{constructor(t={}){super(),this.options=Object.assign({},{divWheel:document.body},Dv,t),this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu&&(this.options.divWheel.oncontextmenu=e=>e.preventDefault()),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new Uv(this),this.plugins=new Fv(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new Y(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,i,n){this.screenWidth=t,this.screenHeight=e,typeof i<"u"&&(this._worldWidth=i),typeof n<"u"&&(this._worldHeight=n),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new Y(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return arguments.length===2?this.toLocal(new V(t,e)):this.toLocal(t)}toScreen(t,e){return arguments.length===2?this.toGlobal(new V(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new V(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,i;typeof t[0]=="number"?(e=t[0],i=t[1]):(e=t[0].x,i=t[0].y);const n=(this.worldScreenWidth/2-e)*this.scale.x,s=(this.worldScreenHeight/2-i)*this.scale.y;return(this.x!==n||this.y!==s)&&(this.position.set(n,s),this.plugins.reset(),this.dirty=!0),this}get corner(){return new V(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,i;return t.length===1?(e=-t[0].x*this.scale.x,i=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,i=-t[1]*this.scale.y),(e!==this.x||i!==this.y)&&(this.position.set(e,i),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const i=this.screenWidth/t,n=this.screenHeight/e;return Math.min(i,n)}findCover(t,e){const i=this.screenWidth/t,n=this.screenHeight/e;return Math.max(i,n)}fitWidth(t=this.worldWidth,e,i=!0,n){let s;e&&(s=this.center),this.scale.x=this.screenWidth/t,i&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),e&&s&&this.moveCenter(s),this}fitHeight(t=this.worldHeight,e,i=!0,n){let s;e&&(s=this.center),this.scale.y=this.screenHeight/t,i&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!n&&o&&o.clamp(),e&&s&&this.moveCenter(s),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,i=this.worldHeight){let n;t&&(n=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/i,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const s=this.plugins.get("clamp-zoom",!0);return s&&s.clamp(),t&&n&&this.moveCenter(n),this}set visible(t){t||this.input.clear(),super.visible=t}setZoom(t,e){let i;e&&(i=this.center),this.scale.set(t);const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),e&&i&&this.moveCenter(i),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new Lv(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new V(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new Y(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new Ev(this,t)),this}clamp(t){return this.plugins.add("clamp",new yv(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new xv(this,t)),this}bounce(t){return this.plugins.add("bounce",new vv(this,t)),this}pinch(t){return this.plugins.add("pinch",new ni(this,t)),this}snap(t,e,i){return this.plugins.add("snap",new Cv(this,t,e,i)),this}follow(t,e){return this.plugins.add("follow",new Iv(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new Mv(this,t)),this}animate(t){return this.plugins.add("animate",new $t(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new _v(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new Ov(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,i,n,s){s&&(i>this.worldScreenWidth||n>this.worldScreenHeight)&&(this.fit(!0,i,n),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;t<this.left?(this.left=t,o=!0):t+i>this.right&&(this.right=t+i,o=!0),e<this.top?(this.top=e,o=!0):e+n>this.bottom&&(this.bottom=e+n,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}const ae=new Y;class Bv{constructor(t={}){this._recursive=typeof t.recursive=="boolean"?t.recursive:!0,this._toggle=t.toggle||"visible",this._targetList=new Set}add(t){return this._targetList.add(t),this}addAll(t){for(let e=0,i=t.length;e<i;e++)this._targetList.add(t[e]);return this}remove(t){return this._targetList.delete(t),this}removeAll(t){for(let e=0,i=t.length;e<i;e++)this._targetList.delete(t[e]);return this}clear(){return this._targetList.clear(),this}cull(t,e=!1){return e||this.uncull(),this._targetList.forEach(i=>{e||i.getBounds(!1,ae),this._recursive?this.cullRecursive(t,i,e):(e&&i._bounds.getRectangle(t),i[this._toggle]=ae.right>t.left&&ae.left<t.right&&ae.bottom>t.top&&ae.top<t.bottom)}),this}uncull(){return this._targetList.forEach(t=>{this._recursive?this.uncullRecursive(t):t[this._toggle]=!1}),this}cullRecursive(t,e,i){const n=i?e._bounds.getRectangle(ae):e.getBounds(!0,ae);if(e[this._toggle]=n.right>t.left&&n.left<t.right&&n.bottom>t.top&&n.top<t.bottom,!(n.left>=t.left&&n.top>=t.top&&n.right<=t.right&&n.bottom<=t.bottom)&&e[this._toggle]&&e.children&&e.children.length){const o=e.children;for(let a=0,h=o.length;a<h;a++)this.cullRecursive(t,o[a])}}uncullRecursive(t){if(t[this._toggle]=!0,t.children&&t.children.length){const e=t.children;for(let i=0,n=e.length;i<n;i++)this.uncullRecursive(e[i])}}}var xa={},Qi={},Gv={get exports(){return Qi},set exports(r){Qi=r}},Fe=typeof Reflect=="object"?Reflect:null,co=Fe&&typeof Fe.apply=="function"?Fe.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)},Hi;Fe&&typeof Fe.ownKeys=="function"?Hi=Fe.ownKeys:Object.getOwnPropertySymbols?Hi=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Hi=function(t){return Object.getOwnPropertyNames(t)};function Hv(r){console&&console.warn&&console.warn(r)}var wa=Number.isNaN||function(t){return t!==t};function it(){it.init.call(this)}Gv.exports=it;Qi.once=Wv;it.EventEmitter=it;it.prototype._events=void 0;it.prototype._eventsCount=0;it.prototype._maxListeners=void 0;var po=10;function fr(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(it,"defaultMaxListeners",{enumerable:!0,get:function(){return po},set:function(r){if(typeof r!="number"||r<0||wa(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");po=r}});it.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};it.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||wa(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Ea(r){return r._maxListeners===void 0?it.defaultMaxListeners:r._maxListeners}it.prototype.getMaxListeners=function(){return Ea(this)};it.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var n=t==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")co(h,this,e);else for(var u=h.length,l=Sa(h,u),i=0;i<u;++i)co(l[i],this,e);return!0};function Ta(r,t,e,i){var n,s,o;if(fr(e),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",t,e.listener?e.listener:e),s=r._events),o=s[t]),o===void 0)o=s[t]=e,++r._eventsCount;else if(typeof o=="function"?o=s[t]=i?[e,o]:[o,e]:i?o.unshift(e):o.push(e),n=Ea(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=t,a.count=o.length,Hv(a)}return r}it.prototype.addListener=function(t,e){return Ta(this,t,e,!1)};it.prototype.on=it.prototype.addListener;it.prototype.prependListener=function(t,e){return Ta(this,t,e,!0)};function Xv(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ia(r,t,e){var i={fired:!1,wrapFn:void 0,target:r,type:t,listener:e},n=Xv.bind(i);return n.listener=e,i.wrapFn=n,n}it.prototype.once=function(t,e){return fr(e),this.on(t,Ia(this,t,e)),this};it.prototype.prependOnceListener=function(t,e){return fr(e),this.prependListener(t,Ia(this,t,e)),this};it.prototype.removeListener=function(t,e){var i,n,s,o,a;if(fr(e),n=this._events,n===void 0)return this;if(i=n[t],i===void 0)return this;if(i===e||i.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===e||i[o].listener===e){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():zv(i,s),i.length===1&&(n[t]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",t,a||e)}return this};it.prototype.off=it.prototype.removeListener;it.prototype.removeAllListeners=function(t){var e,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[t]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=i[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this};function Aa(r,t,e){var i=r._events;if(i===void 0)return[];var n=i[t];return n===void 0?[]:typeof n=="function"?e?[n.listener||n]:[n]:e?jv(n):Sa(n,n.length)}it.prototype.listeners=function(t){return Aa(this,t,!0)};it.prototype.rawListeners=function(t){return Aa(this,t,!1)};it.listenerCount=function(r,t){return typeof r.listenerCount=="function"?r.listenerCount(t):Oa.call(r,t)};it.prototype.listenerCount=Oa;function Oa(r){var t=this._events;if(t!==void 0){var e=t[r];if(typeof e=="function")return 1;if(e!==void 0)return e.length}return 0}it.prototype.eventNames=function(){return this._eventsCount>0?Hi(this._events):[]};function Sa(r,t){for(var e=new Array(t),i=0;i<t;++i)e[i]=r[i];return e}function zv(r,t){for(;t+1<r.length;t++)r[t]=r[t+1];r.pop()}function jv(r){for(var t=new Array(r.length),e=0;e<t.length;++e)t[e]=r[e].listener||r[e];return t}function Wv(r,t){return new Promise(function(e,i){function n(o){r.removeListener(t,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),e([].slice.call(arguments))}Na(r,t,s,{once:!0}),t!=="error"&&$v(r,n,{once:!0})})}function $v(r,t,e){typeof r.on=="function"&&Na(r,"error",t,e)}function Na(r,t,e,i){if(typeof r.on=="function")i.once?r.once(t,e):r.on(t,e);else if(typeof r.addEventListener=="function")r.addEventListener(t,function n(s){i.once&&r.removeEventListener(t,n),e(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}Object.defineProperty(xa,"__esModule",{value:!0});var Gn=xa.TypedEmitter=Qi.EventEmitter,Vv=function(t){return Yv(t)&&!qv(t)};function Yv(r){return!!r&&typeof r=="object"}function qv(r){var t=Object.prototype.toString.call(r);return t==="[object RegExp]"||t==="[object Date]"||Zv(r)}var Kv=typeof Symbol=="function"&&Symbol.for,Jv=Kv?Symbol.for("react.element"):60103;function Zv(r){return r.$$typeof===Jv}function Qv(r){return Array.isArray(r)?[]:{}}function ci(r,t){return t.clone!==!1&&t.isMergeableObject(r)?ze(Qv(r),r,t):r}function tg(r,t,e){return r.concat(t).map(function(i){return ci(i,e)})}function eg(r,t){if(!t.customMerge)return ze;var e=t.customMerge(r);return typeof e=="function"?e:ze}function ig(r){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(r).filter(function(t){return r.propertyIsEnumerable(t)}):[]}function vo(r){return Object.keys(r).concat(ig(r))}function Ca(r,t){try{return t in r}catch{return!1}}function rg(r,t){return Ca(r,t)&&!(Object.hasOwnProperty.call(r,t)&&Object.propertyIsEnumerable.call(r,t))}function ng(r,t,e){var i={};return e.isMergeableObject(r)&&vo(r).forEach(function(n){i[n]=ci(r[n],e)}),vo(t).forEach(function(n){rg(r,n)||(Ca(r,n)&&e.isMergeableObject(t[n])?i[n]=eg(n,e)(r[n],t[n],e):i[n]=ci(t[n],e))}),i}function ze(r,t,e){e=e||{},e.arrayMerge=e.arrayMerge||tg,e.isMergeableObject=e.isMergeableObject||Vv,e.cloneUnlessOtherwiseSpecified=ci;var i=Array.isArray(t),n=Array.isArray(r),s=i===n;return s?i?e.arrayMerge(r,t,e):ng(r,t,e):ci(t,e)}ze.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(i,n){return ze(i,n,e)},{})};var sg=ze,og=sg;/*!
 * @pixi/graphics - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ot;(function(r){r.MITER="miter",r.BEVEL="bevel",r.ROUND="round"})(Ot||(Ot={}));var Rt;(function(r){r.BUTT="butt",r.ROUND="round",r.SQUARE="square"})(Rt||(Rt={}));var pi={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(r,t){if(t===void 0&&(t=20),!this.adaptive||!r||isNaN(r))return t;var e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},Pa=function(){function r(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.visible=!1,this.reset()}return r.prototype.clone=function(){var t=new r;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},r.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.visible=!1},r.prototype.destroy=function(){this.texture=null,this.matrix=null},r}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var En=function(r,t){return En=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])},En(r,t)};function Hn(r,t){En(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Xn={build:function(r){r.points=r.shape.points.slice()},triangulate:function(r,t){var e=r.points,i=r.holes,n=t.points,s=t.indices;if(e.length>=6){for(var o=[],a=0;a<i.length;a++){var h=i[a];o.push(e.length/2),e=e.concat(h.points)}var u=be(e,o,2);if(!u)return;for(var l=n.length/2,a=0;a<u.length;a+=3)s.push(u[a]+l),s.push(u[a+1]+l),s.push(u[a+2]+l);for(var a=0;a<e.length;a++)n.push(e[a])}}},Tn={build:function(r){var t=r.shape,e=r.points,i=t.x,n=t.y,s,o;if(e.length=0,r.type===J.CIRC)s=t.radius,o=t.radius;else{var a=r.shape;s=a.width,o=a.height}if(!(s===0||o===0)){var h=Math.floor(30*Math.sqrt(t.radius))||Math.floor(15*Math.sqrt(s+o));h/=2.3;for(var u=Math.PI*2/h,l=0;l<h-.5;l++)e.push(i+Math.sin(-u*l)*s,n+Math.cos(-u*l)*o);e.push(e[0],e[1])}},triangulate:function(r,t){var e=r.points,i=t.points,n=t.indices,s=i.length/2,o=s,a=r.shape,h=r.matrix,u=a.x,l=a.y;i.push(r.matrix?h.a*u+h.c*l+h.tx:u,r.matrix?h.b*u+h.d*l+h.ty:l);for(var f=0;f<e.length;f+=2)i.push(e[f],e[f+1]),n.push(s++,o,s)}},La={build:function(r){var t=r.shape,e=t.x,i=t.y,n=t.width,s=t.height,o=r.points;o.length=0,o.push(e,i,e+n,i,e+n,i+s,e,i+s)},triangulate:function(r,t){var e=r.points,i=t.points,n=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}};function Ie(r,t,e){var i=t-r;return r+i*e}function Ui(r,t,e,i,n,s,o){o===void 0&&(o=[]);for(var a=20,h=o,u=0,l=0,f=0,d=0,c=0,p=0,v=0,g=0;v<=a;++v)g=v/a,u=Ie(r,e,g),l=Ie(t,i,g),f=Ie(e,n,g),d=Ie(i,s,g),c=Ie(u,f,g),p=Ie(l,d,g),!(v===0&&h[h.length-2]===c&&h[h.length-1]===p)&&h.push(c,p);return h}var Ra={build:function(r){var t=r.shape,e=r.points,i=t.x,n=t.y,s=t.width,o=t.height,a=Math.max(0,Math.min(t.radius,Math.min(s,o)/2));e.length=0,a?(Ui(i,n+a,i,n,i+a,n,e),Ui(i+s-a,n,i+s,n,i+s,n+a,e),Ui(i+s,n+o-a,i+s,n+o,i+s-a,n+o,e),Ui(i+a,n+o,i,n+o,i,n+o-a,e)):e.push(i,n,i+s,n,i+s,n+o,i,n+o)},triangulate:function(r,t){for(var e=r.points,i=t.points,n=t.indices,s=i.length/2,o=be(e,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(var a=0,h=e.length;a<h;a++)i.push(e[a],e[++a])}};function go(r,t,e,i,n,s,o,a){var h=r-e*n,u=t-i*n,l=r+e*s,f=t+i*s,d,c;o?(d=i,c=-e):(d=-i,c=e);var p=h+d,v=u+c,g=l+d,y=f+c;return a.push(p,v),a.push(g,y),2}function Ae(r,t,e,i,n,s,o,a){var h=e-r,u=i-t,l=Math.atan2(h,u),f=Math.atan2(n-r,s-t);a&&l<f?l+=Math.PI*2:!a&&l>f&&(f+=Math.PI*2);var d=l,c=f-l,p=Math.abs(c),v=Math.sqrt(h*h+u*u),g=(15*p*Math.sqrt(v)/Math.PI>>0)+1,y=c/g;if(d+=y,a){o.push(r,t),o.push(e,i);for(var b=1,_=d;b<g;b++,_+=y)o.push(r,t),o.push(r+Math.sin(_)*v,t+Math.cos(_)*v);o.push(r,t),o.push(n,s)}else{o.push(e,i),o.push(r,t);for(var b=1,_=d;b<g;b++,_+=y)o.push(r+Math.sin(_)*v,t+Math.cos(_)*v),o.push(r,t);o.push(n,s),o.push(r,t)}return g*2}function ag(r,t){var e=r.shape,i=r.points||e.points.slice(),n=t.closePointEps;if(i.length!==0){var s=r.lineStyle,o=new V(i[0],i[1]),a=new V(i[i.length-2],i[i.length-1]),h=e.type!==J.POLY||e.closeStroke,u=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=(o.x+a.x)*.5,f=(a.y+o.y)*.5;i.unshift(l,f),i.push(l,f)}var d=t.points,c=i.length/2,p=i.length,v=d.length/2,g=s.width/2,y=g*g,b=s.miterLimit*s.miterLimit,_=i[0],T=i[1],m=i[2],x=i[3],A=0,S=0,I=-(T-x),E=_-m,k=0,w=0,O=Math.sqrt(I*I+E*E);I/=O,E/=O,I*=g,E*=g;var j=s.alignment,L=(1-j)*2,P=j*2;h||(s.cap===Rt.ROUND?p+=Ae(_-I*(L-P)*.5,T-E*(L-P)*.5,_-I*L,T-E*L,_+I*P,T+E*P,d,!0)+2:s.cap===Rt.SQUARE&&(p+=go(_,T,I,E,L,P,!0,d))),d.push(_-I*L,T-E*L),d.push(_+I*P,T+E*P);for(var H=1;H<c-1;++H){_=i[(H-1)*2],T=i[(H-1)*2+1],m=i[H*2],x=i[H*2+1],A=i[(H+1)*2],S=i[(H+1)*2+1],I=-(T-x),E=_-m,O=Math.sqrt(I*I+E*E),I/=O,E/=O,I*=g,E*=g,k=-(x-S),w=m-A,O=Math.sqrt(k*k+w*w),k/=O,w/=O,k*=g,w*=g;var pt=m-_,B=T-x,M=m-A,F=S-x,D=B*M-F*pt,q=D<0;if(Math.abs(D)<.1){d.push(m-I*L,x-E*L),d.push(m+I*P,x+E*P);continue}var Q=(-I+_)*(-E+x)-(-I+m)*(-E+T),gt=(-k+A)*(-w+x)-(-k+m)*(-w+S),nt=(pt*gt-M*Q)/D,ut=(F*Q-B*gt)/D,mt=(nt-m)*(nt-m)+(ut-x)*(ut-x),ot=m+(nt-m)*L,lt=x+(ut-x)*L,X=m-(nt-m)*P,st=x-(ut-x)*P,ft=Math.min(pt*pt+B*B,M*M+F*F),$=q?L:P,bt=ft+$*$*y,kt=mt<=bt;kt?s.join===Ot.BEVEL||mt/y>b?(q?(d.push(ot,lt),d.push(m+I*P,x+E*P),d.push(ot,lt),d.push(m+k*P,x+w*P)):(d.push(m-I*L,x-E*L),d.push(X,st),d.push(m-k*L,x-w*L),d.push(X,st)),p+=2):s.join===Ot.ROUND?q?(d.push(ot,lt),d.push(m+I*P,x+E*P),p+=Ae(m,x,m+I*P,x+E*P,m+k*P,x+w*P,d,!0)+4,d.push(ot,lt),d.push(m+k*P,x+w*P)):(d.push(m-I*L,x-E*L),d.push(X,st),p+=Ae(m,x,m-I*L,x-E*L,m-k*L,x-w*L,d,!1)+4,d.push(m-k*L,x-w*L),d.push(X,st)):(d.push(ot,lt),d.push(X,st)):(d.push(m-I*L,x-E*L),d.push(m+I*P,x+E*P),s.join===Ot.BEVEL||mt/y>b||(s.join===Ot.ROUND?q?p+=Ae(m,x,m+I*P,x+E*P,m+k*P,x+w*P,d,!0)+2:p+=Ae(m,x,m-I*L,x-E*L,m-k*L,x-w*L,d,!1)+2:(q?(d.push(X,st),d.push(X,st)):(d.push(ot,lt),d.push(ot,lt)),p+=2)),d.push(m-k*L,x-w*L),d.push(m+k*P,x+w*P),p+=2)}_=i[(c-2)*2],T=i[(c-2)*2+1],m=i[(c-1)*2],x=i[(c-1)*2+1],I=-(T-x),E=_-m,O=Math.sqrt(I*I+E*E),I/=O,E/=O,I*=g,E*=g,d.push(m-I*L,x-E*L),d.push(m+I*P,x+E*P),h||(s.cap===Rt.ROUND?p+=Ae(m-I*(L-P)*.5,x-E*(L-P)*.5,m-I*L,x-E*L,m+I*P,x+E*P,d,!1)+2:s.cap===Rt.SQUARE&&(p+=go(m,x,I,E,L,P,!1,d)));for(var Ee=t.indices,_i=pi.epsilon*pi.epsilon,H=v;H<p+v-2;++H)_=d[H*2],T=d[H*2+1],m=d[(H+1)*2],x=d[(H+1)*2+1],A=d[(H+2)*2],S=d[(H+2)*2+1],!(Math.abs(_*(x-S)+m*(S-T)+A*(T-x))<_i)&&Ee.push(H,H+1,H+2)}}function hg(r,t){var e=0,i=r.shape,n=r.points||i.points,s=i.type!==J.POLY||i.closeStroke;if(n.length!==0){var o=t.points,a=t.indices,h=n.length/2,u=o.length/2,l=u;for(o.push(n[0],n[1]),e=1;e<h;e++)o.push(n[e*2],n[e*2+1]),a.push(l,l+1),l++;s&&a.push(l,u)}}function In(r,t){r.lineStyle.native?hg(r,t):ag(r,t)}var An=function(){function r(){}return r.curveTo=function(t,e,i,n,s,o){var a=o[o.length-2],h=o[o.length-1],u=h-e,l=a-t,f=n-e,d=i-t,c=Math.abs(u*d-l*f);if(c<1e-8||s===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;var p=u*u+l*l,v=f*f+d*d,g=u*f+l*d,y=s*Math.sqrt(p)/c,b=s*Math.sqrt(v)/c,_=y*g/p,T=b*g/v,m=y*d+b*l,x=y*f+b*u,A=l*(b+_),S=u*(b+_),I=d*(y+T),E=f*(y+T),k=Math.atan2(S-x,A-m),w=Math.atan2(E-x,I-m);return{cx:m+t,cy:x+e,radius:s,startAngle:k,endAngle:w,anticlockwise:l*f>d*u}},r.arc=function(t,e,i,n,s,o,a,h,u){for(var l=a-o,f=pi._segmentsCount(Math.abs(l)*s,Math.ceil(Math.abs(l)/we)*40),d=l/(f*2),c=d*2,p=Math.cos(d),v=Math.sin(d),g=f-1,y=g%1/g,b=0;b<=g;++b){var _=b+y*b,T=d+o+c*_,m=Math.cos(T),x=-Math.sin(T);u.push((p*m+v*x)*s+i,(p*-x+v*m)*s+n)}},r}(),Ma=function(){function r(){}return r.curveLength=function(t,e,i,n,s,o,a,h){for(var u=10,l=0,f=0,d=0,c=0,p=0,v=0,g=0,y=0,b=0,_=0,T=0,m=t,x=e,A=1;A<=u;++A)f=A/u,d=f*f,c=d*f,p=1-f,v=p*p,g=v*p,y=g*t+3*v*f*i+3*p*d*s+c*a,b=g*e+3*v*f*n+3*p*d*o+c*h,_=m-y,T=x-b,m=y,x=b,l+=Math.sqrt(_*_+T*T);return l},r.curveTo=function(t,e,i,n,s,o,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var l=pi._segmentsCount(r.curveLength(h,u,t,e,i,n,s,o)),f=0,d=0,c=0,p=0,v=0;a.push(h,u);for(var g=1,y=0;g<=l;++g)y=g/l,f=1-y,d=f*f,c=d*f,p=y*y,v=p*y,a.push(c*h+3*d*y*t+3*f*p*i+v*s,c*u+3*d*y*e+3*f*p*n+v*o)},r}(),Ua=function(){function r(){}return r.curveLength=function(t,e,i,n,s,o){var a=t-2*i+s,h=e-2*n+o,u=2*i-2*t,l=2*n-2*e,f=4*(a*a+h*h),d=4*(a*u+h*l),c=u*u+l*l,p=2*Math.sqrt(f+d+c),v=Math.sqrt(f),g=2*f*v,y=2*Math.sqrt(c),b=d/v;return(g*p+v*d*(p-y)+(4*c*f-d*d)*Math.log((2*v+b+p)/(b+y)))/(4*g)},r.curveTo=function(t,e,i,n,s){for(var o=s[s.length-2],a=s[s.length-1],h=pi._segmentsCount(r.curveLength(o,a,t,e,i,n)),u=0,l=0,f=1;f<=h;++f){var d=f/h;u=o+(t-o)*d,l=a+(e-a)*d,s.push(u+(t+(i-t)*d-u)*d,l+(e+(n-e)*d-l)*d)}},r}(),Fa=function(){function r(){this.reset()}return r.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i},r.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},r.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},r}(),he,Xi=(he={},he[J.POLY]=Xn,he[J.CIRC]=Tn,he[J.ELIP]=Tn,he[J.RECT]=La,he[J.RREC]=Ra,he),On=[],ti=[];function ug(r){for(var t=r.points,e=0,i=0;i<t.length-2;i+=2)e+=(t[i+2]-t[i])*(t[i+3]+t[i+1]);return e>0}var yo=function(){function r(t,e,i,n){e===void 0&&(e=null),i===void 0&&(i=null),n===void 0&&(n=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=n,this.type=t.type}return r.prototype.clone=function(){return new r(this.shape,this.fillStyle,this.lineStyle,this.matrix)},r.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},r}(),Oe=new V,lg=new Ge,fg=function(r){Hn(t,r);function t(){var e=r.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Ge,e.boundsDirty=-1,e}return Object.defineProperty(t.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),ti.push(this.drawCalls[e]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var i=this.batches[e];i.reset(),On.push(i)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,i,n,s){i===void 0&&(i=null),n===void 0&&(n=null),s===void 0&&(s=null);var o=new yo(e,i,n,s);return this.graphicsData.push(o),this.dirty++,this},t.prototype.drawHole=function(e,i){if(i===void 0&&(i=null),!this.graphicsData.length)return null;var n=new yo(e,null,null,i),s=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=s.lineStyle,s.holes.push(n),this.dirty++,this},t.prototype.destroy=function(){r.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var i=this.graphicsData,n=0;n<i.length;++n){var s=i[n];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(e,Oe):Oe.copyFrom(e),s.shape.contains(Oe.x,Oe.y))){var o=!1;if(s.holes)for(var a=0;a<s.holes.length;a++){var h=s.holes[a];if(h.shape.contains(Oe.x,Oe.y)){o=!0;break}}if(!o)return!0}}return!1},t.prototype.updateBatches=function(e){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var i=this.uvs,n=this.graphicsData,s=null,o=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],o=s.style);for(var a=this.shapeIndex;a<n.length;a++){this.shapeIndex++;var h=n[a],u=h.fillStyle,l=h.lineStyle,f=Xi[h.type];f.build(h),h.matrix&&this.transformPoints(h.points,h.matrix);for(var d=0;d<2;d++){var c=d===0?u:l;if(c.visible){var p=c.texture.baseTexture,v=this.indices.length,g=this.points.length/2;p.wrapMode=ke.REPEAT,d===0?this.processFill(h):this.processLine(h);var y=this.points.length/2-g;y!==0&&(s&&!this._compareStyles(o,c)&&(s.end(v,g),s=null),s||(s=On.pop()||new Fa,s.begin(c,v,g),this.batches.push(s),o=c),this.addUvs(this.points,i,c.texture,g,y,c.matrix))}}}var b=this.indices.length,_=this.points.length/2;if(s&&s.end(b,_),this.batches.length===0){this.batchable=!0;return}if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var T=_>65535&&e;this.indicesUint16=T?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},t.prototype._compareStyles=function(e,i){return!(!e||!i||e.texture.baseTexture!==i.texture.baseTexture||e.color+e.alpha!==i.color+i.alpha||!!e.native!=!!i.native)},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,i=this.graphicsData.length;e<i;e++){var n=this.graphicsData[e],s=n.fillStyle,o=n.lineStyle;if(s&&!s.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,i=0,n=e.length;i<n;i++)for(var s=e[i],o=0;o<s.size;o++){var a=s.start+o;this.indicesUint16[a]=this.indicesUint16[a]-s.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var e=this.batches,i=0;i<e.length;i++)if(e[i].style.native)return!1;return this.points.length<t.BATCHABLE_SIZE*2},t.prototype.buildDrawCalls=function(){for(var e=++_t._globalBatch,i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),ti.push(this.drawCalls[i]);this.drawCalls.length=0;var n=this.colors,s=this.textureIds,o=ti.pop();o||(o=new pn,o.texArray=new qi),o.texArray.count=0,o.start=0,o.size=0,o.type=Lt.TRIANGLES;var a=0,h=null,u=0,l=!1,f=Lt.TRIANGLES,d=0;this.drawCalls.push(o);for(var i=0;i<this.batches.length;i++){var c=this.batches[i],p=8,v=c.style,g=v.texture.baseTexture;l!==!!v.native&&(l=!!v.native,f=l?Lt.LINES:Lt.TRIANGLES,h=null,a=p,e++),h!==g&&(h=g,g._batchEnabled!==e&&(a===p&&(e++,a=0,o.size>0&&(o=ti.pop(),o||(o=new pn,o.texArray=new qi),this.drawCalls.push(o)),o.start=d,o.size=0,o.texArray.count=0,o.type=f),g.touched=1,g._batchEnabled=e,g._batchLocation=a,g.wrapMode=ke.REPEAT,o.texArray.elements[o.texArray.count++]=g,a++)),o.size+=c.size,d+=c.size,u=g._batchLocation,this.addColors(n,v.color,v.alpha,c.attribSize,c.attribStart),this.addTextureIds(s,u,c.attribSize,c.attribStart)}_t._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,i=this.uvs,n=this.colors,s=this.textureIds,o=new ArrayBuffer(e.length*3*4),a=new Float32Array(o),h=new Uint32Array(o),u=0,l=0;l<e.length/2;l++)a[u++]=e[l*2],a[u++]=e[l*2+1],a[u++]=i[l*2],a[u++]=i[l*2+1],h[u++]=n[l],a[u++]=s[l];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){if(e.holes.length)this.processHoles(e.holes),Xn.triangulate(e,this);else{var i=Xi[e.type];i.triangulate(e,this)}},t.prototype.processLine=function(e){In(e,this);for(var i=0;i<e.holes.length;i++)In(e.holes[i],this)},t.prototype.processHoles=function(e){for(var i=0;i<e.length;i++){var n=e[i],s=Xi[n.type];s.build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds,i=lg,n=vt.IDENTITY;this._bounds.clear(),i.clear();for(var s=0;s<this.graphicsData.length;s++){var o=this.graphicsData[s],a=o.shape,h=o.type,u=o.lineStyle,l=o.matrix||vt.IDENTITY,f=0;if(u&&u.visible){var d=u.alignment;f=u.width,h===J.POLY?ug(a)?f=f*(1-d):f=f*d:f=f*Math.max(0,d)}if(n!==l&&(i.isEmpty()||(e.addBoundsMatrix(i,n),i.clear()),n=l),h===J.RECT||h===J.RREC){var c=a;i.addFramePad(c.x,c.y,c.x+c.width,c.y+c.height,f,f)}else if(h===J.CIRC){var p=a;i.addFramePad(p.x,p.y,p.x,p.y,p.radius+f,p.radius+f)}else if(h===J.ELIP){var v=a;i.addFramePad(v.x,v.y,v.x,v.y,v.width+f,v.height+f)}else{var g=a;e.addVerticesMatrix(n,g.points,0,g.points.length,f,f)}}i.isEmpty()||e.addBoundsMatrix(i,n),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,i){for(var n=0;n<e.length/2;n++){var s=e[n*2],o=e[n*2+1];e[n*2]=i.a*s+i.c*o+i.tx,e[n*2+1]=i.b*s+i.d*o+i.ty}},t.prototype.addColors=function(e,i,n,s,o){o===void 0&&(o=0);var a=(i>>16)+(i&65280)+((i&255)<<16),h=Rn(a,n);e.length=Math.max(e.length,o+s);for(var u=0;u<s;u++)e[o+u]=h},t.prototype.addTextureIds=function(e,i,n,s){s===void 0&&(s=0),e.length=Math.max(e.length,s+n);for(var o=0;o<n;o++)e[s+o]=i},t.prototype.addUvs=function(e,i,n,s,o,a){a===void 0&&(a=null);for(var h=0,u=i.length,l=n.frame;h<o;){var f=e[(s+h)*2],d=e[(s+h)*2+1];if(a){var c=a.a*f+a.c*d+a.tx;d=a.b*f+a.d*d+a.ty,f=c}h++,i.push(f/l.width,d/l.height)}var p=n.baseTexture;(l.width<p.width||l.height<p.height)&&this.adjustUvs(i,n,u,o)},t.prototype.adjustUvs=function(e,i,n,s){for(var o=i.baseTexture,a=1e-6,h=n+s*2,u=i.frame,l=u.width/o.width,f=u.height/o.height,d=u.x/u.width,c=u.y/u.height,p=Math.floor(e[n]+a),v=Math.floor(e[n+1]+a),g=n+2;g<h;g+=2)p=Math.min(p,Math.floor(e[g]+a)),v=Math.min(v,Math.floor(e[g+1]+a));d-=p,c-=v;for(var g=n;g<h;g+=2)e[g]=(e[g]+d)*l,e[g+1]=(e[g+1]+c)*f},t.BATCHABLE_SIZE=100,t}(ya),dg=function(r){Hn(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Rt.BUTT,e.join=Ot.MITER,e.miterLimit=10,e}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){r.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(Pa),cg=new Float32Array(3),Wr={},pg=function(r){Hn(t,r);function t(e){e===void 0&&(e=null);var i=r.call(this)||this;return i.shader=null,i.pluginName="batch",i.currentPath=null,i.batches=[],i.batchTint=-1,i.batchDirty=-1,i.vertexData=null,i._fillStyle=new Pa,i._lineStyle=new dg,i._matrix=null,i._holeMode=!1,i.state=$e.for2d(),i._geometry=e||new fg,i._geometry.refCount++,i._transformID=-1,i.tint=16777215,i.blendMode=G.NORMAL,i}return Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,i,n,s,o){return e===void 0&&(e=null),i===void 0&&(i=0),n===void 0&&(n=1),s===void 0&&(s=.5),o===void 0&&(o=!1),typeof e=="number"&&(e={width:e,color:i,alpha:n,alignment:s,native:o}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:Z.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Rt.BUTT,join:Ot.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var i=e.width>0&&e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:i},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,i=this.currentPath.points.length;i>2&&(this.drawShape(this.currentPath),this.currentPath=new te,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[i-2],e[i-1]))}else this.currentPath=new te,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,i){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=i,this},t.prototype.lineTo=function(e,i){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,s=n[n.length-2],o=n[n.length-1];return(s!==e||o!==i)&&n.push(e,i),this},t.prototype._initCurve=function(e,i){e===void 0&&(e=0),i===void 0&&(i=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,i]):this.moveTo(e,i)},t.prototype.quadraticCurveTo=function(e,i,n,s){this._initCurve();var o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),Ua.curveTo(e,i,n,s,o),this},t.prototype.bezierCurveTo=function(e,i,n,s,o,a){return this._initCurve(),Ma.curveTo(e,i,n,s,o,a,this.currentPath.points),this},t.prototype.arcTo=function(e,i,n,s,o){this._initCurve(e,i);var a=this.currentPath.points,h=An.curveTo(e,i,n,s,o,a);if(h){var u=h.cx,l=h.cy,f=h.radius,d=h.startAngle,c=h.endAngle,p=h.anticlockwise;this.arc(u,l,f,d,c,p)}return this},t.prototype.arc=function(e,i,n,s,o,a){if(a===void 0&&(a=!1),s===o)return this;!a&&o<=s?o+=we:a&&s<=o&&(s+=we);var h=o-s;if(h===0)return this;var u=e+Math.cos(s)*n,l=i+Math.sin(s)*n,f=this._geometry.closePointEps,d=this.currentPath?this.currentPath.points:null;if(d){var c=Math.abs(d[d.length-2]-u),p=Math.abs(d[d.length-1]-l);c<f&&p<f||d.push(u,l)}else this.moveTo(u,l),d=this.currentPath.points;return An.arc(u,l,e,i,n,s,o,a,d),this},t.prototype.beginFill=function(e,i){return e===void 0&&(e=0),i===void 0&&(i=1),this.beginTextureFill({texture:Z.WHITE,color:e,alpha:i})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:Z.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var i=e.alpha>0;return i?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:i},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,i,n,s){return this.drawShape(new Y(e,i,n,s))},t.prototype.drawRoundedRect=function(e,i,n,s,o){return this.drawShape(new ea(e,i,n,s,o))},t.prototype.drawCircle=function(e,i,n){return this.drawShape(new Mn(e,i,n))},t.prototype.drawEllipse=function(e,i,n,s){return this.drawShape(new ta(e,i,n,s))},t.prototype.drawPolygon=function(){for(var e=arguments,i=[],n=0;n<arguments.length;n++)i[n]=e[n];var s,o=!0,a=i[0];a.points?(o=a.closeStroke,s=a.points):Array.isArray(i[0])?s=i[0]:s=i;var h=new te(s);return h.closeStroke=o,this.drawShape(h),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===J.RECT&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var i=this._geometry,n=e.context.supports.uint32Indices;i.updateBatches(n),i.batchable?(this.batchDirty!==i.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,i=this.blendMode,n=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(e.points);for(var s=0;s<n;s++){var o=e.batches[s],a=o.style.color,h=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),u=new Float32Array(e.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),l=new Uint16Array(e.indicesUint16.buffer,o.start*2,o.size),f={vertexData:h,blendMode:i,indices:l,uvs:u,_batchRGB:xe(a),_tintRGB:a,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[s]=f}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var i=0,n=this.batches.length;i<n;i++){var s=this.batches[i];s.worldAlpha=this.worldAlpha*s.alpha,e.plugins[this.pluginName].render(s)}}},t.prototype._renderDirect=function(e){var i=this._resolveDirectShader(e),n=this._geometry,s=this.tint,o=this.worldAlpha,a=i.uniforms,h=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(s>>16&255)/255*o,a.tint[1]=(s>>8&255)/255*o,a.tint[2]=(s&255)/255*o,a.tint[3]=o,e.shader.bind(i),e.geometry.bind(n,i),e.state.set(this.state);for(var u=0,l=h.length;u<l;u++)this._renderDrawCallDirect(e,n.drawCalls[u])},t.prototype._renderDrawCallDirect=function(e,i){for(var n=i.texArray,s=i.type,o=i.size,a=i.start,h=n.count,u=0;u<h;u++)e.texture.bind(n.elements[u],u);e.geometry.draw(s,o,a)},t.prototype._resolveDirectShader=function(e){var i=this.shader,n=this.pluginName;if(!i){if(!Wr[n]){for(var s=e.plugins.batch.MAX_TEXTURES,o=new Int32Array(s),a=0;a<s;a++)o[a]=a;var h={tint:new Float32Array([1,1,1,1]),translationMatrix:new vt,default:ge.from({uSamplers:o},!0)},u=e.plugins[n]._shader.program;Wr[n]=new mi(u,h)}i=Wr[n]}return i},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var i=e.bounds,n=i.minX,s=i.minY,o=i.maxX,a=i.maxY;this._bounds.addFrame(this.transform,n,s,o,a)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=xe(this.tint,cg),i=0;i<this.batches.length;i++){var n=this.batches[i],s=n._batchRGB,o=e[0]*s[0]*255,a=e[1]*s[1]*255,h=e[2]*s[2]*255,u=(o<<16)+(a<<8)+(h|0);n._tintRGB=(u>>16)+(u&65280)+((u&255)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var i=this.transform.worldTransform,n=i.a,s=i.b,o=i.c,a=i.d,h=i.tx,u=i.ty,l=this._geometry.points,f=this.vertexData,d=0,c=0;c<l.length;c+=2){var p=l[c],v=l[c+1];f[d++]=n*p+o*v+h,f[d++]=a*v+s*p+u}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,r.prototype.destroy.call(this,e)},t._TEMP_POINT=new V,t}(dt),vg={buildPoly:Xn,buildCircle:Tn,buildRectangle:La,buildRoundedRectangle:Ra,buildLine:In,ArcUtils:An,BezierUtils:Ma,QuadraticUtils:Ua,BatchPart:Fa,FILL_COMMANDS:Xi,BATCH_POOL:On,DRAW_CALL_POOL:ti};function Da(r,t,e=.001){return this===t||Math.abs(r.a-t.a)<e&&Math.abs(r.b-t.b)<e&&Math.abs(r.c-t.c)<e&&Math.abs(r.d-t.d)<e&&Math.abs(r.tx-t.tx)<e&&Math.abs(r.ty-t.ty)<e}class gg{constructor(){this.textureIds=[],this.matrices=[],this.lines=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.textureIds[t]=null,this.matrices[t]=null;this.count=0}add(t,e,i,n,s){const{textureIds:o,matrices:a,lines:h,count:u}=this;for(let l=0;l<u;l++)if(h[l*2]===i&&h[l*2+1]===n&&o[l]===t&&Da(a[l],e))return l;return u>=s.maxStyles?-1:(o[u]=t,a[u]=e,h[u*2]=i,h[u*2+1]=n,this.count++,u)}}class mo{constructor(){this.texArray=new qi,this.styleArray=new gg,this.shader=null,this.blend=G.NORMAL,this.start=0,this.size=0,this.TICK=0,this.settings=null,this.data=null}clear(){this.texArray.clear(),this.styleArray.clear(),this.settings=null,this.data=null,this.shader=null}begin(t,e){this.TICK=++_t._globalBatch,this.settings=t,this.shader=e,this.start=0,this.size=0,this.data=null,e&&e.settings&&(this.settings=e.settings)}check(t){return this.size===0?(this.shader=t,!0):this.shader===t}add(t,e,i,n){const{texArray:s,TICK:o,styleArray:a,settings:h}=this,{baseTexture:u}=t;if(u._batchEnabled!==o&&s.count===h.maxTextures)return-1;const l=u._batchEnabled!==o?s.count:u._batchLocation,f=a.add(l,e||vt.IDENTITY,i,n,h);return f>=0&&u._batchEnabled!==o&&(u._batchEnabled=o,u._batchLocation=s.count,s.elements[s.count++]=u),f}}class yg{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i,this.jointEnd=0}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0,this.styleId=-1,this.rgba=0,this.jointEnd=0}}class dr{constructor(){this.reset()}toJSON(){return this.copyTo({})}clone(){return this.copyTo(new dr)}copyTo(t){return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.shader=this.shader,t.visible=this.visible,t.smooth=this.smooth,t.matrixTex=null,t}packLineWidth(){return 0}reset(){this.color=16777215,this.alpha=1,this.texture=Z.WHITE,this.matrix=null,this.shader=null,this.visible=!1,this.smooth=!1,this.matrixTex=null}destroy(){this.texture=null,this.matrix=null,this.matrixTex=null}getTextureMatrix(){const t=this.texture;return this.matrix?t.frame.width===t.baseTexture.width&&t.frame.height===t.baseTexture.height?this.matrix:(this.matrixTex?this.matrixTex.copyFrom(this.matrix):this.matrixTex=this.matrix.clone(),this.matrixTex.translate(Number(t.frame.x),Number(t.frame.y)),this.matrixTex):null}}var Xt;(function(r){const t="none";r.NONE=t;const e="normal";r.NORMAL=e})(Xt||(Xt={}));class zn extends dr{clone(){return this.copyTo(new zn)}copyTo(t){return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.shader=this.shader,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t.scaleMode=this.scaleMode,t}packLineWidth(){return this.scaleMode===Xt.NORMAL?this.width:-this.width}reset(){super.reset(),this.smooth=!0,this.color=0,this.width=0,this.alignment=.5,this.cap=Rt.BUTT,this.join=Ot.MITER,this.miterLimit=10,this.scaleMode=Xt.NORMAL}}class ce{constructor(){ce.prototype.__init.call(this),ce.prototype.__init2.call(this),ce.prototype.__init3.call(this),ce.prototype.__init4.call(this),ce.prototype.__init5.call(this)}__init(){this.verts=[]}__init2(){this.joints=[]}__init3(){this.vertexSize=0}__init4(){this.indexSize=0}__init5(){this.closePointEps=1e-4}clear(){this.verts.length=0,this.joints.length=0,this.vertexSize=0,this.indexSize=0}destroy(){this.verts.length=0,this.joints.length=0}}var N;(function(r){r[r.NONE=0]="NONE";const e=1;r[r.FILL=e]="FILL";const i=4;r[r.JOINT_BEVEL=i]="JOINT_BEVEL";const n=8;r[r.JOINT_MITER=n]="JOINT_MITER";const s=12;r[r.JOINT_ROUND=s]="JOINT_ROUND";const o=16;r[r.JOINT_CAP_BUTT=o]="JOINT_CAP_BUTT";const a=18;r[r.JOINT_CAP_SQUARE=a]="JOINT_CAP_SQUARE";const h=20;r[r.JOINT_CAP_ROUND=h]="JOINT_CAP_ROUND";const u=24;r[r.FILL_EXPAND=u]="FILL_EXPAND";const l=1<<5;r[r.CAP_BUTT=l]="CAP_BUTT";const f=2<<5;r[r.CAP_SQUARE=f]="CAP_SQUARE";const d=3<<5;r[r.CAP_ROUND=d]="CAP_ROUND";const c=4<<5;r[r.CAP_BUTT2=c]="CAP_BUTT2"})(N||(N={}));class Pt{constructor(){Pt.prototype.__init.call(this),Pt.prototype.__init2.call(this),Pt.prototype.__init3.call(this)}static __initStatic(){this.vertsByJoint=[]}__init(){this.strideFloats=12}updateBufferSize(t,e,i,n){const{joints:s}=n;let o=!1,a=0,h=0;for(let u=t;u<t+e;u++){const l=s[u]&-32,f=s[u]&31;if(f===N.FILL){o=!0,a++;continue}if(f>=N.FILL_EXPAND){a+=3,h+=3;continue}const d=Pt.vertsByJoint[f]+Pt.vertsByJoint[l];d>=4&&(a+=d,h+=6+3*Math.max(d-6,0))}o&&(h+=i),n.vertexSize+=a,n.indexSize+=h}__init2(){this.bufferPos=0}__init3(){this.indexPos=0}beginPack(t,e,i,n,s=0,o=0){this.buildData=t,this.bufFloat=e,this.bufUint=i,this.indices=n,this.bufferPos=s,this.indexPos=o}endPack(){this.buildData=null,this.bufFloat=null,this.bufUint=null,this.indices=null}packInterleavedGeometry(t,e,i,n,s){const{bufFloat:o,bufUint:a,indices:h,buildData:u,strideFloats:l}=this,{joints:f,verts:d}=u;let c=this.bufferPos,p=this.indexPos,v=this.bufferPos/this.strideFloats,g,y,b,_,T,m,x,A,S=!1,I=0;for(let E=t;E<t+e;E++){const k=f[E],w=f[E]&-32,O=f[E]&31;if(O===N.FILL){S=!0,g=d[E*2],y=d[E*2+1],o[c]=g,o[c+1]=y,o[c+2]=g,o[c+3]=y,o[c+4]=g,o[c+5]=y,o[c+6]=g,o[c+7]=y,o[c+8]=I,o[c+9]=16*O,o[c+10]=n,a[c+11]=s,c+=l;continue}if(O>=N.FILL_EXPAND){T=d[E*2],m=d[E*2+1],g=d[E*2+2],y=d[E*2+3],b=d[E*2+4],_=d[E*2+5];const P=E+3;for(let H=0;H<3;H++)o[c]=T,o[c+1]=m,o[c+2]=g,o[c+3]=y,o[c+4]=b,o[c+5]=_,o[c+6]=d[(P+H)*2],o[c+7]=d[(P+H)*2+1],o[c+8]=I,o[c+9]=16*k+H,o[c+10]=n,a[c+11]=s,c+=l;h[p]=v,h[p+1]=v+1,h[p+2]=v+2,p+=3,v+=3;continue}const j=Pt.vertsByJoint[O]+Pt.vertsByJoint[w];if(j===0)continue;g=d[E*2],y=d[E*2+1],b=d[E*2+2],_=d[E*2+3],T=d[E*2-2],m=d[E*2-1];const L=Math.sqrt((b-g)*(b-g)+(_-y)*(_-y));Pt.vertsByJoint[O]===0&&(I-=L),(O&-3)!==N.JOINT_CAP_BUTT?(x=d[E*2+4],A=d[E*2+5]):(x=g,A=y);for(let P=0;P<j;P++)o[c]=T,o[c+1]=m,o[c+2]=g,o[c+3]=y,o[c+4]=b,o[c+5]=_,o[c+6]=x,o[c+7]=A,o[c+8]=I,o[c+9]=16*k+P,o[c+10]=n,a[c+11]=s,c+=l;I+=L,h[p]=v,h[p+1]=v+1,h[p+2]=v+2,h[p+3]=v,h[p+4]=v+2,h[p+5]=v+3,p+=6;for(let P=5;P+1<j;P++)h[p]=v+4,h[p+1]=v+P,h[p+2]=v+P+1,p+=3;v+=j}if(S){for(let E=0;E<i.length;E++)h[p+E]=i[E]+v;p+=i.length}this.bufferPos=c,this.indexPos=p}}Pt.__initStatic();const ct=Pt.vertsByJoint;for(let r=0;r<256;r++)ct.push(0);ct[N.FILL]=1;for(let r=0;r<8;r++)ct[N.FILL_EXPAND+r]=3;ct[N.JOINT_BEVEL]=4+3;ct[N.JOINT_BEVEL+1]=4+3;ct[N.JOINT_BEVEL+2]=4+3;ct[N.JOINT_BEVEL+3]=4+3;ct[N.JOINT_ROUND]=4+5;ct[N.JOINT_ROUND+1]=4+5;ct[N.JOINT_ROUND+2]=4+5;ct[N.JOINT_ROUND+3]=4+5;ct[N.JOINT_MITER]=4+4;ct[N.JOINT_MITER+1]=4+4;ct[N.JOINT_MITER+2]=4;ct[N.JOINT_MITER+3]=4;ct[N.JOINT_CAP_BUTT]=4;ct[N.JOINT_CAP_BUTT+1]=4;ct[N.JOINT_CAP_SQUARE]=4;ct[N.JOINT_CAP_SQUARE+1]=4;ct[N.JOINT_CAP_ROUND]=4+4;ct[N.JOINT_CAP_ROUND+1]=4+4;ct[N.CAP_ROUND]=4;class tr{constructor(t,e=null,i=null,n=null){this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=n,this.type=t.type,this.points=[],this.holes=[],this.triangles=[],this.closeStroke=!1,this.clearBuild()}clearPath(){this.points.length=0,this.closeStroke=!0}clearBuild(){this.triangles.length=0,this.fillStart=0,this.fillLen=0,this.strokeStart=0,this.strokeLen=0,this.fillAA=!1}clone(){return new tr(this.shape,this.fillStyle,this.lineStyle,this.matrix)}capType(){let t;switch(this.lineStyle.cap){case Rt.SQUARE:t=N.CAP_SQUARE;break;case Rt.ROUND:t=N.CAP_ROUND;break;default:t=N.CAP_BUTT;break}return t}goodJointType(){let t;switch(this.lineStyle.join){case Ot.BEVEL:t=N.JOINT_BEVEL;break;case Ot.ROUND:t=N.JOINT_ROUND;break;default:t=N.JOINT_MITER+3;break}return t}jointType(){let t;switch(this.lineStyle.join){case Ot.BEVEL:t=N.JOINT_BEVEL;break;case Ot.ROUND:t=N.JOINT_ROUND;break;default:t=N.JOINT_MITER;break}return t}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null,this.triangles=null}}class _o{path(t,e){const i=t.shape,n=t.points,s=i.x,o=i.y;let a,h;if(t.type===J.CIRC)a=i.radius,h=i.radius;else{const f=t.shape;a=f.width,h=f.height}if(a<=0||h<=0)return;n.push(s,o);let u=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(a+h));u/=2.3,u<3&&(u=3);const l=Math.PI*2/u;for(let f=0;f<u-.5;f++)n.push(s+Math.sin(-l*f)*a,o+Math.cos(-l*f)*h)}fill(t,e){const{verts:i,joints:n}=e,{points:s,triangles:o}=t;let a=1;const h=0;if(!t.fillAA){for(let d=0;d<s.length;d+=2)i.push(s[d],s[d+1]),n.push(N.FILL),d>2&&o.push(a++,h,a);o.push(a,h,1);return}const u=s[0],l=s[1],f=t.shape.radius;for(let d=2;d<s.length;d+=2){const c=d,p=d+2<s.length?d+2:2;i.push(u),i.push(l),i.push(s[c]),i.push(s[c+1]),i.push(s[p]),i.push(s[p+1]),i.push(0),i.push(0),i.push((s[c]-u)/f),i.push((s[c+1]-l)/f),i.push((s[p]-u)/f),i.push((s[p+1]-l)/f),n.push(N.FILL_EXPAND+2),n.push(N.NONE),n.push(N.NONE),n.push(N.NONE),n.push(N.NONE),n.push(N.NONE)}}line(t,e){const{verts:i,joints:n}=e,{points:s}=t,o=t.goodJointType(),a=s.length;i.push(s[a-2],s[a-1]),n.push(N.NONE);for(let h=2;h<a;h+=2)i.push(s[h],s[h+1]),n.push(o);i.push(s[2],s[3]),n.push(N.NONE),i.push(s[4],s[5]),n.push(N.NONE)}}class mg{path(t,e){const i=t.shape,n=i.x,s=i.y,o=i.width,a=i.height,h=t.points;h.length=0,h.push(n,s,n+o,s,n+o,s+a,n,s+a)}line(t,e){const{verts:i,joints:n}=e,{points:s}=t,o=t.goodJointType(),a=s.length;i.push(s[a-2],s[a-1]),n.push(N.NONE);for(let h=0;h<a;h+=2)i.push(s[h],s[h+1]),n.push(o);i.push(s[0],s[1]),n.push(N.NONE),i.push(s[2],s[3]),n.push(N.NONE)}fill(t,e){const{verts:i,joints:n}=e,{points:s,triangles:o}=t;o.length=0,i.push(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7]),n.push(N.FILL,N.FILL,N.FILL,N.FILL),o.push(0,1,2,0,2,3)}}function Se(r,t,e){const i=t-r;return r+i*e}function Fi(r,t,e,i,n,s,o=[]){const h=o;let u=0,l=0,f=0,d=0,c=0,p=0;for(let v=0,g=0;v<=20;++v)g=v/20,u=Se(r,e,g),l=Se(t,i,g),f=Se(e,n,g),d=Se(i,s,g),c=Se(u,f,g),p=Se(l,d,g),h.push(c,p);return h}class _g{path(t,e){const i=t.shape,{points:n}=t,s=i.x,o=i.y,a=i.width,h=i.height,u=Math.max(0,Math.min(i.radius,Math.min(a,h)/2));n.length=0,u?(Fi(s,o+u,s,o,s+u,o,n),Fi(s+a-u,o,s+a,o,s+a,o+u,n),Fi(s+a,o+h-u,s+a,o+h,s+a-u,o+h,n),Fi(s+u,o+h,s,o+h,s,o+h-u,n)):n.push(s,o,s+a,o,s+a,o+h,s,o+h)}line(t,e){const{verts:i,joints:n}=e,{points:s}=t,o=s.length===8?t.goodJointType():N.JOINT_MITER+3,a=s.length;i.push(s[a-2],s[a-1]),n.push(N.NONE);for(let h=0;h<a;h+=2)i.push(s[h],s[h+1]),n.push(o);i.push(s[0],s[1]),n.push(N.NONE),i.push(s[2],s[3]),n.push(N.NONE)}fill(t,e){const{verts:i,joints:n}=e,{points:s}=t;t.triangles=be(s,null,2);for(let o=0,a=s.length;o<a;o++)i.push(s[o],s[++o]),n.push(N.FILL)}}const bg=[];class xg{path(t,e){const i=t.shape,n=t.points=i.points.slice(),s=e.closePointEps,o=s*s;if(n.length===0)return;const a=new V(n[0],n[1]),h=new V(n[n.length-2],n[n.length-1]),u=t.closeStroke=i.closeStroke;let l=n.length,f=2;for(let d=2;d<l;d+=2){const c=n[d-2],p=n[d-1],v=n[d],g=n[d+1];let y=!0;Math.abs(c-v)<s&&Math.abs(p-g)<s&&(y=!1),y&&(n[f]=n[d],n[f+1]=n[d+1],f+=2)}n.length=l=f,f=2;for(let d=2;d+2<l;d+=2){let c=n[d-2],p=n[d-1];const v=n[d],g=n[d+1];let y=n[d+2],b=n[d+3];c-=v,p-=g,y-=v,b-=g;let _=!0;Math.abs(y*p-b*c)<o&&c*y+p*b<-o&&(_=!1),_&&(n[f]=n[d],n[f+1]=n[d+1],f+=2)}n[f]=n[l-2],n[f+1]=n[l-1],f+=2,n.length=l=f,!(l<=2)&&u&&Math.abs(a.x-h.x)<s&&Math.abs(a.y-h.y)<s&&(n.pop(),n.pop())}line(t,e){const{closeStroke:i,points:n}=t,s=e.closePointEps,o=n.length;if(o<=2)return;const{verts:a,joints:h}=e,u=t.jointType(),l=t.capType();let f=0,d,c;i?(d=n[o-2],c=n[o-1],h.push(N.NONE)):(d=n[2],c=n[3],l===N.CAP_ROUND?(a.push(n[0],n[1]),h.push(N.NONE),h.push(N.CAP_ROUND),f=0):(f=l,h.push(N.NONE))),a.push(d,c);for(let p=0;p<o;p+=2){const v=n[p],g=n[p+1];let y,b;p+2<o?(y=n[p+2],b=n[p+3]):(y=n[0],b=n[1]);const _=y-v,T=b-g;let m,x,A=u;p+2>=o?(m=n[2],x=n[3],i||(A=N.NONE)):p+4>=o?(m=n[0],x=n[1],i||(l===N.CAP_ROUND&&(A=N.JOINT_CAP_ROUND),l===N.CAP_BUTT&&(A=N.JOINT_CAP_BUTT),l===N.CAP_SQUARE&&(A=N.JOINT_CAP_SQUARE))):(m=n[p+4],x=n[p+5]);const S=v-d,I=g-c;if(u>=N.JOINT_BEVEL&&u<=N.JOINT_MITER){const E=m-y,k=x-b;if(A>=N.JOINT_BEVEL&&A<=N.JOINT_MITER+3){const w=E*T-k*_;if(Math.abs(w)<s)switch(u&-4){case N.JOINT_ROUND:A=N.JOINT_CAP_ROUND;break;default:A=N.JOINT_CAP_BUTT;break}}if(u===N.JOINT_MITER){let w=0;S*_+I*T>-s&&w++,A===N.JOINT_MITER&&E*_+k*T>-s&&(w+=2),A+=w}}f===0&&Math.abs(S*T-I*_)<s&&(f=N.CAP_BUTT2),A+=f,f=0,a.push(v,g),h.push(A),d=v,c=g}i?(a.push(n[0],n[1]),h.push(N.NONE),a.push(n[2],n[3]),h.push(N.NONE)):(a.push(n[o-4],n[o-3]),h.push(N.NONE))}fill(t,e){let i=t.points;const n=t.holes,s=e.closePointEps,{verts:o,joints:a}=e;if(i.length<6)return;const h=[];let u=i.length;for(let c=0;c<n.length;c++){const p=n[c];h.push(i.length/2),i=i.concat(p.points)}const l=bg;l.length<i.length&&(l.length=i.length);const f=0;for(let c=0;c<=h.length;c++){let p=u/2;c>0&&(c<h.length?p=h[c]:p=i.length>>1),l[f*2]=p-1,l[(p-1)*2+1]=0;for(let v=f;v+1<p;v++)l[v*2+1]=v+1,l[v*2+2]=v}if(t.triangles=be(i,h,2),!t.triangles)return;if(!t.fillAA){for(let c=0;c<i.length;c+=2)o.push(i[c],i[c+1]),a.push(N.FILL);return}const{triangles:d}=t;u=i.length;for(let c=0;c<d.length;c+=3){let p=0;for(let v=0;v<3;v++){const g=d[c+v],y=d[c+(v+1)%3];(l[g*2]===y||l[g*2+1]===y)&&(p|=1<<v)}a.push(N.FILL_EXPAND+p),a.push(N.NONE),a.push(N.NONE),a.push(N.NONE),a.push(N.NONE),a.push(N.NONE)}for(let c=0;c<u/2;c++){const p=l[c*2],v=l[c*2+1];let g=i[v*2+1]-i[c*2+1],y=-(i[v*2]-i[c*2]),b=i[c*2+1]-i[p*2+1],_=-(i[c*2]-i[p*2]);const T=Math.sqrt(g*g+y*y);g/=T,y/=T;const m=Math.sqrt(b*b+_*_);b/=m,_/=m;let x=g+b,A=y+_;const S=x*g+A*y;Math.abs(S)<s?(x=g,A=y):(x/=S,A/=S),l[c*2]=x,l[c*2+1]=A}for(let c=0;c<d.length;c+=3){const p=d[c],v=d[c+1],g=d[c+2],y=i[g*2+1]-i[v*2+1],b=-(i[g*2]-i[v*2]),_=i[v*2+1]-i[p*2+1],T=-(i[v*2]-i[p*2]);let m=1;y*T-_*b>0&&(m=2);for(let x=0;x<3;x++){const A=d[c+x*m%3];o.push(i[A*2],i[A*2+1])}for(let x=0;x<3;x++){const A=d[c+x*m%3];o.push(l[A*2],l[A*2+1])}}}}const bo={[J.POLY]:new xg,[J.CIRC]:new _o,[J.ELIP]:new _o,[J.RECT]:new mg,[J.RREC]:new _g},xo=[],Di=[],Ne=new V,wg=new Ge;class cr extends gi{static __initStatic(){this.BATCHABLE_SIZE=100}__init(){this.indicesUint16=null}get points(){return this.buildData.verts}get closePointEps(){return this.buildData.closePointEps}initAttributes(t){this._buffer=new xt(null,t,!1),this._bufferFloats=new Float32Array,this._bufferUint=new Uint32Array,this._indexBuffer=new xt(null,t,!0),this.addAttribute("aPrev",this._buffer,2,!1,W.FLOAT).addAttribute("aPoint1",this._buffer,2,!1,W.FLOAT).addAttribute("aPoint2",this._buffer,2,!1,W.FLOAT).addAttribute("aNext",this._buffer,2,!1,W.FLOAT).addAttribute("aTravel",this._buffer,1,!1,W.FLOAT).addAttribute("aVertexJoint",this._buffer,1,!1,W.FLOAT).addAttribute("aStyleId",this._buffer,1,!1,W.FLOAT).addAttribute("aColor",this._buffer,4,!0,W.UNSIGNED_BYTE).addIndex(this._indexBuffer),this.strideFloats=12}constructor(){super(),cr.prototype.__init.call(this),this.initAttributes(!1),this.buildData=new ce,this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeBuildIndex=0,this.shapeBatchIndex=0,this._bounds=new Ge,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.packer=null,this.packSize=0,this.pack32index=null}checkInstancing(t,e){this.packer||(this.packer=new Pt,this.pack32index=e)}get bounds(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeBuildIndex=0,this.shapeBatchIndex=0,this.packSize=0,this.buildData.clear();for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].clear(),Di.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),xo.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,n=null){const s=new tr(t,e,i,n);return this.graphicsData.push(s),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new tr(t,null,null,e),n=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=n.lineStyle,n.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.buildData.destroy(),this.buildData=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const n=e[i];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(t,Ne):Ne.copyFrom(t),n.shape.contains(Ne.x,Ne.y))){let s=!1;if(n.holes){for(let o=0;o<n.holes.length;o++)if(n.holes[o].shape.contains(Ne.x,Ne.y)){s=!0;break}}if(!s)return!0}}return!1}updatePoints(){}updateBufferSize(){this._buffer.update(new Float32Array)}updateBuild(){const{graphicsData:t,buildData:e}=this,i=t.length;for(let n=this.shapeBuildIndex;n<i;n++){const s=t[n];s.strokeStart=0,s.strokeLen=0,s.fillStart=0,s.fillLen=0;const{fillStyle:o,lineStyle:a,holes:h}=s;if(!o.visible&&!a.visible)continue;const u=bo[s.type];s.clearPath(),u.path(s,e),s.matrix&&this.transformPoints(s.points,s.matrix),s.clearBuild(),!(s.points.length<=2)&&(o.visible&&(h.length&&this.processHoles(h),s.fillAA=s.fillStyle.smooth&&!(s.lineStyle.visible&&s.lineStyle.alpha>=.99&&s.lineStyle.width>=.99),s.fillStart=e.joints.length,u.fill(s,e),s.fillLen=e.joints.length-s.fillStart),a.visible&&(s.strokeStart=e.joints.length,u.line(s,e),s.strokeLen=e.joints.length-s.strokeStart))}this.shapeBuildIndex=i}updateBatches(t){if(!this.graphicsData.length){this.batchable=!0;return}if(this.updateBuild(),!this.validateBatching())return;const{buildData:e,graphicsData:i}=this,n=i.length;this.cacheDirty=this.dirty;let s=null,o=null;this.batches.length>0&&(s=this.batches[this.batches.length-1],o=s.style);for(let a=this.shapeBatchIndex;a<n;a++){const h=i[a],u=h.fillStyle,l=h.lineStyle;if(h.matrix&&this.transformPoints(h.points,h.matrix),!(!u.visible&&!l.visible))for(let f=0;f<2;f++){const d=f===0?u:l;if(!d.visible)continue;const c=d.texture.baseTexture,p=e.vertexSize,v=e.indexSize;c.wrapMode=ke.REPEAT,f===0?this.packer.updateBufferSize(h.fillStart,h.fillLen,h.triangles.length,e):this.packer.updateBufferSize(h.strokeStart,h.strokeLen,h.triangles.length,e),e.vertexSize!==p&&(s&&!this._compareStyles(o,d)&&(s.end(v,p),s=null),s||(s=xo.pop()||new yg,s.begin(d,v,p),this.batches.push(s),o=d),f===0?s.jointEnd=h.fillStart+h.fillLen:s.jointEnd=h.strokeStart+h.strokeLen)}}if(this.shapeBatchIndex=n,s&&s.end(e.indexSize,e.vertexSize),this.batches.length===0){this.batchable=!0;return}this.batchable=this.isBatchable(),this.batchable?this.packBatches():(this.buildDrawCalls(t),this.updatePack())}updatePack(){const{vertexSize:t,indexSize:e}=this.buildData;if(this.packSize===t)return;const{strideFloats:i,packer:n,buildData:s,batches:o}=this,a=this._buffer,h=this._indexBuffer,u=t*i;if(a.data.length!==u){const f=new ArrayBuffer(u*4);this._bufferFloats=new Float32Array(f),this._bufferUint=new Uint32Array(f),a.data=this._bufferFloats}h.data.length!==e&&(t>65535&&this.pack32index?h.data=new Uint32Array(e):h.data=new Uint16Array(e)),n.beginPack(s,this._bufferFloats,this._bufferUint,h.data);let l=0;for(let f=0;f<this.graphicsData.length;f++){const d=this.graphicsData[f];if(d.fillLen){for(;o[l].jointEnd<=d.fillStart;)l++;n.packInterleavedGeometry(d.fillStart,d.fillLen,d.triangles,o[l].styleId,o[l].rgba)}if(d.strokeLen){for(;o[l].jointEnd<=d.strokeStart;)l++;n.packInterleavedGeometry(d.strokeStart,d.strokeLen,d.triangles,o[l].styleId,o[l].rgba)}}a.update(),h.update(),this.packSize=t}_compareStyles(t,e){if(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||t.packLineWidth()!==e.packLineWidth()||t.alignment!==e.alignment)return!1;const i=t.matrix||vt.IDENTITY,n=e.matrix||vt.IDENTITY;return Da(i,n)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const i=this.graphicsData[t],n=i.fillStyle,s=i.lineStyle;if(n&&!n.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++;const t=this.batches;for(let e=0,i=t.length;e<i;e++){const n=t[e];for(let s=0;s<n.size;s++){const o=n.start+s;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}}}isBatchable(){return!1}buildDrawCalls(t){for(let n=0;n<this.drawCalls.length;n++)this.drawCalls[n].clear(),Di.push(this.drawCalls[n]);this.drawCalls.length=0;let e=Di.pop()||new mo;e.begin(t,null);let i=0;this.drawCalls.push(e);for(let n=0;n<this.batches.length;n++){const s=this.batches[n],o=s.style;if(s.attribSize===0)continue;let a=-1;const h=o.getTextureMatrix();e.check(o.shader)&&(a=e.add(o.texture,h,o.packLineWidth(),o.alignment||0)),a<0&&(e=Di.pop()||new mo,this.drawCalls.push(e),e.begin(t,o.shader),e.start=i,a=e.add(o.texture,h,o.packLineWidth(),o.alignment||0)),e.size+=s.size,i+=s.size;const{color:u,alpha:l}=o,f=(u>>16)+(u&65280)+((u&255)<<16);s.rgba=Rn(f,l),s.styleId=a}}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];bo[i.type].path(i,this.buildData),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds,e=wg;let i=vt.IDENTITY;this._bounds.clear(),e.clear();for(let n=0;n<this.graphicsData.length;n++){const s=this.graphicsData[n],o=s.shape,a=s.type,h=s.lineStyle,u=s.matrix||vt.IDENTITY;let l=0;if(h&&h.visible){const f=h.alignment;l=h.width,a===J.POLY?l=l*(.5+Math.abs(.5-f)):l=l*Math.max(0,f)}if(i!==u&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=u),a===J.RECT||a===J.RREC){const f=o;e.addFramePad(f.x,f.y,f.x+f.width,f.y+f.height,l,l)}else if(a===J.CIRC){const f=o;e.addFramePad(f.x,f.y,f.x,f.y,f.radius+l,f.radius+l)}else if(a===J.ELIP){const f=o;e.addFramePad(f.x,f.y,f.x,f.y,f.width+l,f.height+l)}else{const f=o;t.addVerticesMatrix(i,f.points,0,f.points.length,l,l)}}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const n=t[i*2],s=t[i*2+1];t[i*2]=e.a*n+e.c*s+e.tx,t[i*2+1]=e.b*n+e.d*s+e.ty}}}cr.__initStatic();const Eg=`precision highp float;
const float FILL = 1.0;
const float BEVEL = 4.0;
const float MITER = 8.0;
const float ROUND = 12.0;
const float JOINT_CAP_BUTT = 16.0;
const float JOINT_CAP_SQUARE = 18.0;
const float JOINT_CAP_ROUND = 20.0;

const float FILL_EXPAND = 24.0;

const float CAP_BUTT = 1.0;
const float CAP_SQUARE = 2.0;
const float CAP_ROUND = 3.0;
const float CAP_BUTT2 = 4.0;

const float MITER_LIMIT = 10.0;

// === geom ===
attribute vec2 aPrev;
attribute vec2 aPoint1;
attribute vec2 aPoint2;
attribute vec2 aNext;
attribute float aVertexJoint;
attribute float aTravel;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec4 vSignedCoord;
varying vec4 vDistance;
varying float vType;

uniform float resolution;
uniform float expand;

// === style ===
attribute float aStyleId;
attribute vec4 aColor;

varying float vTextureId;
varying vec4 vColor;
varying vec2 vTextureCoord;
varying float vTravel;

uniform vec2 styleLine[%MAX_STYLES%];
uniform vec3 styleMatrix[2 * %MAX_STYLES%];
uniform float styleTextureId[%MAX_STYLES%];
uniform vec2 samplerSize[%MAX_TEXTURES%];

vec2 doBisect(vec2 norm, float len, vec2 norm2, float len2,
    float dy, float inner) {
    vec2 bisect = (norm + norm2) / 2.0;
    bisect /= dot(norm, bisect);
    vec2 shift = dy * bisect;
    if (inner > 0.5) {
        if (len < len2) {
            if (abs(dy * (bisect.x * norm.y - bisect.y * norm.x)) > len) {
                return dy * norm;
            }
        } else {
            if (abs(dy * (bisect.x * norm2.y - bisect.y * norm2.x)) > len2) {
                return dy * norm;
            }
        }
    }
    return dy * bisect;
}

void main(void){
    vec2 pointA = (translationMatrix * vec3(aPoint1, 1.0)).xy;
    vec2 pointB = (translationMatrix * vec3(aPoint2, 1.0)).xy;

    vec2 xBasis = pointB - pointA;
    float len = length(xBasis);
    vec2 forward = xBasis / len;
    vec2 norm = vec2(forward.y, -forward.x);

    float type = floor(aVertexJoint / 16.0);
    float vertexNum = aVertexJoint - type * 16.0;
    float dx = 0.0, dy = 1.0;


    vec2 avgDiag = (translationMatrix * vec3(1.0, 1.0, 0.0)).xy;
    float avgScale = sqrt(dot(avgDiag, avgDiag) * 0.5);

    float capType = floor(type / 32.0);
    type -= capType * 32.0;

    int styleId = int(aStyleId + 0.5);
    float lineWidth = styleLine[styleId].x;
    if (lineWidth < 0.0) {
        lineWidth = -lineWidth;
    } else {
        lineWidth = lineWidth * avgScale;
    }
    lineWidth *= 0.5;
    float lineAlignment = 2.0 * styleLine[styleId].y - 1.0;
    vTextureId = styleTextureId[styleId];
    vTextureCoord = vec2(0.0);

    vec2 pos;

    if (capType == CAP_ROUND) {
        vertexNum += 4.0;
        type = JOINT_CAP_ROUND;
        capType = 0.0;
    }

    if (type == FILL) {
        pos = pointA;
        vDistance = vec4(0.0, -0.5, -0.5, 1.0);
        vType = 0.0;

        vec2 vTexturePixel;
        vTexturePixel.x = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2]);
        vTexturePixel.y = dot(vec3(aPoint1, 1.0), styleMatrix[styleId * 2 + 1]);
        vTextureCoord = vTexturePixel / samplerSize[int(vTextureId)];
    } else if (type >= FILL_EXPAND && type < FILL_EXPAND + 7.5) {
        // expand vertices
        float flags = type - FILL_EXPAND;
        float flag3 = floor(flags / 4.0);
        float flag2 = floor((flags - flag3 * 4.0) / 2.0);
        float flag1 = flags - flag3 * 4.0 - flag2 * 2.0;

        vec2 prev = (translationMatrix * vec3(aPrev, 1.0)).xy;

        if (vertexNum < 0.5) {
            pos = prev;
        } else if (vertexNum < 1.5) {
            pos = pointA;
        } else {
            pos = pointB;
        }
        float len2 = length(aNext);
        vec2 bisect = (translationMatrix * vec3(aNext, 0.0)).xy;
        if (len2 > 0.01) {
            bisect = normalize(bisect) * len2;
        }

        vec2 n1 = normalize(vec2(pointA.y - prev.y, -(pointA.x - prev.x)));
        vec2 n2 = normalize(vec2(pointB.y - pointA.y, -(pointB.x - pointA.x)));
        vec2 n3 = normalize(vec2(prev.y - pointB.y, -(prev.x - pointB.x)));

        if (n1.x * n2.y - n1.y * n2.x < 0.0) {
            n1 = -n1;
            n2 = -n2;
            n3 = -n3;
        }

        vDistance.w = 1.0;
        pos += bisect * expand;

        vDistance = vec4(16.0, 16.0, 16.0, -1.0);
        if (flag1 > 0.5) {
            vDistance.x = -dot(pos - prev, n1);
        }
        if (flag2 > 0.5) {
            vDistance.y = -dot(pos - pointA, n2);
        }
        if (flag3 > 0.5) {
            vDistance.z = -dot(pos - pointB, n3);
        }
        vDistance.xyz *= resolution;
        vType = 2.0;
    } else if (type >= BEVEL) {
        float dy = lineWidth + expand;
        float inner = 0.0;
        if (vertexNum >= 1.5) {
            dy = -dy;
            inner = 1.0;
        }

        vec2 base, next, xBasis2, bisect;
        float flag = 0.0;
        float sign2 = 1.0;
        if (vertexNum < 0.5 || vertexNum > 2.5 && vertexNum < 3.5) {
            next = (translationMatrix * vec3(aPrev, 1.0)).xy;
            base = pointA;
            flag = type - floor(type / 2.0) * 2.0;
            sign2 = -1.0;
        } else {
            next = (translationMatrix * vec3(aNext, 1.0)).xy;
            base = pointB;
            if (type >= MITER && type < MITER + 3.5) {
                flag = step(MITER + 1.5, type);
                // check miter limit here?
            }
        }
        xBasis2 = next - base;
        float len2 = length(xBasis2);
        vec2 norm2 = vec2(xBasis2.y, -xBasis2.x) / len2;
        float D = norm.x * norm2.y - norm.y * norm2.x;
        if (D < 0.0) {
            inner = 1.0 - inner;
        }

        norm2 *= sign2;

        if (abs(lineAlignment) > 0.01) {
            float shift = lineWidth * lineAlignment;
            pointA += norm * shift;
            pointB += norm * shift;
            if (abs(D) < 0.01) {
                base += norm * shift;
            } else {
                base += doBisect(norm, len, norm2, len2, shift, 0.0);
            }
        }

        float collinear = step(0.0, dot(norm, norm2));

        vType = 0.0;
        float dy2 = -1000.0;
        float dy3 = -1000.0;

        if (abs(D) < 0.01 && collinear < 0.5) {
            if (type >= ROUND && type < ROUND + 1.5) {
                type = JOINT_CAP_ROUND;
            }
            //TODO: BUTT here too
        }

        if (vertexNum < 3.5) {
            if (abs(D) < 0.01) {
                pos = dy * norm;
            } else {
                if (flag < 0.5 && inner < 0.5) {
                    pos = dy * norm;
                } else {
                    pos = doBisect(norm, len, norm2, len2, dy, inner);
                }
            }
            if (capType >= CAP_BUTT && capType < CAP_ROUND) {
                float extra = step(CAP_SQUARE, capType) * lineWidth;
                vec2 back = -forward;
                if (vertexNum < 0.5 || vertexNum > 2.5) {
                    pos += back * (expand + extra);
                    dy2 = expand;
                } else {
                    dy2 = dot(pos + base - pointA, back) - extra;
                }
            }
            if (type >= JOINT_CAP_BUTT && type < JOINT_CAP_SQUARE + 0.5) {
                float extra = step(JOINT_CAP_SQUARE, type) * lineWidth;
                if (vertexNum < 0.5 || vertexNum > 2.5) {
                    dy3 = dot(pos + base - pointB, forward) - extra;
                } else {
                    pos += forward * (expand + extra);
                    dy3 = expand;
                    if (capType >= CAP_BUTT) {
                        dy2 -= expand + extra;
                    }
                }
            }
        } else if (type >= JOINT_CAP_ROUND && type < JOINT_CAP_ROUND + 1.5) {
            if (inner > 0.5) {
                dy = -dy;
                inner = 0.0;
            }
            vec2 d2 = abs(dy) * vec2(-norm.y, norm.x);
            if (vertexNum < 4.5) {
                dy = -dy;
                pos = dy * norm;
            } else if (vertexNum < 5.5) {
                pos = dy * norm;
            } else if (vertexNum < 6.5) {
                pos = dy * norm + d2;
            } else {
                dy = -dy;
                pos = dy * norm + d2;
            }
            dy = -0.5;
            dy2 = pos.x;
            dy3 = pos.y;
            vType = 3.0;
        } else if (abs(D) < 0.01) {
            pos = dy * norm;
        } else {
            if (type >= ROUND && type < ROUND + 1.5) {
                if (inner > 0.5) {
                    dy = -dy;
                    inner = 0.0;
                }
                if (vertexNum < 4.5) {
                    pos = doBisect(norm, len, norm2, len2, -dy, 1.0);
                } else if (vertexNum < 5.5) {
                    pos = dy * norm;
                } else if (vertexNum > 7.5) {
                    pos = dy * norm2;
                } else {
                    pos = doBisect(norm, len, norm2, len2, dy, 0.0);
                    float d2 = abs(dy);
                    if (length(pos) > abs(dy) * 1.5) {
                        if (vertexNum < 6.5) {
                            pos.x = dy * norm.x - d2 * norm.y;
                            pos.y = dy * norm.y + d2 * norm.x;
                        } else {
                            pos.x = dy * norm2.x + d2 * norm2.y;
                            pos.y = dy * norm2.y - d2 * norm2.x;
                        }
                    }
                }
                vec2 norm3 = normalize(norm - norm2);
                dy = pos.x * norm3.y - pos.y * norm3.x - 3.0;
                dy2 = pos.x;
                dy3 = pos.y;
                vType = 3.0;
            } else {
                if (type >= MITER && type < MITER + 3.5) {
                    if (inner > 0.5) {
                        dy = -dy;
                        inner = 0.0;
                    }
                    float sign = step(0.0, dy) * 2.0 - 1.0;
                    pos = doBisect(norm, len, norm2, len2, dy, 0.0);
                    if (length(pos) > abs(dy) * MITER_LIMIT) {
                        type = BEVEL;
                    } else {
                        if (vertexNum < 4.5) {
                            dy = -dy;
                            pos = doBisect(norm, len, norm2, len2, dy, 1.0);
                        } else if (vertexNum < 5.5) {
                            pos = dy * norm;
                        } else if (vertexNum > 6.5) {
                            pos = dy * norm2;
                            // dy = ...
                        }
                    }
                    vType = 1.0;
                    dy = -sign * dot(pos, norm);
                    dy2 = -sign * dot(pos, norm2);
                }
                if (type >= BEVEL && type < BEVEL + 1.5) {
                    if (inner < 0.5) {
                        dy = -dy;
                        inner = 1.0;
                    }
                    vec2 norm3 = normalize((norm + norm2) / 2.0);
                    if (vertexNum < 4.5) {
                        pos = doBisect(norm, len, norm2, len2, dy, 1.0);
                        dy2 = -abs(dot(pos + dy * norm, norm3));
                    } else {
                        dy2 = 0.0;
                        dy = -dy;
                        if (vertexNum < 5.5) {
                            pos = dy * norm;
                        } else {
                            pos = dy * norm2;
                        }
                    }
                }
            }
        }

        pos += base;
        vDistance = vec4(dy, dy2, dy3, lineWidth) * resolution;
        vTravel = aTravel * avgScale + dot(pos - pointA, vec2(-norm.y, norm.x));
    }

    gl_Position = vec4((projectionMatrix * vec3(pos, 1.0)).xy, 0.0, 1.0);

    vColor = aColor * tint;
}`,Tg=`
varying vec4 vColor;
varying vec4 vDistance;
varying float vType;
varying float vTextureId;
varying vec2 vTextureCoord;
varying float vTravel;
uniform sampler2D uSamplers[%MAX_TEXTURES%];

void main(void){
    float alpha = 1.0;
    float lineWidth = vDistance.w;
    if (vType < 0.5) {
        float left = max(vDistance.x - 0.5, -vDistance.w);
        float right = min(vDistance.x + 0.5, vDistance.w);
        float near = vDistance.y - 0.5;
        float far = min(vDistance.y + 0.5, 0.0);
        float top = vDistance.z - 0.5;
        float bottom = min(vDistance.z + 0.5, 0.0);
        alpha = max(right - left, 0.0) * max(bottom - top, 0.0) * max(far - near, 0.0);
    } else if (vType < 1.5) {
        float a1 = clamp(vDistance.x + 0.5 - lineWidth, 0.0, 1.0);
        float a2 = clamp(vDistance.x + 0.5 + lineWidth, 0.0, 1.0);
        float b1 = clamp(vDistance.y + 0.5 - lineWidth, 0.0, 1.0);
        float b2 = clamp(vDistance.y + 0.5 + lineWidth, 0.0, 1.0);
        alpha = a2 * b2 - a1 * b1;
    } else if (vType < 2.5) {
        alpha *= max(min(vDistance.x + 0.5, 1.0), 0.0);
        alpha *= max(min(vDistance.y + 0.5, 1.0), 0.0);
        alpha *= max(min(vDistance.z + 0.5, 1.0), 0.0);
    } else {
        float dist2 = sqrt(dot(vDistance.yz, vDistance.yz));
        float rad = vDistance.w;
        float left = max(dist2 - 0.5, -rad);
        float right = min(dist2 + 0.5, rad);
        // TODO: something has to be done about artifact at vDistance.x far side
        alpha = 1.0 - step(vDistance.x, 0.0) * (1.0 - max(right - left, 0.0));
    }

    vec4 texColor;
    float textureId = floor(vTextureId+0.5);
    %FOR_LOOP%

    gl_FragColor = vColor * texColor * alpha;
}
`;class Ig extends yi{constructor(t,e=Eg,i=Tg,n={}){const{maxStyles:s,maxTextures:o}=t;e=e.replace(/%MAX_TEXTURES%/gi,`${o}`).replace(/%MAX_STYLES%/gi,`${s}`),i=i.replace(/%MAX_TEXTURES%/gi,`${o}`).replace(/%FOR_LOOP%/gi,ka.generateSampleSrc(o)),super(e,i),this.settings=t}}class ka extends mi{constructor(t,e=new Ig(t),i={}){const{maxStyles:n,maxTextures:s}=t,o=new Int32Array(s);for(let a=0;a<s;a++)o[a]=a;super(e,Object.assign(i,{styleMatrix:new Float32Array(6*n),styleTextureId:new Float32Array(n),styleLine:new Float32Array(2*n),samplerSize:new Float32Array(2*s),uSamplers:o,tint:new Float32Array([1,1,1,1]),resolution:1,expand:1})),this.settings=t}static generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(textureId < ${i}.5)`),e+=`
{`,e+=`
	texColor = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}const ei={LINE_SCALE_MODE:Xt.NORMAL,SHADER_MAX_STYLES:24,SHADER_MAX_TEXTURES:4},{BezierUtils:Ag,QuadraticUtils:Og,ArcUtils:wo}=vg,Sg=new Float32Array(3),$r={};class me extends dt{static __initStatic(){this._TEMP_POINT=new V}get geometry(){return this._geometry}constructor(t=null){super(),this._geometry=t||new cr,this._geometry.refCount++,this.shader=null,this.shaderSettings={maxStyles:ei.SHADER_MAX_STYLES,maxTextures:ei.SHADER_MAX_TEXTURES},this.state=$e.for2d(),this._fillStyle=new dr,this._lineStyle=new zn,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this.pluginName="smooth",this._transformID=-1,this.tint=16777215,this.blendMode=G.NORMAL}clone(){return this.finishPoly(),new me(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(t){this._tint=t}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i=1,n=.5,s=ei.LINE_SCALE_MODE){if(typeof t=="number")typeof s=="boolean"&&(s=s?Xt.NONE:Xt.NORMAL),t={width:t,color:e,alpha:i,alignment:n,scaleMode:s};else{const o=t.native;o!==void 0&&(t.scaleMode=o?Xt.NONE:Xt.NORMAL)}return this.lineTextureStyle(t)}lineTextureStyle(t){t=Object.assign({width:0,texture:Z.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Rt.BUTT,join:Ot.MITER,miterLimit:10,shader:null,scaleMode:ei.LINE_SCALE_MODE},t),this.currentPath&&this.startPoly();const e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new te,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new te,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,n=i[i.length-2],s=i[i.length-1];return(n!==t||s!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,n){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),Og.curveTo(t,e,i,n,s),this}bezierCurveTo(t,e,i,n,s,o){return this._initCurve(),Ag.curveTo(t,e,i,n,s,o,this.currentPath.points),this}arcTo(t,e,i,n,s){this._initCurve(t,e);const o=this.currentPath.points,a=wo.curveTo(t,e,i,n,s,o);if(a){const{cx:h,cy:u,radius:l,startAngle:f,endAngle:d,anticlockwise:c}=a;this.arc(h,u,l,f,d,c)}return this}arc(t,e,i,n,s,o=!1){if(n===s)return this;if(!o&&s<=n?s+=we:o&&n<=s&&(n+=we),s-n===0)return this;const h=t+Math.cos(n)*i,u=e+Math.sin(n)*i,l=this._geometry.closePointEps;let f=this.currentPath?this.currentPath.points:null;if(f){const d=Math.abs(f[f.length-2]-h),c=Math.abs(f[f.length-1]-u);d<l&&c<l||f.push(h,u)}else this.moveTo(h,u),f=this.currentPath.points;return wo.arc(h,u,t,e,i,n,s,o,f),this}beginFill(t=0,e=1,i=!1){return this.beginTextureFill({texture:Z.WHITE,color:t,alpha:e,smooth:i})}beginTextureFill(t){t=Object.assign({texture:Z.WHITE,color:16777215,alpha:1,matrix:null,smooth:!1},t),this.currentPath&&this.startPoly();const e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,n){return this.drawShape(new Y(t,e,i,n))}drawRoundedRect(t,e,i,n,s){return this.drawShape(new ea(t,e,i,n,s))}drawCircle(t,e,i){return this.drawShape(new Mn(t,e,i))}drawEllipse(t,e,i,n){return this.drawShape(new ta(t,e,i,n))}drawPolygon(...t){let e,i=!0;const n=t[0];n.points?(i=n.closeStroke,e=n.points):Array.isArray(t[0])?e=t[0]:e=t;const s=new te(e);return s.closeStroke=i,this.drawShape(s),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===J.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_renderCanvas(t){pg.prototype._renderCanvas.call(this,t)}_render(t){this.finishPoly();const e=this._geometry,i=t.context.supports.uint32Indices;e.checkInstancing(t.geometry.hasInstance,i),e.updateBatches(this.shaderSettings),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let n=0;n<i;n++){const s=t.batches[n],o=s.style.color,h={vertexData:new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),blendMode:e,_batchRGB:xe(o),_tintRGB:o,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[n]=h}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const n=this.batches[e];n.worldAlpha=this.worldAlpha*n.alpha,t.plugins[this.pluginName].render(n)}}}_renderDirect(t){const e=this._resolveDirectShader(t);let i=e;const n=this._geometry,s=this.tint,o=this.worldAlpha,a=i.uniforms,h=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(s>>16&255)/255*o,a.tint[1]=(s>>8&255)/255*o,a.tint[2]=(s&255)/255*o,a.tint[3]=o,a.resolution=t.renderTexture.current?t.renderTexture.current.resolution:t.resolution;const u=t.projection.transform;if(u){const l=Math.sqrt(u.a*u.a+u.b*u.b);a.resolution*=l}a.expand=(t.options.antialias?2:1)/a.resolution,t.shader.bind(i),t.geometry.bind(n,i),t.state.set(this.state),i=null;for(let l=0,f=h.length;l<f;l++){const d=n.drawCalls[l],c=i!==d.shader;c&&(i=d.shader,i&&(i.uniforms.translationMatrix=this.transform.worldTransform,i.uniforms.tint&&(i.uniforms.tint[0]=a.tint[0],i.uniforms.tint[1]=a.tint[1],i.uniforms.tint[2]=a.tint[2],i.uniforms.tint[3]=a.tint[3])));const{texArray:p,styleArray:v,size:g,start:y}=d,b=p.count,_=i||e,T=_.uniforms.styleTextureId,m=_.uniforms.styleMatrix,x=_.uniforms.styleLine;for(let S=0;S<v.count;S++){T[S]=v.textureIds[S],x[S*2]=v.lines[S*2],x[S*2+1]=v.lines[S*2+1];const I=v.matrices[S];m[S*6]=I.a,m[S*6+1]=I.c,m[S*6+2]=I.tx,m[S*6+3]=I.b,m[S*6+4]=I.d,m[S*6+5]=I.ty}const A=_.uniforms.samplerSize;for(let S=0;S<b;S++)A[S*2]=p.elements[S].width,A[S*2+1]=p.elements[S].height;t.shader.bind(_),c&&t.geometry.bind(n);for(let S=0;S<b;S++)t.texture.bind(p.elements[S],S);t.geometry.draw(Lt.TRIANGLES,g,y)}}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;return e||($r[i]||($r[i]=new ka(this.shaderSettings)),e=$r[i]),e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:n,maxY:s}=t.bounds;this._bounds.addFrame(this.transform,e,i,n,s)}containsPoint(t){return this.worldTransform.applyInverse(t,me._TEMP_POINT),this._geometry.containsPoint(me._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const t=xe(this.tint,Sg);for(let e=0;e<this.batches.length;e++){const i=this.batches[e],n=i._batchRGB,s=t[0]*n[0]*255,o=t[1]*n[1]*255,a=t[2]*n[2]*255,h=(s<<16)+(o<<8)+(a|0);i._tintRGB=(h>>16)+(h&65280)+((h&255)<<16)}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,n=e.b,s=e.c,o=e.d,a=e.tx,h=e.ty,u=this._geometry.points,l=this.vertexData;let f=0;for(let d=0;d<u.length;d+=2){const c=u[d],p=u[d+1];l[f++]=i*c+s*p+a,l[f++]=o*p+n*c+h}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}drawStar(t,e,i,n,s,o=0){return this.drawPolygon(new Ng(t,e,i,n,s,o))}}me.__initStatic();class Ng extends te{constructor(t,e,i,n,s,o=0){s=s||n/2;const a=-1*Math.PI/2+o,h=i*2,u=we/h,l=[];for(let f=0;f<h;f++){const d=f%2?s:n,c=f*u+a;l.push(t+d*Math.cos(c),e+d*Math.sin(c))}super(l)}}/*!
 * @pixi/mixin-get-child-by-name - v6.1.2
 * Compiled Thu, 12 Aug 2021 17:11:19 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */He.prototype.name=null;dt.prototype.getChildByName=function(t,e){for(var i=0,n=this.children.length;i<n;i++)if(this.children[i].name===t)return this.children[i];if(e)for(var i=0,n=this.children.length;i<n;i++){var s=this.children[i];if(s.getChildByName){var o=this.children[i].getChildByName(t,!0);if(o)return o}}return null};var Eo={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},To={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function Cg(r){var t,e=[],i=1,n;if(typeof r=="string")if(Eo[r])e=Eo[r].slice(),n="rgb";else if(r==="transparent")i=0,n="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(r)){var s=r.slice(1),o=s.length,a=o<=4;i=1,a?(e=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],o===4&&(i=parseInt(s[3]+s[3],16)/255)):(e=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],o===8&&(i=parseInt(s[6]+s[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),n="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(r)){var h=t[1],u=h==="rgb",s=h.replace(/a$/,"");n=s;var o=s==="cmyk"?4:s==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(d,c){if(/%$/.test(d))return c===o?parseFloat(d)/100:s==="rgb"?parseFloat(d)*255/100:parseFloat(d);if(s[c]==="h"){if(/deg$/.test(d))return parseFloat(d);if(To[d]!==void 0)return To[d]}return parseFloat(d)}),h===s&&e.push(1),i=u||e[o]===void 0?1:e[o],e=e.slice(0,o)}else r.length>10&&/[0-9](?:\s|\/)/.test(r)&&(e=r.match(/([0-9]+)/g).map(function(l){return parseFloat(l)}),n=r.match(/([a-z])/ig).join("").toLowerCase());else isNaN(r)?Array.isArray(r)||r.length?(e=[r[0],r[1],r[2]],n="rgb",i=r.length===4?r[3]:1):r instanceof Object&&(r.r!=null||r.red!=null||r.R!=null?(n="rgb",e=[r.r||r.red||r.R||0,r.g||r.green||r.G||0,r.b||r.blue||r.B||0]):(n="hsl",e=[r.h||r.hue||r.H||0,r.s||r.saturation||r.S||0,r.l||r.lightness||r.L||r.b||r.brightness]),i=r.a||r.alpha||r.opacity||1,r.opacity!=null&&(i/=100)):(n="rgb",e=[r>>>16,(r&65280)>>>8,r&255]);return{space:n,values:e,alpha:i}}var Pg={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(r){var t=r[0]/360,e=r[1]/100,i=r[2]/100,n,s,o,a,h;if(e===0)return h=i*255,[h,h,h];i<.5?s=i*(1+e):s=i+e-i*e,n=2*i-s,a=[0,0,0];for(var u=0;u<3;u++)o=t+1/3*-(u-1),o<0?o++:o>1&&o--,6*o<1?h=n+(s-n)*6*o:2*o<1?h=s:3*o<2?h=n+(s-n)*(2/3-o)*6:h=n,a[u]=h*255;return a}};function Lg(r){Array.isArray(r)&&r.raw&&(r=String.raw(...arguments));var t,e=Cg(r);return e.space?(t=Array(3),t[0]=Math.min(Math.max(e.values[0],0),255),t[1]=Math.min(Math.max(e.values[1],0),255),t[2]=Math.min(Math.max(e.values[2],0),255),e.space[0]==="h"&&(t=Pg.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t):[]}var Rg=16777215,je;(function(r){r.TEXT="TEXT",r.BITMAP_TEXT="BITMAP_TEXT"})(je||(je={}));function Ba(r,t,e){var i;if(r===je.TEXT)i=new Rp(t,{fontFamily:e.fontFamily,fontSize:e.fontSize,fill:Rg});else if(r===je.BITMAP_TEXT)i=new nv(t,{fontName:e.fontFamily,fontSize:e.fontSize});else throw new Error("Invalid state");return i.roundPixels=!0,i}var Sn=function(r,t){return Sn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])},Sn(r,t)};function jn(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Sn(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function Ga(r,t){var e;return r instanceof Function?e=r(t):typeof r=="object"&&r!==null?e=Object.fromEntries(Object.entries(r).map(function(i){var n=i[0],s=i[1];return[n,Ga(s,t)]})):e=r,e}function Io(r,t){var e=r.filter(function(n){return!!n}).map(function(n){return Ga(n,t)}),i=og.all(e);return i}var Mg=function(){function r(t){this.textures=new Map,this.renderer=t}return r.prototype.get=function(t,e){var i=this.textures.get(t);if(!i){var n=e(),s=n.getLocalBounds(void 0,!0),o=new Y(Math.floor(s.x),Math.floor(s.y),Math.ceil(s.width),Math.ceil(s.height));i=this.renderer.generateTexture(n,Gt.LINEAR,this.renderer.resolution,o),this.textures.set(t,i)}return i},r.prototype.delete=function(t){var e=this.textures.get(t);e&&(e.destroy(),this.textures.delete(t))},r.prototype.clear=function(){var t=this;Array.from(this.textures.keys()).forEach(function(e){t.delete(e)})},r.prototype.destroy=function(){this.clear()},r}();function De(r){var t=Lg(r);if(!t)throw new Error("Invalid color "+r);var e=Bd([t[0]/255,t[1]/255,t[2]/255]),i=t[3];return[e,i]}var Vr="::",Ao=16777215,Nn="NODE_CIRCLE",er="NODE_CIRCLE_BORDER",ir="NODE_ICON";function Ug(r){r.hitArea=new Mn(0,0);var t=new ye;t.name=Nn,t.anchor.set(.5),r.addChild(t);var e=new ye;e.name=er,e.anchor.set(.5),r.addChild(e);var i=new ye;i.name=ir,i.anchor.set(.5),r.addChild(i)}function Fg(r,t,e){var i,n,s,o=t.size+t.border.width,a=[Nn,t.size].join(Vr),h=e.get(a,function(){var g=new me;return g.beginFill(Ao,1,!0),g.drawCircle(t.size,t.size,t.size),g}),u=[er,t.size,t.border.width].join(Vr),l=e.get(u,function(){var g=new me;return g.lineStyle(t.border.width,Ao),g.drawCircle(o,o,t.size),g}),f=[ir,t.icon.fontFamily,t.icon.fontSize,t.icon.content].join(Vr),d=e.get(f,function(){var g=Ba(t.icon.type,t.icon.content,{fontFamily:t.icon.fontFamily,fontSize:t.icon.fontSize});return g});r.hitArea.radius=o;var c=r.getChildByName(Nn);c.texture=h,i=De(t.color),c.tint=i[0],c.alpha=i[1];var p=r.getChildByName(er);p.texture=l,n=De(t.border.color),p.tint=n[0],p.alpha=n[1];var v=r.getChildByName(ir);v.texture=d,s=De(t.icon.color),v.tint=s[0],v.alpha=s[1],r.addChild(v)}function Dg(r,t){var e=r.getChildByName(er);e.visible=e.visible&&t>=1;var i=r.getChildByName(ir);i.visible=i.visible&&t>=2}var kg="::",Wn="NODE_LABEL_BACKGROUND",rr="NODE_LABEL_TEXT";function Bg(r){var t=new ye(Z.WHITE);t.name=Wn,t.anchor.set(.5),r.addChild(t);var e=new ye;e.name=rr,e.anchor.set(.5),r.addChild(e)}function Gg(r,t,e){var i,n,s=t.size+t.border.width,o=[rr,t.label.fontFamily,t.label.fontSize,t.label.content].join(kg),a=e.get(o,function(){var l=Ba(t.label.type,t.label.content,{fontFamily:t.label.fontFamily,fontSize:t.label.fontSize});return l}),h=r.getChildByName(Wn);h.y=s+(a.height+t.label.padding*2)/2,h.width=a.width+t.label.padding*2,h.height=a.height+t.label.padding*2,i=De(t.label.backgroundColor),h.tint=i[0],h.alpha=i[1];var u=r.getChildByName(rr);u.texture=a,u.y=s+(a.height+t.label.padding*2)/2,n=De(t.label.color),u.tint=n[0],u.alpha=n[1]}function Hg(r,t){var e=r.getChildByName(Wn);e.visible=e.visible&&t>=3;var i=r.getChildByName(rr);i.visible=i.visible&&t>=3}var Xg=function(r){jn(t,r);function t(){var e=r.call(this)||this;return e.hovered=!1,e.nodeGfx=e.createNode(),e.nodeLabelGfx=e.createNodeLabel(),e.nodePlaceholderGfx=new dt,e.nodeLabelPlaceholderGfx=new dt,e}return t.prototype.createNode=function(){var e=this,i=new dt;return i.interactive=!0,i.buttonMode=!0,i.on("mousemove",function(n){return e.emit("mousemove",n.data.originalEvent)}),i.on("mouseover",function(n){return e.emit("mouseover",n.data.originalEvent)}),i.on("mouseout",function(n){return e.emit("mouseout",n.data.originalEvent)}),i.on("mousedown",function(n){return e.emit("mousedown",n.data.originalEvent)}),i.on("mouseup",function(n){return e.emit("mouseup",n.data.originalEvent)}),Ug(i),i},t.prototype.createNodeLabel=function(){var e=this,i=new dt;return i.interactive=!0,i.buttonMode=!0,i.on("mousemove",function(n){return e.emit("mousemove",n.data.originalEvent)}),i.on("mouseover",function(n){return e.emit("mouseover",n.data.originalEvent)}),i.on("mouseout",function(n){return e.emit("mouseout",n.data.originalEvent)}),i.on("mousedown",function(n){return e.emit("mousedown",n.data.originalEvent)}),i.on("mouseup",function(n){return e.emit("mouseup",n.data.originalEvent)}),Bg(i),i},t.prototype.updatePosition=function(e){this.nodeGfx.position.copyFrom(e),this.nodeLabelGfx.position.copyFrom(e)},t.prototype.updateStyle=function(e,i){Fg(this.nodeGfx,e,i),Gg(this.nodeLabelGfx,e,i)},t.prototype.updateVisibility=function(e){Dg(this.nodeGfx,e),Hg(this.nodeLabelGfx,e)},t}(Gn),$n="EDGE_LINE";function zg(r){var t=new ye(Z.WHITE);t.name=$n,t.anchor.set(.5),r.addChild(t)}function jg(r,t,e){var i,n=r.getChildByName($n);n.width=t.width,i=De(t.color),n.tint=i[0],n.alpha=i[1]}function Wg(r,t){var e=r.getChildByName($n);e.visible=e.visible&&t>=1}var $g=function(r){jn(t,r);function t(){var e=r.call(this)||this;return e.hovered=!1,e.edgeGfx=e.createEdge(),e.edgePlaceholderGfx=new dt,e}return t.prototype.createEdge=function(){var e=this,i=new dt;return i.interactive=!0,i.buttonMode=!0,i.on("mousemove",function(n){return e.emit("mousemove",n.data.originalEvent)}),i.on("mouseover",function(n){return e.emit("mouseover",n.data.originalEvent)}),i.on("mouseout",function(n){return e.emit("mouseout",n.data.originalEvent)}),i.on("mousedown",function(n){return e.emit("mousedown",n.data.originalEvent)}),i.on("mouseup",function(n){return e.emit("mouseup",n.data.originalEvent)}),zg(i),i},t.prototype.updatePosition=function(e,i){var n={x:(e.x+i.x)/2,y:(e.y+i.y)/2},s=-Math.atan2(i.x-e.x,i.y-e.y),o=Math.hypot(i.x-e.x,i.y-e.y);this.edgeGfx.position.copyFrom(n),this.edgeGfx.rotation=s,this.edgeGfx.height=o},t.prototype.updateStyle=function(e,i){jg(this.edgeGfx,e)},t.prototype.updateVisibility=function(e){Wg(this.edgeGfx,e)},t}(Gn);ur.registerPlugin($d);ur.registerPlugin(Vp);Xe.registerPlugin(sv);Dn.registerPlugin("batch",Ip);Dn.registerPlugin("interaction",fv);var Oo={node:{size:15,color:"#000000",border:{width:2,color:"#ffffff"},icon:{type:je.TEXT,fontFamily:"Arial",fontSize:20,color:"#ffffff",content:""},label:{type:je.TEXT,fontFamily:"Arial",fontSize:12,content:"",color:"#333333",backgroundColor:"rgba(0, 0, 0, 0)",padding:4}},edge:{width:1,color:"#cccccc"}},So=100,No=function(r){jn(t,r);function t(e){var i=r.call(this)||this;if(i.nodeKeyToNodeObject=new Map,i.edgeKeyToEdgeObject=new Map,i.mousedownNodeKey=null,i.mousedownEdgeKey=null,i.onGraphNodeAddedBound=i.onGraphNodeAdded.bind(i),i.onGraphEdgeAddedBound=i.onGraphEdgeAdded.bind(i),i.onGraphNodeDroppedBound=i.onGraphNodeDropped.bind(i),i.onGraphEdgeDroppedBound=i.onGraphEdgeDropped.bind(i),i.onGraphClearedBound=i.onGraphCleared.bind(i),i.onGraphEdgesClearedBound=i.onGraphEdgesCleared.bind(i),i.onGraphNodeAttributesUpdatedBound=i.onGraphNodeAttributesUpdated.bind(i),i.onGraphEdgeAttributesUpdatedBound=i.onGraphEdgeAttributesUpdated.bind(i),i.onGraphEachNodeAttributesUpdatedBound=i.onGraphEachNodeAttributesUpdated.bind(i),i.onGraphEachEdgeAttributesUpdatedBound=i.onGraphEachEdgeAttributesUpdated.bind(i),i.onDocumentMouseMoveBound=i.onDocumentMouseMove.bind(i),i.onDocumentMouseUpBound=i.onDocumentMouseUp.bind(i),i.container=e.container,i.graph=e.graph,i.style=e.style,i.hoverStyle=e.hoverStyle,i.resources=e.resources,!(i.container instanceof HTMLElement))throw new Error("container should be a HTMLElement");return ei.LINE_SCALE_MODE=Xt.NORMAL,i.app=new ur({resizeTo:i.container,resolution:window.devicePixelRatio,transparent:!0,antialias:!0,autoDensity:!0}),i.container.appendChild(i.app.view),i.app.renderer.plugins.interaction.moveWhenInside=!0,i.app.view.addEventListener("wheel",function(n){n.preventDefault()}),i.textureCache=new Mg(i.app.renderer),i.viewport=new kv({screenWidth:i.container.clientWidth,screenHeight:i.container.clientHeight,interaction:i.app.renderer.plugins.interaction}).drag().pinch().wheel().decelerate().clampZoom({maxScale:1}),i.app.stage.addChild(i.viewport),i.edgeLayer=new dt,i.frontEdgeLayer=new dt,i.nodeLayer=new dt,i.nodeLabelLayer=new dt,i.frontNodeLayer=new dt,i.frontNodeLabelLayer=new dt,i.viewport.addChild(i.edgeLayer),i.viewport.addChild(i.frontEdgeLayer),i.viewport.addChild(i.nodeLayer),i.viewport.addChild(i.nodeLabelLayer),i.viewport.addChild(i.frontNodeLayer),i.viewport.addChild(i.frontNodeLabelLayer),i.resizeObserver=new ResizeObserver(function(){i.app.resize(),i.viewport.resize(i.container.clientWidth,i.container.clientHeight),i.updateGraphVisibility()}),i.resources&&i.app.loader.add(i.resources),i.app.loader.load(function(){i.viewport.on("frame-end",function(){i.viewport.dirty&&(i.updateGraphVisibility(),i.viewport.dirty=!1)}),i.resizeObserver.observe(i.container),i.graph.on("nodeAdded",i.onGraphNodeAddedBound),i.graph.on("edgeAdded",i.onGraphEdgeAddedBound),i.graph.on("nodeDropped",i.onGraphNodeDroppedBound),i.graph.on("edgeDropped",i.onGraphEdgeDroppedBound),i.graph.on("cleared",i.onGraphClearedBound),i.graph.on("edgesCleared",i.onGraphEdgesClearedBound),i.graph.on("nodeAttributesUpdated",i.onGraphNodeAttributesUpdatedBound),i.graph.on("edgeAttributesUpdated",i.onGraphEdgeAttributesUpdatedBound),i.graph.on("eachNodeAttributesUpdated",i.onGraphEachNodeAttributesUpdatedBound),i.graph.on("eachEdgeAttributesUpdated",i.onGraphEachEdgeAttributesUpdatedBound),i.createGraph(),i.resetView()}),i}return t.prototype.destroy=function(){this.graph.off("nodeAdded",this.onGraphNodeAddedBound),this.graph.off("edgeAdded",this.onGraphEdgeAddedBound),this.graph.off("nodeDropped",this.onGraphNodeDroppedBound),this.graph.off("edgeDropped",this.onGraphEdgeDroppedBound),this.graph.off("cleared",this.onGraphClearedBound),this.graph.off("edgesCleared",this.onGraphEdgesClearedBound),this.graph.off("nodeAttributesUpdated",this.onGraphNodeAttributesUpdatedBound),this.graph.off("edgeAttributesUpdated",this.onGraphEdgeAttributesUpdatedBound),this.graph.off("eachNodeAttributesUpdated",this.onGraphEachNodeAttributesUpdatedBound),this.graph.off("eachEdgeAttributesUpdated",this.onGraphEachEdgeAttributesUpdatedBound),this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.textureCache.destroy(),this.textureCache=void 0,this.app.destroy(!0,{children:!0,texture:!0,baseTexture:!0}),this.app=void 0},Object.defineProperty(t.prototype,"zoomStep",{get:function(){return Math.min(this.viewport.worldWidth,this.viewport.worldHeight)/10},enumerable:!1,configurable:!0}),t.prototype.zoomIn=function(){this.viewport.zoom(-this.zoomStep,!0)},t.prototype.zoomOut=function(){this.viewport.zoom(this.zoomStep,!0)},t.prototype.resetView=function(){var e=this,i=this.graph.nodes().map(function(p){return e.graph.getNodeAttribute(p,"x")}),n=this.graph.nodes().map(function(p){return e.graph.getNodeAttribute(p,"y")}),s=Math.min.apply(Math,i),o=Math.max.apply(Math,i),a=Math.min.apply(Math,n),h=Math.max.apply(Math,n),u=Math.abs(o-s),l=Math.abs(h-a),f=new V(s+u/2,a+l/2),d=u+So*2,c=l+So*2;this.viewport.resize(this.container.clientWidth,this.container.clientHeight,d,c),this.viewport.setZoom(1),this.viewport.center=f,this.viewport.fit(!0)},t.prototype.onGraphNodeAdded=function(e){var i=e.key,n=e.attributes;this.createNode(i,n)},t.prototype.onGraphEdgeAdded=function(e){var i=e.key,n=e.attributes,s=e.source,o=e.target,a=this.graph.getNodeAttributes(s),h=this.graph.getNodeAttributes(o);this.createEdge(i,n,s,o,a,h)},t.prototype.onGraphNodeDropped=function(e){var i=e.key;this.dropNode(i)},t.prototype.onGraphEdgeDropped=function(e){var i=e.key;this.dropEdge(i)},t.prototype.onGraphCleared=function(){Array.from(this.edgeKeyToEdgeObject.keys()).forEach(this.dropEdge.bind(this)),Array.from(this.nodeKeyToNodeObject.keys()).forEach(this.dropNode.bind(this))},t.prototype.onGraphEdgesCleared=function(){Array.from(this.edgeKeyToEdgeObject.keys()).forEach(this.dropEdge.bind(this))},t.prototype.onGraphNodeAttributesUpdated=function(e){var i=e.key;this.updateNodeStyleByKey(i)},t.prototype.onGraphEdgeAttributesUpdated=function(e){var i=e.key;this.updateEdgeStyleByKey(i)},t.prototype.onGraphEachNodeAttributesUpdated=function(){this.graph.forEachNode(this.updateNodeStyle.bind(this))},t.prototype.onGraphEachEdgeAttributesUpdated=function(){this.graph.forEachEdge(this.updateEdgeStyle.bind(this))},t.prototype.hoverNode=function(e){var i=this.nodeKeyToNodeObject.get(e);if(!i.hovered){i.hovered=!0,this.updateNodeStyleByKey(e);var n=this.nodeLayer.getChildIndex(i.nodeGfx);this.nodeLayer.removeChildAt(n),this.nodeLabelLayer.removeChildAt(n),this.frontNodeLayer.removeChildAt(n),this.frontNodeLabelLayer.removeChildAt(n),this.nodeLayer.addChild(i.nodePlaceholderGfx),this.nodeLabelLayer.addChild(i.nodeLabelPlaceholderGfx),this.frontNodeLayer.addChild(i.nodeGfx),this.frontNodeLabelLayer.addChild(i.nodeLabelGfx)}},t.prototype.unhoverNode=function(e){var i=this.nodeKeyToNodeObject.get(e);if(i.hovered){i.hovered=!1,this.updateNodeStyleByKey(e);var n=this.frontNodeLayer.getChildIndex(i.nodeGfx);this.nodeLayer.removeChildAt(n),this.nodeLabelLayer.removeChildAt(n),this.frontNodeLayer.removeChildAt(n),this.frontNodeLabelLayer.removeChildAt(n),this.nodeLayer.addChild(i.nodeGfx),this.nodeLabelLayer.addChild(i.nodeLabelGfx),this.frontNodeLayer.addChild(i.nodePlaceholderGfx),this.frontNodeLabelLayer.addChild(i.nodeLabelPlaceholderGfx)}},t.prototype.hoverEdge=function(e){var i=this.edgeKeyToEdgeObject.get(e);if(!i.hovered){i.hovered=!0,this.updateEdgeStyleByKey(e);var n=this.edgeLayer.getChildIndex(i.edgeGfx);this.edgeLayer.removeChildAt(n),this.frontEdgeLayer.removeChildAt(n),this.edgeLayer.addChild(i.edgePlaceholderGfx),this.frontEdgeLayer.addChild(i.edgeGfx)}},t.prototype.unhoverEdge=function(e){var i=this.edgeKeyToEdgeObject.get(e);if(i.hovered){i.hovered=!1,this.updateEdgeStyleByKey(e);var n=this.frontEdgeLayer.getChildIndex(i.edgeGfx);this.edgeLayer.removeChildAt(n),this.frontEdgeLayer.removeChildAt(n),this.edgeLayer.addChild(i.edgeGfx),this.frontEdgeLayer.addChild(i.edgePlaceholderGfx)}},t.prototype.moveNode=function(e,i){this.graph.setNodeAttribute(e,"x",i.x),this.graph.setNodeAttribute(e,"y",i.y),this.updateNodeStyleByKey(e),this.graph.edges(e).forEach(this.updateEdgeStyleByKey.bind(this))},t.prototype.enableNodeDragging=function(){this.viewport.pause=!0,document.addEventListener("mousemove",this.onDocumentMouseMoveBound),document.addEventListener("mouseup",this.onDocumentMouseUpBound,{once:!0})},t.prototype.onDocumentMouseMove=function(e){var i=new V(e.offsetX,e.offsetY),n=this.viewport.toWorld(i);this.mousedownNodeKey&&this.moveNode(this.mousedownNodeKey,n)},t.prototype.onDocumentMouseUp=function(){this.viewport.pause=!1,document.removeEventListener("mousemove",this.onDocumentMouseMoveBound),this.mousedownNodeKey=null,this.mousedownEdgeKey=null},t.prototype.createGraph=function(){this.graph.forEachNode(this.createNode.bind(this)),this.graph.forEachEdge(this.createEdge.bind(this))},t.prototype.createNode=function(e,i){var n=this,s=new Xg;s.on("mousemove",function(o){n.emit("nodeMousemove",o,e)}),s.on("mouseover",function(o){n.mousedownNodeKey||n.hoverNode(e),n.emit("nodeMouseover",o,e)}),s.on("mouseout",function(o){n.mousedownNodeKey||n.unhoverNode(e),n.emit("nodeMouseout",o,e)}),s.on("mousedown",function(o){n.mousedownNodeKey=e,n.enableNodeDragging(),n.emit("nodeMousedown",o,e)}),s.on("mouseup",function(o){n.emit("nodeMouseup",o,e),n.mousedownNodeKey===e&&n.emit("nodeClick",o,e)}),this.nodeLayer.addChild(s.nodeGfx),this.nodeLabelLayer.addChild(s.nodeLabelGfx),this.frontNodeLayer.addChild(s.nodePlaceholderGfx),this.frontNodeLabelLayer.addChild(s.nodeLabelPlaceholderGfx),this.nodeKeyToNodeObject.set(e,s),this.updateNodeStyle(e,i)},t.prototype.createEdge=function(e,i,n,s,o,a){var h=this,u=new $g;u.on("mousemove",function(l){h.emit("edgeMousemove",l,e)}),u.on("mouseover",function(l){h.hoverEdge(e),h.emit("edgeMouseover",l,e)}),u.on("mouseout",function(l){h.unhoverEdge(e),h.emit("edgeMouseout",l,e)}),u.on("mousedown",function(l){h.mousedownEdgeKey=e,h.emit("edgeMousedown",l,e)}),u.on("mouseup",function(l){h.emit("edgeMouseup",l,e),h.mousedownEdgeKey===e&&h.emit("edgeClick",l,e)}),this.edgeLayer.addChild(u.edgeGfx),this.frontEdgeLayer.addChild(u.edgePlaceholderGfx),this.edgeKeyToEdgeObject.set(e,u),this.updateEdgeStyle(e,i,n,s,o,a)},t.prototype.dropNode=function(e){var i=this.nodeKeyToNodeObject.get(e);this.nodeLayer.removeChild(i.nodeGfx),this.nodeLabelLayer.removeChild(i.nodeLabelGfx),this.frontNodeLayer.removeChild(i.nodePlaceholderGfx),this.frontNodeLabelLayer.removeChild(i.nodeLabelPlaceholderGfx),this.nodeKeyToNodeObject.delete(e)},t.prototype.dropEdge=function(e){var i=this.edgeKeyToEdgeObject.get(e);this.edgeLayer.removeChild(i.edgeGfx),this.frontEdgeLayer.removeChild(i.edgePlaceholderGfx),this.edgeKeyToEdgeObject.delete(e)},t.prototype.updateNodeStyleByKey=function(e){var i=this.graph.getNodeAttributes(e);this.updateNodeStyle(e,i)},t.prototype.updateNodeStyle=function(e,i){var n=this.nodeKeyToNodeObject.get(e),s={x:i.x,y:i.y};n.updatePosition(s);var o=[Oo.node,this.style.node,n.hovered?this.hoverStyle.node:void 0],a=Io(o,i);n.updateStyle(a,this.textureCache)},t.prototype.updateEdgeStyleByKey=function(e){var i=this.graph.getEdgeAttributes(e),n=this.graph.source(e),s=this.graph.target(e),o=this.graph.getNodeAttributes(n),a=this.graph.getNodeAttributes(s);this.updateEdgeStyle(e,i,n,s,o,a)},t.prototype.updateEdgeStyle=function(e,i,n,s,o,a){var h=this.edgeKeyToEdgeObject.get(e),u={x:o.x,y:o.y},l={x:a.x,y:a.y};h.updatePosition(u,l);var f=[Oo.edge,this.style.edge,h.hovered?this.hoverStyle.edge:void 0],d=Io(f,i);h.updateStyle(d,this.textureCache)},t.prototype.updateGraphVisibility=function(){var e=this,i=new Bv;i.addAll(this.viewport.children.map(function(a){return a.children}).flat()),i.cull(this.app.renderer.screen);var n=this.viewport.scale.x,s=[.1,.2,.4,1/0],o=s.findIndex(function(a){return n<=a});this.graph.forEachNode(function(a){var h=e.nodeKeyToNodeObject.get(a);h.updateVisibility(o)}),this.graph.forEachEdge(function(a){var h=e.edgeKeyToEdgeObject.get(a);h.updateVisibility(o)})},t}(Gn),Cn={},Vg={get exports(){return Cn},set exports(r){Cn=r}};(function(r){(function(){function t(v,g){document.addEventListener?v.addEventListener("scroll",g,!1):v.attachEvent("scroll",g)}function e(v){document.body?v():document.addEventListener?document.addEventListener("DOMContentLoaded",function g(){document.removeEventListener("DOMContentLoaded",g),v()}):document.attachEvent("onreadystatechange",function g(){(document.readyState=="interactive"||document.readyState=="complete")&&(document.detachEvent("onreadystatechange",g),v())})}function i(v){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(v)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function n(v,g){v.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+g+";"}function s(v){var g=v.g.offsetWidth,y=g+100;return v.j.style.width=y+"px",v.i.scrollLeft=y,v.h.scrollLeft=v.h.scrollWidth+100,v.l!==g?(v.l=g,!0):!1}function o(v,g){function y(){var _=b;s(_)&&_.g.parentNode!==null&&g(_.l)}var b=v;t(v.h,y),t(v.i,y),s(v)}function a(v,g,y){g=g||{},y=y||window,this.family=v,this.style=g.style||"normal",this.weight=g.weight||"normal",this.stretch=g.stretch||"normal",this.context=y}var h=null,u=null,l=null,f=null;function d(v){return u===null&&(c(v)&&/Apple/.test(window.navigator.vendor)?(v=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),u=!!v&&603>parseInt(v[1],10)):u=!1),u}function c(v){return f===null&&(f=!!v.document.fonts),f}function p(v,g){var y=v.style,b=v.weight;if(l===null){var _=document.createElement("div");try{_.style.font="condensed 100px sans-serif"}catch{}l=_.style.font!==""}return[y,b,l?v.stretch:"","100px",g].join(" ")}a.prototype.load=function(v,g){var y=this,b=v||"BESbswy",_=0,T=g||3e3,m=new Date().getTime();return new Promise(function(x,A){if(c(y.context)&&!d(y.context)){var S=new Promise(function(E,k){function w(){new Date().getTime()-m>=T?k(Error(""+T+"ms timeout exceeded")):y.context.document.fonts.load(p(y,'"'+y.family+'"'),b).then(function(O){1<=O.length?E():setTimeout(w,25)},k)}w()}),I=new Promise(function(E,k){_=setTimeout(function(){k(Error(""+T+"ms timeout exceeded"))},T)});Promise.race([I,S]).then(function(){clearTimeout(_),x(y)},A)}else e(function(){function E(){var D;(D=L!=-1&&P!=-1||L!=-1&&H!=-1||P!=-1&&H!=-1)&&((D=L!=P&&L!=H&&P!=H)||(h===null&&(D=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),h=!!D&&(536>parseInt(D[1],10)||parseInt(D[1],10)===536&&11>=parseInt(D[2],10))),D=h&&(L==pt&&P==pt&&H==pt||L==B&&P==B&&H==B||L==M&&P==M&&H==M)),D=!D),D&&(F.parentNode!==null&&F.parentNode.removeChild(F),clearTimeout(_),x(y))}function k(){if(new Date().getTime()-m>=T)F.parentNode!==null&&F.parentNode.removeChild(F),A(Error(""+T+"ms timeout exceeded"));else{var D=y.context.document.hidden;(D===!0||D===void 0)&&(L=w.g.offsetWidth,P=O.g.offsetWidth,H=j.g.offsetWidth,E()),_=setTimeout(k,50)}}var w=new i(b),O=new i(b),j=new i(b),L=-1,P=-1,H=-1,pt=-1,B=-1,M=-1,F=document.createElement("div");F.dir="ltr",n(w,p(y,"sans-serif")),n(O,p(y,"serif")),n(j,p(y,"monospace")),F.appendChild(w.g),F.appendChild(O.g),F.appendChild(j.g),y.context.document.body.appendChild(F),pt=w.g.offsetWidth,B=O.g.offsetWidth,M=j.g.offsetWidth,k(),o(w,function(D){L=D,E()}),n(w,p(y,'"'+y.family+'",sans-serif')),o(O,function(D){P=D,E()}),n(O,p(y,'"'+y.family+'",serif')),o(j,function(D){H=D,E()}),n(j,p(y,'"'+y.family+'",monospace'))})})},r.exports=a})()})(Vg);const Yg=Cn,ki=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];window.addEventListener("DOMContentLoaded",async()=>{const r=new tt,{nodes:t,links:e}=await(await fetch("miserables.json")).json();t.forEach(w=>{r.addNode(w.id,w)}),e.forEach(w=>{r.addEdge(w.source,w.target,w)}),r.forEachNode(w=>{r.setNodeAttribute(w,"x",Math.random()),r.setNodeAttribute(w,"y",Math.random())});const i=await(await fetch("miserables-positions.json")).json();r.forEachNode(w=>{const O=i[w];r.setNodeAttribute(w,"x",O.x),r.setNodeAttribute(w,"y",O.y)});const n={node:{size:15,color:w=>ki[(w.group||0)%ki.length],border:{width:2,color:"#ffffff"},icon:{content:"person",fontFamily:"Material Icons",fontSize:20,color:"#ffffff"},label:{content:w=>w.id,type:No.TextType.BITMAP_TEXT,fontFamily:"HelveticaRegular",fontSize:12,color:"#333333",backgroundColor:"rgba(255, 255, 255, 0.5)",padding:4}},edge:{width:w=>Math.log((w.value||0)+1)+1,color:"#cccccc"}},s={node:{border:{color:"#000000"},label:{backgroundColor:"rgba(238, 238, 238, 1)"}},edge:{color:"#999999"}},o=[{name:"HelveticaRegular",url:"https://gist.githubusercontent.com/zakjan/b61c0a26d297edf0c09a066712680f37/raw/8cdda3c21ba3668c3dd022efac6d7f740c9f1e18/HelveticaRegular.fnt"}];await new Yg("Material Icons").load();const a=new No({container:document.getElementById("graph"),graph:r,style:n,hoverStyle:s,resources:o});a.on("nodeClick",(w,O)=>console.log("nodeClick",w,O)),a.on("nodeMousemove",(w,O)=>console.log("nodeMousemove",w,O)),a.on("nodeMouseover",(w,O)=>console.log("nodeMouseover",w,O)),a.on("nodeMouseout",(w,O)=>console.log("nodeMouseout",w,O)),a.on("nodeMousedown",(w,O)=>console.log("nodeMousedown",w,O)),a.on("nodeMouseup",(w,O)=>console.log("nodeMouseup",w,O)),a.on("edgeClick",(w,O)=>console.log("edgeClick",w,O)),a.on("edgeMousemove",(w,O)=>console.log("edgeMousemove",w,O)),a.on("edgeMouseover",(w,O)=>console.log("edgeMouseover",w,O)),a.on("edgeMouseout",(w,O)=>console.log("edgeMouseout",w,O)),a.on("edgeMousedown",(w,O)=>console.log("edgeMousedown",w,O)),a.on("edgeMouseup",(w,O)=>console.log("edgeMouseup",w,O));const h=r.nodes().reduce((w,O)=>Math.min(w,r.getNodeAttribute(O,"x")),1/0),u=r.nodes().reduce((w,O)=>Math.max(w,r.getNodeAttribute(O,"x")),-1/0),l=r.nodes().reduce((w,O)=>Math.min(w,r.getNodeAttribute(O,"y")),1/0),f=r.nodes().reduce((w,O)=>Math.max(w,r.getNodeAttribute(O,"y")),-1/0),d=()=>{const w=Math.floor(Math.random()*1e13).toString(36),O=h+Math.random()*(u-h),j=l+Math.random()*(f-l),L={id:w,x:O,y:j};r.addNode(L.id,L)};document.getElementById("add-node").addEventListener("click",d);const c=()=>{const w=r.nodes();let O,j;do O=w[Math.floor((w.length-1)*Math.random())],j=w[Math.floor((w.length-1)*Math.random())];while(r.edge(O,j));const L={source:O,target:j};r.addEdge(L.source,L.target)};document.getElementById("add-edge").addEventListener("click",c);const p=()=>{const w=r.nodes(),O=w[Math.floor((w.length-1)*Math.random())];r.dropNode(O)};document.getElementById("drop-node").addEventListener("click",p);const v=()=>{const w=r.edges(),O=w[Math.floor((w.length-1)*Math.random())];r.dropEdge(O)};document.getElementById("drop-edge").addEventListener("click",v);const g=()=>{r.clear()};document.getElementById("clear").addEventListener("click",g);const y=()=>{r.clearEdges()};document.getElementById("clear-edges").addEventListener("click",y);const b=()=>{a.zoomIn()};document.getElementById("zoom-in").addEventListener("click",b);const _=()=>{a.zoomOut()};document.getElementById("zoom-out").addEventListener("click",_);const T=()=>{const w=r.nodes(),O=w[Math.floor((w.length-1)*Math.random())],j=r.getNodeAttribute(O,"group");r.setNodeAttribute(O,"group",(j+1)%ki.length)};document.getElementById("update-node").addEventListener("click",T);const m=()=>{const w=r.edges(),O=w[Math.floor((w.length-1)*Math.random())],j=r.getEdgeAttribute(O,"value");r.setEdgeAttribute(O,"value",j*50)};document.getElementById("update-edge").addEventListener("click",m);const x=()=>{r.updateEachNodeAttributes((w,O)=>({...O,group:(O.group+1)%ki.length}))};document.getElementById("update-nodes").addEventListener("click",x);const A=()=>{r.updateEachEdgeAttributes((w,O)=>({...O,value:O.value*50}))};document.getElementById("update-edges").addEventListener("click",A);const S=()=>{a.resetView()};document.getElementById("reset-view").addEventListener("click",S);let I;const E=()=>{I=r.export(),console.log(I)};document.getElementById("export").addEventListener("click",E);const k=()=>{r.import(I)};document.getElementById("import").addEventListener("click",k)});
